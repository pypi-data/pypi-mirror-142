"use strict";(self.webpackChunkjupyterlab_search_replace=self.webpackChunkjupyterlab_search_replace||[]).push([[659],{659:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});var r=n(669),o=n(958),i=n(353),a=n(94),s=n(602),c=n(975),l=n(319),u=n(877);const h="data-jp-theme-name";let p=!1;const d={"--jp-border-width":{converter:e=>{const t=parseInt(e,10);return isNaN(t)?null:t},token:s.H},"--jp-layout-color1":{converter:(e,t)=>{const n=(0,o.lu)(e);if(n){const e=(0,i.lw)(n),t=a.H.fromObject({h:e.h,s:e.s,l:.5}),r=(0,i.hP)(t);return c.v.from(l.w.create(r.r,r.g,r.b))}return null},token:s.yv},"--jp-brand-color1":{converter:(e,t)=>{const n=(0,o.lu)(e);if(n){const e=(0,i.lw)(n),r=t?1:-1,o=a.H.fromObject({h:e.h,s:e.s,l:e.l+r*s.B2.getValueFor(document.body)/94}),u=(0,i.hP)(o);return c.v.from(l.w.create(u.r,u.g,u.b))}return null},token:s.au},"--jp-ui-font-family":{token:s.SV},"--jp-ui-font-size1":{token:s.cS}};function f(){var e;if(!document.body.getAttribute(h))return;const t=getComputedStyle(document.body),n="false"===document.body.getAttribute("data-jp-theme-light");s.q2.setValueFor(document.body,n?u.h.DarkMode:u.h.LightMode);for(const r in d){const o=d[r],i=t.getPropertyValue(r).toString();if(document.body&&""!==i){const t=(null!==(e=o.converter)&&void 0!==e?e:e=>e)(i.trim(),n);null!==t?o.token.setValueFor(document.body,t):console.error(`Fail to parse value '${i}' for '${r}' as FAST design token.`)}}}var m=n(271),y=n.n(m),b=n(797),v=n(168),E=function(e,t){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},E(e,t)};function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}E(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var _=function(){return _=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},_.apply(this,arguments)};function w(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function S(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var k,D="function"==typeof requestAnimationFrame?requestAnimationFrame:setImmediate,T="function"==typeof cancelAnimationFrame?cancelAnimationFrame:clearImmediate,A=function(){function e(e){var t=this;this._disposed=new v.Signal(this),this._tick=new b.PromiseDelegate,this._ticked=new v.Signal(this),this._timeout=-1,this._factory=e.factory,this._standby=e.standby||k.DEFAULT_STANDBY,this._state=_(_({},k.DEFAULT_STATE),{timestamp:(new Date).getTime()});var n=e.frequency||{},r=Math.max(n.interval||0,n.max||0,k.DEFAULT_FREQUENCY.max);this.frequency=_(_(_({},k.DEFAULT_FREQUENCY),n),{max:r}),this.name=e.name||k.DEFAULT_NAME,"auto"in e&&!e.auto||D((function(){t.start()}))}return Object.defineProperty(e.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frequency",{get:function(){return this._frequency},set:function(t){if(!this.isDisposed&&!b.JSONExt.deepEqual(t,this.frequency||{})){var n=t.backoff,r=t.interval,o=t.max;if(r=Math.round(r),o=Math.round(o),"number"==typeof n&&n<1)throw new Error("Poll backoff growth factor must be at least 1");if((r<0||r>o)&&r!==e.NEVER)throw new Error("Poll interval must be between 0 and max");if(o>e.MAX_INTERVAL&&o!==e.NEVER)throw new Error("Max interval must be less than "+e.MAX_INTERVAL);this._frequency={backoff:n,interval:r,max:o}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return"disposed"===this.state.phase},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"standby",{get:function(){return this._standby},set:function(e){this.isDisposed||this.standby===e||(this._standby=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tick",{get:function(){return this._tick.promise},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ticked",{get:function(){return this._ticked},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.isDisposed||(this._state=_(_({},k.DISPOSED_STATE),{timestamp:(new Date).getTime()}),this._tick.promise.catch((function(e){})),this._tick.reject(new Error("Poll ("+this.name+") is disposed.")),this._disposed.emit(void 0),v.Signal.clearData(this))},e.prototype.refresh=function(){return this.schedule({cancel:function(e){return"refreshed"===e.phase},interval:e.IMMEDIATE,phase:"refreshed"})},e.prototype.schedule=function(t){return void 0===t&&(t={}),w(this,void 0,void 0,(function(){var n,r,o,i,a,s=this;return S(this,(function(c){switch(c.label){case 0:return this.isDisposed||t.cancel&&t.cancel(this.state)?[2]:(n=this.state,r=this._tick,o=new b.PromiseDelegate,i=_({interval:this.frequency.interval,payload:null,phase:"standby",timestamp:(new Date).getTime()},t),this._state=i,this._tick=o,n.interval===e.IMMEDIATE?T(this._timeout):clearTimeout(this._timeout),this._ticked.emit(this.state),r.resolve(this),[4,r.promise]);case 1:return c.sent(),a=function(){s.isDisposed||s.tick!==o.promise||s._execute()},this._timeout=i.interval===e.IMMEDIATE?D(a):i.interval===e.NEVER?-1:setTimeout(a,i.interval),[2]}}))}))},e.prototype.start=function(){return this.schedule({cancel:function(e){var t=e.phase;return"constructed"!==t&&"standby"!==t&&"stopped"!==t},interval:e.IMMEDIATE,phase:"started"})},e.prototype.stop=function(){return this.schedule({cancel:function(e){return"stopped"===e.phase},interval:e.NEVER,phase:"stopped"})},e.prototype._execute=function(){var e=this,t="function"==typeof this.standby?this.standby():this.standby;if(t="never"!==t&&("when-hidden"===t?!("undefined"==typeof document||!document||!document.hidden):t))this.schedule();else{var n=this.tick;this._factory(this.state).then((function(t){e.isDisposed||e.tick!==n||e.schedule({payload:t,phase:"rejected"===e.state.phase?"reconnected":"resolved"})})).catch((function(t){e.isDisposed||e.tick!==n||e.schedule({interval:k.sleep(e.frequency,e.state),payload:t,phase:"rejected"})}))}},e}();!function(e){e.IMMEDIATE=0,e.MAX_INTERVAL=2147483647,e.NEVER=1/0}(A||(A={})),function(e){e.DEFAULT_BACKOFF=3,e.DEFAULT_FREQUENCY={backoff:!0,interval:1e3,max:3e4},e.DEFAULT_NAME="unknown",e.DEFAULT_STANDBY="when-hidden",e.DEFAULT_STATE={interval:A.NEVER,payload:null,phase:"constructed",timestamp:new Date(0).getTime()},e.DISPOSED_STATE={interval:A.NEVER,payload:null,phase:"disposed",timestamp:new Date(0).getTime()},e.sleep=function(t,n){var r=t.backoff,o=t.interval,i=t.max;if(o===A.NEVER)return o;var a=!0===r?e.DEFAULT_BACKOFF:!1===r?1:r,s=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}(o,n.interval*a);return Math.min(i,s)}}(k||(k={}));var j=function(){function e(e,t){var n=this;void 0===t&&(t=500),this.payload=null,this.limit=t,this.poll=new A({auto:!1,factory:function(){return w(n,void 0,void 0,(function(){return S(this,(function(t){switch(t.label){case 0:return[4,e()];case 1:return[2,t.sent()]}}))}))},frequency:{backoff:!1,interval:A.NEVER,max:A.NEVER},standby:"never"}),this.payload=new b.PromiseDelegate,this.poll.ticked.connect((function(e,t){var r=n.payload;return"resolved"===t.phase?(n.payload=new b.PromiseDelegate,void r.resolve(t.payload)):"rejected"===t.phase||"stopped"===t.phase?(n.payload=new b.PromiseDelegate,r.promise.catch((function(e){})),void r.reject(t.payload)):void 0}),this)}return Object.defineProperty(e.prototype,"isDisposed",{get:function(){return null===this.payload},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.isDisposed||(this.payload=null,this.poll.dispose())},e.prototype.stop=function(){return w(this,void 0,void 0,(function(){return S(this,(function(e){return[2,this.poll.stop()]}))}))},e}(),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return g(t,e),t.prototype.invoke=function(){return this.poll.schedule({interval:this.limit,phase:"invoked"}),this.payload.promise},t}(j),N=(function(e){function t(t,n){var r=e.call(this,t,"number"==typeof n?n:n&&n.limit)||this,o="leading";return"number"!=typeof n&&(o="edge"in(n=n||{})?n.edge:o),r._interval="trailing"===o?r.limit:A.IMMEDIATE,r}g(t,e),t.prototype.invoke=function(){return"invoked"!==this.poll.state.phase&&this.poll.schedule({interval:this._interval,phase:"invoked"}),this.payload.promise}}(j),n(626)),F=n(695),x=n(149),O=n(942);class P extends x.VDomModel{constructor(){super(),this._searchString="",this._queryResults=[],this._debouncedStartSearch=new M((()=>{this.getSearchString(this._searchString)}))}get searchString(){return this._searchString}set searchString(e){e!==this._searchString&&(this._searchString=e,this.stateChanged.emit(),this._debouncedStartSearch.invoke().catch((t=>console.error(`failed query for ${e} due to ${t}`))))}get queryResults(){return this._queryResults}async getSearchString(e){try{const t=await async function(e="",t={}){const n=F.ServerConnection.makeSettings(),r=N.URLExt.join(n.baseUrl,"search",e);let o;try{o=await F.ServerConnection.makeRequest(r,t,n)}catch(e){throw new F.ServerConnection.NetworkError(e)}let i=await o.text();if(i.length>0)try{i=JSON.parse(i)}catch(e){console.log("Not a JSON response body.",o)}if(!o.ok)throw new F.ServerConnection.ResponseError(o,i.message||i);return i}("?"+new URLSearchParams([["query",e]]).toString(),{method:"GET"});this._queryResults=t.matches,this.stateChanged.emit(),console.log(t)}catch(e){console.error(`The jupyterlab_search_replace server extension appears to be missing.\n${e}`)}}}class R extends x.VDomRenderer{constructor(e,t){super(e),this._commands=t,this.addClass("jp-search-replace-tab")}render(){return y().createElement(y().Fragment,null,y().createElement(O.Search,{appearance:"outline",placeholder:"Search","aria-label":"Search files for text",onInput:e=>this.model.searchString=e.target.value}),this.model.searchString&&function(e,t){e.sort(((e,t)=>e.path>t.path?1:-1));const n=e.map((e=>y().createElement(O.TreeItem,{className:"search-tree-files",expanded:!0},y().createElement("span",{title:e.path},e.path),y().createElement(O.Badge,{slot:"end"},e.matches.length),e.matches.map((n=>y().createElement(O.TreeItem,{className:"search-tree-matches",onClick:()=>function(e,t){t.execute("docmanager:open",{path:e})}(e.path,t)},y().createElement("span",{title:n.line},n.line.slice(0,n.start),y().createElement("mark",null,n.match),n.line.slice(n.end))))))));return 0===n.length?y().createElement("p",null,"No Matches Found"):y().createElement("div",{className:"jp-search-replace-list"},y().createElement(O.TreeView,null,n))}(this.model.queryResults,this._commands))}}const I={id:"jupyterlab-search-replace:plugin",autoStart:!0,activate:e=>{console.log("JupyterLab extension search-replace is activated!"),p||(p=!0,function(){const e=()=>{new MutationObserver((()=>{f()})).observe(document.body,{attributes:!0,attributeFilter:[h],childList:!1,characterData:!1}),f()};"complete"===document.readyState?e():window.addEventListener("load",e)}());const t=new P,n=new R(t,e.commands);n.title.caption="Search and replace",n.id="jp-search-replace",n.title.icon=r.searchIcon,e.shell.add(n,"left")}}}}]);