

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Default classes &mdash; Profile Likelihood  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples" href="../howto/howto.html" />
    <link rel="prev" title="profile_likelihood" href="profile_likelihood.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Profile Likelihood
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Basics:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../get_started/get_started.html">Get started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theory</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="profile_likelihood.html">profile_likelihood</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Default classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-profile_likelihood.default.single_starting_point">single_starting_point</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-profile_likelihood.default.fit_leastsq">fit_leastsq</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">How to:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../howto/howto.html">Examples</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Profile Likelihood</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">Modules</a> &raquo;</li>
        
      <li>Default classes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/modules/default_classes.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="default-classes">
<span id="id1"></span><h1>Default classes<a class="headerlink" href="#default-classes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-profile_likelihood.default.single_starting_point">
<span id="single-starting-point"></span><h2>single_starting_point<a class="headerlink" href="#module-profile_likelihood.default.single_starting_point" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="profile_likelihood.default.single_starting_point.single_starting_point">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">profile_likelihood.default.single_starting_point.</span></span><span class="sig-name descname"><span class="pre">single_starting_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#profile_likelihood.default.single_starting_point.single_starting_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Default class to get and process initial guesses used in the
optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>start0</strong></dt><dd><p>(Optional) Initial guess used when the optimization is done around the
best-fit parameter.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>nguess</strong></dt><dd><p>(Required) Number of different initial guess.</p>
</dd>
<dt><strong>start0</strong></dt><dd><p>(Optional) Initial guess used when the optimization is done around the
best-fit parameter.</p>
</dd>
<dt><strong>nparams</strong></dt><dd><p>(Optional) Number of parameters.</p>
</dd>
<dt><strong>start</strong></dt><dd><p>(Optional) Values of the starting points.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#profile_likelihood.default.single_starting_point.single_starting_point.get_points" title="profile_likelihood.default.single_starting_point.single_starting_point.get_points"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_points</span></code></a>(ii)</p></td>
<td><p>(Required) Return 2D array of starting points for optimizations corresponding to each fixed parameter value.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#profile_likelihood.default.single_starting_point.single_starting_point.set_points_0" title="profile_likelihood.default.single_starting_point.single_starting_point.set_points_0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_points_0</span></code></a>()</p></td>
<td><p>(Required) Reset the starting points to <code class="docutils literal notranslate"><span class="pre">self.start0</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#profile_likelihood.default.single_starting_point.single_starting_point.update" title="profile_likelihood.default.single_starting_point.single_starting_point.update"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update</span></code></a>(results_opt, ii)</p></td>
<td><p>(Required) Update the initial guesses.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="profile_likelihood.default.single_starting_point.single_starting_point.get_points">
<span class="sig-name descname"><span class="pre">get_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ii</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#profile_likelihood.default.single_starting_point.single_starting_point.get_points" title="Permalink to this definition">¶</a></dt>
<dd><p>(Required) Return 2D array of starting points for optimizations
corresponding to each fixed parameter value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ii: int</strong></dt><dd><p>Location of index of parameters held fixed in the list of index
given.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></dt><dd><p>Array of initial starting points used in the optimization when
parameter idx is held fixed.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="profile_likelihood.default.single_starting_point.single_starting_point.set_points_0">
<span class="sig-name descname"><span class="pre">set_points_0</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#profile_likelihood.default.single_starting_point.single_starting_point.set_points_0" title="Permalink to this definition">¶</a></dt>
<dd><p>(Required) Reset the starting points to <code class="docutils literal notranslate"><span class="pre">self.start0</span></code>. The profile
likelihood computation will start from <code class="docutils literal notranslate"><span class="pre">best_fit</span></code> then moves to the
left, and then it will go back to the <code class="docutils literal notranslate"><span class="pre">best_fit</span></code> and move to the right
this time. This method is called when the computation move back to the
<code class="docutils literal notranslate"><span class="pre">best_fit</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="profile_likelihood.default.single_starting_point.single_starting_point.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results_opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ii</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#profile_likelihood.default.single_starting_point.single_starting_point.update" title="Permalink to this definition">¶</a></dt>
<dd><p>(Required) Update the initial guesses. This method will be called
every time after an optimization for 1 fixed parameter value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>results_opt:</strong></dt><dd><p>Output from <code class="docutils literal notranslate"><span class="pre">fit_class.optimize</span></code>.</p>
</dd>
<dt><strong>ii: int</strong></dt><dd><p>Location of index of parameters held fixed in the list of index
given.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-profile_likelihood.default.fit_leastsq">
<span id="fit-leastsq"></span><h2>fit_leastsq<a class="headerlink" href="#module-profile_likelihood.default.fit_leastsq" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="profile_likelihood.default.fit_leastsq.fit_leastsq">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">profile_likelihood.default.fit_leastsq.</span></span><span class="sig-name descname"><span class="pre">fit_leastsq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nreturned</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#profile_likelihood.default.fit_leastsq.fit_leastsq" title="Permalink to this definition">¶</a></dt>
<dd><p>The default fit class used to calculate the profile
likelihood. The fitting/optimization uses
<code class="docutils literal notranslate"><span class="pre">scipy.optimize.least_squares</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>nreturned: int</strong></dt><dd><p>(Required) Number of things returned by the by the fitting class. This
is translated as the number of columns of the array to store the results
temporarily. This will be used to create the matrix to store the results
temporarily. For this fit class, <cite>nreturned</cite> should be <cite>num_params + 2</cite>,
since the error code and the cost are also stored in addition to the
optimized parameters.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>(Optional) Keyword arguments to pass on to optimization routine.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#profile_likelihood.default.fit_leastsq.fit_leastsq.callback" title="profile_likelihood.default.fit_leastsq.fit_leastsq.callback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">callback</span></code></a>(opt_output, fixed_param, idx)</p></td>
<td><p>(Required) Process the results from <code class="docutils literal notranslate"><span class="pre">fit_class.optimize</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#profile_likelihood.default.fit_leastsq.fit_leastsq.optimize" title="profile_likelihood.default.fit_leastsq.fit_leastsq.optimize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optimize</span></code></a>(residuals, initial_guess, idx, …)</p></td>
<td><p>Do the optimization using <cite>scipy.optimize.least_squares</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="profile_likelihood.default.fit_leastsq.fit_leastsq.callback">
<span class="sig-name descname"><span class="pre">callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opt_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#profile_likelihood.default.fit_leastsq.fit_leastsq.callback" title="Permalink to this definition">¶</a></dt>
<dd><p>(Required) Process the results from <code class="docutils literal notranslate"><span class="pre">fit_class.optimize</span></code>. It takes
<code class="docutils literal notranslate"><span class="pre">(opt_output,</span> <span class="pre">fixed_param,</span> <span class="pre">idx)</span></code> as arguments. This method
processes raw results from <code class="docutils literal notranslate"><span class="pre">fit_class.optimize</span></code>
(<code class="docutils literal notranslate"><span class="pre">opt_output</span></code> parameter) to match the format used by
<code class="docutils literal notranslate"><span class="pre">profile_likelihood</span></code> class. This method returns a 1D array, with
element 0 be <code class="docutils literal notranslate"><span class="pre">error_code</span></code>, elements 1 to n be <code class="docutils literal notranslate"><span class="pre">opt_params</span></code>, and
element n+1 be <code class="docutils literal notranslate"><span class="pre">cost</span></code>. The array can have more element to return,
if user wishes to return more information. For reference, also see
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_result_dict()</span></code> for the construction
of the final results dictionary from the array returned by this
method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>opt_output:</strong></dt><dd><p>Output from <code class="docutils literal notranslate"><span class="pre">fit_class.optimize</span></code>.</p>
</dd>
<dt><strong>fixed_param: float</strong></dt><dd><p>Value of parameter that is held fixed.</p>
</dd>
<dt><strong>idx: int</strong></dt><dd><p>Index of fixed parameter. Together with <code class="docutils literal notranslate"><span class="pre">fixed_param</span></code>,
this is used to insert the fixed parameter into the
parameter result from the optimization.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>1D <code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></dt><dd><p>Array in the format
<code class="docutils literal notranslate"><span class="pre">[error_code,</span> <span class="pre">*opt_params,</span> <span class="pre">*others,</span> <span class="pre">cost]</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="profile_likelihood.default.fit_leastsq.fit_leastsq.optimize">
<span class="sig-name descname"><span class="pre">optimize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">residuals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_param</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#profile_likelihood.default.fit_leastsq.fit_leastsq.optimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the optimization using <cite>scipy.optimize.least_squares</cite>. It takes
arguments <code class="docutils literal notranslate"><span class="pre">residuals,</span> <span class="pre">initial_guess,</span> <span class="pre">idx,</span> <span class="pre">fixed_param</span></code>. This method
contains the optimization routine to use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>residuals: callable</strong></dt><dd><p>Function to be optimized. This will be a wrapper to
<code class="docutils literal notranslate"><span class="pre">model.residuals</span></code>
(see <code class="xref py py-meth docutils literal notranslate"><span class="pre">_model_wrapper()</span></code>).</p>
</dd>
<dt><strong>initial_guess: 1D array</strong></dt><dd><p>Initial guess for the optimization. This will be a
vector of length n-1, where n is the number of model’s
parameters</p>
</dd>
<dt><strong>idx: int</strong></dt><dd><p>Index of parameter that is fixed. This is needed to
insert <code class="docutils literal notranslate"><span class="pre">fixed_param</span></code> in to it’s proper location.</p>
</dd>
<dt><strong>fixed_param: float</strong></dt><dd><p>Value of parameter that is held fixed.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Result</span></code> <code class="xref py py-obj docutils literal notranslate"><span class="pre">of</span></code> <code class="xref py py-obj docutils literal notranslate"><span class="pre">optimization</span></code> <code class="xref py py-obj docutils literal notranslate"><span class="pre">in</span></code> <code class="xref py py-obj docutils literal notranslate"><span class="pre">any</span></code> format. <code class="xref py py-obj docutils literal notranslate"><span class="pre">Further</span></code> <code class="xref py py-obj docutils literal notranslate"><span class="pre">processing</span></code></dt><dd><p>will be done by <code class="docutils literal notranslate"><span class="pre">return_class</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../howto/howto.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="profile_likelihood.html" class="btn btn-neutral float-left" title="profile_likelihood" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Yonatan Kurniawan.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>