import numpy as np
import pytest

import colorio


@pytest.mark.parametrize(
    "xyz1,ref",
    [
        # Reference values from
        # https://github.com/konovalenko-iitp/proLab/issues/1
        ([0, 0, 0], [0, 0, 0]),
        (
            [0.4125, 0.2127, 0.0193],
            [63.88427548346292, 64.69954868694846, 26.666298869300153],
        ),
        (
            [0.3576, 0.7152, 0.1192],
            [93.27167417065478, -46.2799253082431, 30.942533549946752],
        ),
        (
            [0.1804, 0.0722, 0.9503],
            [67.82356414227915, 19.0102657319574, -65.57301566589068],
        ),
        (
            [0.5380, 0.7873, 1.0695],
            [96.52220311413747, -23.057911360628346, -9.503463372983818],
        ),
        (
            [0.5929, 0.2848, 0.9696],
            [82.39735965111707, 48.219256810308636, -32.233826542233516],
        ),
        (
            [0.7700, 0.9278, 0.1385],
            [98.66600684931353, -10.136229923474398, 34.935358959830026],
        ),
        (
            [0.9505, 1.0000, 1.0888],
            [100.0, 0.0027564737935443662, 0.0011278624074838046],
        ),
    ],
)
def test_reference_xyz(xyz1, ref):
    xyz100 = np.array(xyz1) * 100
    cs = colorio.cs.PROLAB()
    xyz100 = np.asarray(xyz100)
    val = cs.from_xyz100(xyz100)
    print(ref)
    print(val.tolist())
    assert np.all(np.abs(val - ref) < 1.0e-13 * np.abs(ref) + 1.0e-13)
