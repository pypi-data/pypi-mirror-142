(self["webpackChunkunmanic_frontend"]=self["webpackChunkunmanic_frontend"]||[]).push([[312],{7312:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>je});var s=n(3673),i=n(2323),l=n(1561),a=n.n(l);const o={class:"q-pa-none"},d={class:"row"},r={class:"col q-ma-sm"},m={class:"q-pa-md",style:{"max-width":"500px"}},u={class:"q-mb-none"},c={class:"q-gutter-sm"},g={class:"q-mb-none"},p={class:"q-gutter-sm"},h={class:"row"},k={class:"col-3"},w={class:"text-weight-bold"},b={class:"col-grow"},f={class:"q-pl-none"},v={class:"row"},W={class:"col-3"},_={class:"text-weight-bold"},q={class:"col-grow"},y={class:"q-pl-none"},I={class:"text-grey-8 q-gutter-xs"},$={class:"text-h6"},T={key:0},C={class:"row"},Q={class:"col-6 text-center"};function S(e,t,n,l,S,x){const R=(0,s.up)("q-skeleton"),Z=(0,s.up)("q-input"),z=(0,s.up)("q-separator"),V=(0,s.up)("q-img"),H=(0,s.up)("q-item-section"),j=(0,s.up)("q-item-label"),U=(0,s.up)("q-tooltip"),D=(0,s.up)("q-btn"),P=(0,s.up)("q-item"),A=(0,s.up)("q-list"),L=(0,s.up)("q-space"),N=(0,s.up)("q-bar"),B=(0,s.up)("q-card-section"),J=(0,s.up)("q-card-actions"),O=(0,s.up)("q-card"),F=(0,s.up)("q-dialog"),K=(0,s.up)("q-form"),Y=(0,s.up)("q-page"),E=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(Y,{padding:""},{default:(0,s.w5)((()=>[(0,s.Wm)("div",o,[(0,s.Wm)("div",d,[(0,s.Wm)("div",r,[(0,s.Wm)("div",m,[(0,s.Wm)(K,{onSubmit:x.save,class:"q-gutter-md"},{default:(0,s.w5)((()=>[(0,s.Wm)("h5",u,(0,i.zw)(e.$t("components.settings.link.thisInstallation")),1),(0,s.Wm)("div",c,[null===S.installationName?((0,s.wg)(),(0,s.j4)(R,{key:0,type:"QInput"})):(0,s.kq)("",!0),null!==S.installationName?((0,s.wg)(),(0,s.j4)(Z,{key:1,outlined:"",color:"primary",modelValue:S.installationName,"onUpdate:modelValue":t[1]||(t[1]=e=>S.installationName=e),label:e.$t("components.settings.link.nameThisInstall"),placeholder:S.installationName},null,8,["modelValue","label","placeholder"])):(0,s.kq)("",!0)]),(0,s.Wm)(z,{class:"q-my-lg"}),(0,s.Wm)("h5",g,(0,i.zw)(e.$t("components.settings.link.remoteInstallations")),1),(0,s.Wm)("div",p,[null===S.remoteInstallations?((0,s.wg)(),(0,s.j4)(R,{key:0,type:"text"})):(0,s.kq)("",!0),(0,s.Wm)(A,{bordered:"",separator:"",class:"rounded-borders"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.j4)(s.HY,null,(0,s.Ko)(S.remoteInstallations,((t,n)=>((0,s.wg)(),(0,s.j4)(P,{key:n},{default:(0,s.w5)((()=>[(0,s.Wm)(H,{avatar:""},{default:(0,s.w5)((()=>[t.available?((0,s.wg)(),(0,s.j4)(V,{key:0,src:a()})):((0,s.wg)(),(0,s.j4)(V,{key:1,"img-style":{filter:"grayscale(100%)"},src:a()},null,8,["img-style"]))])),_:2},1024),(0,s.Wm)(z,{inset:"",vertical:"",class:"q-mr-sm"}),(0,s.Wm)(H,{class:"q-px-sm q-mx-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)(j,{lines:"1"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(t.address),1)])),_:2},1024),(0,s.Wm)(j,{caption:"",lines:"2"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",h,[(0,s.Wm)("div",k,[(0,s.Wm)("span",w,(0,i.zw)(e.$t("components.settings.link.name"))+":",1)]),(0,s.Wm)("div",b,[(0,s.Wm)("span",f,(0,i.zw)(t.name),1)])])])),_:2},1024),(0,s.Wm)(j,{caption:"",lines:"2"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",v,[(0,s.Wm)("div",W,[(0,s.Wm)("span",_,(0,i.zw)(e.$t("components.settings.link.version"))+":",1)]),(0,s.Wm)("div",q,[(0,s.Wm)("span",y,(0,i.zw)(t.version),1)])])])),_:2},1024)])),_:2},1024),(0,s.Wm)(z,{inset:"",vertical:"",class:"q-mx-sm"}),(0,s.Wm)(H,{center:"",side:""},{default:(0,s.w5)((()=>[(0,s.Wm)("div",I,[(0,s.Wm)(D,{size:"12px",flat:"",dense:"",round:"",icon:"tune",onClick:e=>x.configureRemoteInstallation(n)},{default:(0,s.w5)((()=>[(0,s.Wm)(U,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("tooltips.configure")),1)])),_:1})])),_:2},1032,["onClick"]),(0,s.Wm)(D,{flat:"",dense:"",round:"",size:"12px",color:"negative",icon:"delete",onClick:e=>x.deleteRemoteInstallation(n)},{default:(0,s.w5)((()=>[(0,s.Wm)(U,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("tooltips.delete")),1)])),_:1})])),_:2},1032,["onClick"])])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,s.Wm)(N,{class:"bg-transparent"},{default:(0,s.w5)((()=>[(0,s.Wm)(L),(0,s.Wm)(D,{round:"",flat:"",color:"primary",icon:"add",onClick:t[2]||(t[2]=e=>S.newRemoteInstallation=!0)},{default:(0,s.w5)((()=>[(0,s.Wm)(U,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("tooltips.add")),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(F,{modelValue:S.newRemoteInstallation,"onUpdate:modelValue":t[4]||(t[4]=e=>S.newRemoteInstallation=e),persistent:""},{default:(0,s.w5)((()=>[(0,s.Wm)(O,{style:{"min-width":"350px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(B,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",$,(0,i.zw)(e.$t("components.settings.link.addRemoteInstallation")),1)])),_:1}),(0,s.Wm)(B,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s.Wm)(Z,{outlined:"",color:"primary",modelValue:S.newRemoteInstallationAddress,"onUpdate:modelValue":t[3]||(t[3]=e=>S.newRemoteInstallationAddress=e),label:e.$t("components.settings.link.address"),placeholder:"192.168.1.2:8888"},null,8,["modelValue","label"])])),_:1}),(0,s.Wm)(J,{align:"right",class:"text-primary"},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(D,{flat:"",label:e.$t("navigation.cancel")},null,8,["label"]),[[E]]),(0,s.wy)((0,s.Wm)(D,{onClick:x.addNewRemoteInstallation,flat:"",label:e.$t("components.settings.link.add")},null,8,["onClick","label"]),[[E]])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,s.Wm)("div",null,[(0,s.Wm)(D,{label:e.$t("navigation.submit"),type:"submit",color:"secondary"},null,8,["label"])])])),_:1},8,["onSubmit"])])])]),e.$q.platform.is.mobile?((0,s.wg)(),(0,s.j4)("div",T,[(0,s.Wm)(z,{class:"q-mb-lg"}),(0,s.Wm)("div",C,[(0,s.Wm)("div",Q,[(0,s.Wm)(O,{flat:"",bordered:"",onClick:t[5]||(t[5]=t=>e.$router.push("/ui/settings-plugins")),class:"q-ma-xs"},{default:(0,s.w5)((()=>[(0,s.Wm)(D,{icon:"navigate_before",flat:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("navigation.plugins")),1)])),_:1})])),_:1})])])])):(0,s.kq)("",!0)])])),_:1})}var x=n(4190),R=n(1959),Z=n(8825),z=n(5948);const V={class:"row items-center no-wrap"},H={class:"col"},j={class:"text-h6 text-blue-10"},U={class:"col-auto"},D={class:"q-pa-md"},P={class:"row"},A={class:"col-4 text-h6"},L={class:"col-4"},N={class:"row"},B={class:"col-4 text-h6"},J={class:"col-4"},O={class:"row"},F={class:"col-4 text-h6"},K={class:"col-4"},Y={class:""},E={class:"q-gutter-sm"},G={class:""},M={class:"q-gutter-sm"},X={class:"q-gutter-sm"},ee={key:0,class:"sub-setting"},te={class:"q-gutter-sm"},ne={class:"q-gutter-sm"},se={key:1,class:"sub-setting"},ie={class:"q-gutter-sm"},le={class:"q-pl-lg",style:{width:"80%"}};function ae(e,t,n,l,a,o){const d=(0,s.up)("q-tooltip"),r=(0,s.up)("q-btn"),m=(0,s.up)("q-card-section"),u=(0,s.up)("q-separator"),c=(0,s.up)("q-input"),g=(0,s.up)("q-skeleton"),p=(0,s.up)("q-toggle"),h=(0,s.up)("q-slider"),k=(0,s.up)("q-card"),w=(0,s.up)("q-dialog"),b=(0,s.Q2)("close-popup"),f=(0,s.Q2)("touch-swipe");return(0,s.wg)(),(0,s.j4)(w,{ref:"linkConfigureDialogRef",maximized:e.$q.platform.is.mobile,"transition-show":"slide-left","transition-hide":"slide-right","full-height":"",position:"right",onBeforeHide:o.saveInstallationLinkConfig,onHide:o.onDialogHide},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(k,{style:{width:"700px","max-width":"90vw"}},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",V,[(0,s.Wm)("div",H,[(0,s.Wm)("div",j,(0,i.zw)(n.dialogHeader),1)]),(0,s.Wm)("div",U,[(0,s.wy)((0,s.Wm)(r,{color:"grey-7",dense:"",round:"",flat:"",icon:"arrow_forward"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(e.$t("tooltips.close")),1)])),_:1})])),_:1},512),[[b]])])])])),_:1}),(0,s.Wm)(m,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",D,[(0,s.Wm)(k,{flat:""},{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",P,[(0,s.Wm)("div",A,(0,i.zw)(e.$t("components.settings.link.name"))+":",1),(0,s.Wm)("div",L,(0,i.zw)(e.name),1)]),(0,s.Wm)("div",N,[(0,s.Wm)("div",B,(0,i.zw)(e.$t("components.settings.link.address"))+":",1),(0,s.Wm)("div",J,(0,i.zw)(e.address),1)]),(0,s.Wm)("div",O,[(0,s.Wm)("div",F,(0,i.zw)(e.$t("components.settings.link.version"))+":",1),(0,s.Wm)("div",K,(0,i.zw)(e.version),1)])])),_:1}),(0,s.Wm)(u),(0,s.Wm)(m,{class:"q-pa-none"},{default:(0,s.w5)((()=>[(0,s.Wm)("h5",Y,(0,i.zw)(e.$t("components.settings.link.connection")),1),(0,s.Wm)("div",E,[(0,s.Wm)(c,{outlined:"",color:"primary",modelValue:e.address,"onUpdate:modelValue":t[1]||(t[1]=t=>e.address=t),label:e.$t("components.settings.link.address"),placeholder:e.address},null,8,["modelValue","label","placeholder"])]),(0,s.Wm)("h5",G,(0,i.zw)(e.$t("components.settings.link.configuration")),1),(0,s.Wm)("div",M,[null===e.enableReceivingTasks?((0,s.wg)(),(0,s.j4)(g,{key:0,type:"QToggle"})):((0,s.wg)(),(0,s.j4)(p,{key:1,modelValue:e.enableReceivingTasks,"onUpdate:modelValue":t[2]||(t[2]=t=>e.enableReceivingTasks=t),label:e.$t("components.settings.link.allowReceivingTasks")},null,8,["modelValue","label"]))]),(0,s.Wm)("div",X,[null===e.enableSendingTasks?((0,s.wg)(),(0,s.j4)(g,{key:0,type:"QToggle"})):((0,s.wg)(),(0,s.j4)(p,{key:1,modelValue:e.enableSendingTasks,"onUpdate:modelValue":t[3]||(t[3]=t=>e.enableSendingTasks=t),label:e.$t("components.settings.link.allowSendingTasks"),disable:"???"===e.address},null,8,["modelValue","label","disable"]))]),e.enableSendingTasks?((0,s.wg)(),(0,s.j4)("div",ee,[(0,s.Wm)("div",te,[null===e.enableTaskPreloading?((0,s.wg)(),(0,s.j4)(g,{key:0,type:"QToggle"})):((0,s.wg)(),(0,s.j4)(p,{key:1,modelValue:e.enableTaskPreloading,"onUpdate:modelValue":t[4]||(t[4]=t=>e.enableTaskPreloading=t),label:e.$t("components.settings.link.enableTaskPreloading")},null,8,["modelValue","label"]))])])):(0,s.kq)("",!0),(0,s.Wm)("div",ne,[null===e.enableDistributedWorkerCount?((0,s.wg)(),(0,s.j4)(g,{key:0,type:"QToggle"})):((0,s.wg)(),(0,s.j4)(p,{key:1,modelValue:e.enableDistributedWorkerCount,"onUpdate:modelValue":t[5]||(t[5]=t=>e.enableDistributedWorkerCount=t),label:e.$t("components.settings.link.enableDistributedWorkerCount")},null,8,["modelValue","label"]))]),e.enableDistributedWorkerCount?((0,s.wg)(),(0,s.j4)("div",se,[(0,s.Wm)("div",ie,[null===e.distributedWorkerCountTarget?((0,s.wg)(),(0,s.j4)(g,{key:0,type:"QSlider"})):(0,s.kq)("",!0),(0,s.Wm)("div",le,[null!==e.distributedWorkerCountTarget?((0,s.wg)(),(0,s.j4)(h,{key:0,modelValue:e.distributedWorkerCountTarget,"onUpdate:modelValue":t[6]||(t[6]=t=>e.distributedWorkerCountTarget=t),min:0,max:12,label:"","label-value":e.$t("components.settings.link.workerTarget")+": "+e.distributedWorkerCountTarget,"label-always":"",color:"primary"},null,8,["modelValue","label-value"])):(0,s.kq)("",!0)])])])):(0,s.kq)("",!0)])),_:1})])),_:1})])])),_:1})])),_:1},512),[[f,o.hide,void 0,{touch:!0,right:!0}]])])),_:1},8,["maximized","onBeforeHide","onHide"])}var oe=n(52),de=n.n(oe),re=n(7689);const me={name:"LinkConfigureDialog",props:{dialogHeader:{type:String,default:" --- header --- "},uuid:{type:String,default:" - "}},emits:["ok","hide","path"],methods:{show(){this.$refs.linkConfigureDialogRef.show(),this.fetchInstallationLinkConfig(this.uuid)},hide(){this.$refs.linkConfigureDialogRef.hide()},onDialogHide(){this.$emit("ok",{}),this.$emit("hide")},fetchInstallationLinkConfig:function(e){this.currentUuid=e;let t={uuid:this.currentUuid};de()({method:"post",url:(0,re.J4)("v2","settings/link/read"),data:t}).then((e=>{let t=e.data.link_config;this.address=t.address,this.available=t.available,this.name=t.name,this.version=t.version,this.enableReceivingTasks=t.enable_receiving_tasks,this.enableSendingTasks=t.enable_sending_tasks,this.enableTaskPreloading=t.enable_task_preloading,this.enableDistributedWorkerCount=t.enable_distributed_worker_count,this.distributedWorkerCountTarget=e.data.distributed_worker_count_target}))},saveInstallationLinkConfig:function(){let e={link_config:{uuid:this.currentUuid,address:this.address,enable_receiving_tasks:this.enableReceivingTasks,enable_sending_tasks:this.enableSendingTasks,enable_task_preloading:this.enableTaskPreloading,enable_distributed_worker_count:this.enableDistributedWorkerCount},distributed_worker_count_target:this.distributedWorkerCountTarget};de()({method:"post",url:(0,re.J4)("v2","settings/link/write"),data:e}).then((e=>{this.$q.notify({color:"positive",position:"top",icon:"cloud_done",message:this.$t("notifications.saved"),timeout:200})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToSaveSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}},watch:{uuid(e){e.length>0&&(this.currentUuid=this.uuid)}},data:function(){return{maximizedToggle:!0,currentUuid:(0,R.iH)(null),address:(0,R.iH)(""),available:(0,R.iH)(!1),name:(0,R.iH)(""),version:(0,R.iH)(""),enableReceivingTasks:(0,R.iH)(null),enableSendingTasks:(0,R.iH)(null),enableTaskPreloading:(0,R.iH)(null),enableDistributedWorkerCount:(0,R.iH)(null),distributedWorkerCountTarget:(0,R.iH)(null)}}};var ue=n(6778),ce=n(151),ge=n(5589),pe=n(2165),he=n(8870),ke=n(5869),we=n(4842),be=n(4103),fe=n(8886),ve=n(2064),We=n(8020),_e=n(677),qe=n(7518),ye=n.n(qe);me.render=ae;const Ie=me;ye()(me,"components",{QDialog:ue.Z,QCard:ce.Z,QCardSection:ge.Z,QBtn:pe.Z,QTooltip:he.Z,QSeparator:ke.Z,QInput:we.Z,QSkeleton:be.ZP,QToggle:fe.Z,QSlider:ve.Z}),ye()(me,"directives",{TouchSwipe:We.Z,ClosePopup:_e.Z});const $e={name:"SettingsLink",setup(){(0,Z.Z)();const{t:e}=(0,z.QT)();let t=null,n=(0,x.A)(e);function i(){t=n.init()}function l(){n.close()}(0,s.bv)((()=>{i()})),(0,s.Ah)((()=>{l()}))},data(){return{installationName:(0,R.iH)(null),remoteInstallations:(0,R.iH)(null),newRemoteInstallation:(0,R.iH)(!1),newRemoteInstallationAddress:(0,R.iH)("")}},methods:{fetchSettings:function(){de()({method:"get",url:(0,re.J4)("v2","settings/read")}).then((e=>{this.installationName=e.data.settings.installation_name;let t=[];for(let n=0;n<e.data.settings.remote_installations.length;n++){let s=e.data.settings.remote_installations[n];t[t.length]={address:s.address,enableReceivingTasks:s.enable_receiving_tasks,enableSendingTasks:s.enable_sending_tasks,name:s.name,version:s.version,uuid:s.uuid,available:s.available}}this.remoteInstallations=t})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToFetchSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},save:function(){let e=[];for(let n=0;n<this.remoteInstallations.length;n++)e[e.length]={address:this.remoteInstallations[n].address,enable_receiving_tasks:this.remoteInstallations[n].enableReceivingTasks,enable_sending_tasks:this.remoteInstallations[n].enableSendingTasks,name:this.remoteInstallations[n].name,version:this.remoteInstallations[n].version,uuid:this.remoteInstallations[n].uuid,available:this.remoteInstallations[n].available};let t={settings:{installation_name:this.installationName,remote_installations:e}};de()({method:"post",url:(0,re.J4)("v2","settings/write"),data:t}).then((e=>{this.fetchSettings(),this.$q.notify({color:"positive",position:"top",icon:"cloud_done",message:this.$t("notifications.saved"),timeout:200})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToSaveSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},addNewRemoteInstallation:function(){for(let t=0;t<this.remoteInstallations.length;t++)if(this.newRemoteInstallationAddress===this.remoteInstallations[t].address)return void this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.remoteInstallationAlreadyInList"),icon:"report_problem",actions:[{icon:"close",color:"white"}]});let e={address:this.newRemoteInstallationAddress};de()({method:"post",url:(0,re.J4)("v2","settings/link/validate"),data:e}).then((e=>{if("undefined"===typeof e.data.installation.settings.installation_name)this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.incompatibleRemoteInstallation"),icon:"report_problem",actions:[{icon:"close",color:"white"}]});else{let t=e.data.installation.settings.installation_name,n=e.data.installation.version,s=e.data.installation.session.uuid;this.remoteInstallations[this.remoteInstallations.length]={address:this.newRemoteInstallationAddress,enable_receiving_tasks:!1,enable_sending_tasks:!1,name:t,version:n,uuid:s,available:!0},this.save()}})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.invalidRemoteInstallationAddress"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},deleteRemoteInstallation:function(e){let t=[];for(let n=0;n<this.remoteInstallations.length;n++)n!==e&&(t[t.length]=this.remoteInstallations[n]);this.remoteInstallations=t},configureRemoteInstallation:function(e){let t=this.remoteInstallations[e];this.$q.dialog({component:Ie,componentProps:{dialogHeader:this.$t("headers.configureRemoteInstallationLink"),uuid:t.uuid}}).onOk((e=>{})).onDismiss((()=>{this.fetchSettings()}))}},created(){this.fetchSettings()},computed:{dragOptions(){return{animation:100,group:"scheduleOrder",disabled:!1,ghostClass:"ghost",direction:"vertical",delay:200,delayOnTouchOnly:!0}}}};var Te=n(4379),Ce=n(5269),Qe=n(7011),Se=n(3414),xe=n(2035),Re=n(4027),Ze=n(2350),ze=n(846),Ve=n(2025),He=n(9367);$e.render=S;const je=$e;ye()($e,"components",{QPage:Te.Z,QForm:Ce.Z,QSkeleton:be.ZP,QInput:we.Z,QSeparator:ke.Z,QList:Qe.Z,QItem:Se.Z,QItemSection:xe.Z,QImg:Re.Z,QItemLabel:Ze.Z,QBtn:pe.Z,QTooltip:he.Z,QBar:ze.Z,QSpace:Ve.Z,QDialog:ue.Z,QCard:ce.Z,QCardSection:ge.Z,QCardActions:He.Z}),ye()($e,"directives",{ClosePopup:_e.Z})}}]);