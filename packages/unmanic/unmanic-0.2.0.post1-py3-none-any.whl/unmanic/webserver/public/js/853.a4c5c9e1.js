(self["webpackChunkunmanic_frontend"]=self["webpackChunkunmanic_frontend"]||[]).push([[853],{2853:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>Ht});var s=o(3673),l=o(2323);const a={class:"q-pa-none"},r={class:"row"},n={class:"col q-ma-sm"},i={class:"row items-center no-wrap"},c={class:"col"},d={class:"col-auto"},m={class:"row"},u={key:0,class:"full-width row flex-center text-accent q-gutter-sm"},p={class:"row"},w={class:"col-12 col-md-6"},f={class:"q-ma-sm"},g={class:"col-12 col-md-6"},k={class:"q-ma-sm"};function h(e,t,o,h,W,_){const v=(0,s.up)("q-icon"),b=(0,s.up)("q-item-label"),y=(0,s.up)("q-item-section"),q=(0,s.up)("q-item"),T=(0,s.up)("q-separator"),$=(0,s.up)("q-list"),Z=(0,s.up)("q-btn-dropdown"),Q=(0,s.up)("q-card-section"),L=(0,s.up)("WorkerProgress"),z=(0,s.up)("q-card"),P=(0,s.up)("PendingTasks"),S=(0,s.up)("CompletedTasks"),x=(0,s.up)("q-page"),C=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(x,{padding:""},{default:(0,s.w5)((()=>[(0,s.Wm)("div",a,[(0,s.Wm)("div",r,[(0,s.Wm)("div",n,[(0,s.Wm)(z,null,{default:(0,s.w5)((()=>[(0,s.Wm)(Q,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",i,[(0,s.Wm)("div",c,[(0,s.Wm)("div",{class:[e.$q.dark.isActive?"text-primary":"text-indigo-10","text-h6"]},[(0,s.Wm)(v,{name:"fas fa-spinner"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.workers")),1)],2)]),(0,s.Wm)("div",d,[(0,s.Wm)(Z,{class:"q-ml-sm",color:0===Object.keys(h.workerProgressList).length?"grey-7":"secondary","disable-main-btn":0===Object.keys(h.workerProgressList).length,label:e.$t("navigation.options")},{default:(0,s.w5)((()=>[(0,s.Wm)($,null,{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(q,{clickable:"",onClick:t[1]||(t[1]=e=>_.pauseAllWorkers())},{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s.Wm)(v,{name:"pause"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.pauseAllWorkers")),1)])),_:1})])),_:1})])),_:1},512),[[C]]),(0,s.wy)((0,s.Wm)(q,{clickable:"",onClick:t[2]||(t[2]=e=>_.resumeAllWorkers())},{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s.Wm)(v,{name:"play_arrow"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.resumeAllWorkers")),1)])),_:1})])),_:1})])),_:1},512),[[C]]),(0,s.Wm)(T),(0,s.wy)((0,s.Wm)(q,{clickable:"",onClick:t[3]||(t[3]=e=>_.terminateAllWorkers())},{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s.Wm)(v,{name:"fas fa-skull-crossbones"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.terminateAllWorkers")),1)])),_:1})])),_:1})])),_:1},512),[[C]])])),_:1})])),_:1},8,["color","disable-main-btn","label"])])])])),_:1}),(0,s.Wm)(Q,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",m,[0===Object.keys(h.workerProgressList).length?((0,s.wg)(),(0,s.j4)("div",u,[(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.listEmpty")),1)])),_:1})])):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.j4)(s.HY,null,(0,s.Ko)(h.workerProgressList,((e,t)=>((0,s.wg)(),(0,s.j4)(L,(0,s.dG)({key:t},e),null,16)))),128))])])),_:1})])),_:1})])]),(0,s.Wm)("div",p,[(0,s.Wm)("div",w,[(0,s.Wm)("div",f,[(0,s.Wm)(P,h.pendingTasksData,null,16)])]),(0,s.Wm)("div",g,[(0,s.Wm)("div",k,[(0,s.Wm)(S,h.completedTasksData,null,16)])])])])])),_:1})}o(71);const W=(0,s.HX)("data-v-5ae7d2d0");(0,s.dD)("data-v-5ae7d2d0");const _={class:"row items-center no-wrap"},v={class:"col"},b={key:0,class:"text-h8 text-primary"},y={key:1,class:"text-h8 text-primary"},q={class:"col-auto"},T={class:"row"},$={class:"row"},Z=(0,s.Wm)("div",{class:"column q-ml-sm"},"ETC:",-1),Q={class:"column q-ml-lg"},L={class:"row items-center no-wrap"},z={class:"col"},P={class:"text-h6 text-primary"},S={class:"col-auto"},x={class:"row"},C={class:"row"};(0,s.Cn)();const U=W(((e,t,o,a,r,n)=>{const i=(0,s.up)("q-tooltip"),c=(0,s.up)("q-btn"),d=(0,s.up)("q-card-section"),m=(0,s.up)("q-separator"),u=(0,s.up)("q-avatar"),p=(0,s.up)("q-circular-progress"),w=(0,s.up)("q-item-label"),f=(0,s.up)("q-item-section"),g=(0,s.up)("q-item"),k=(0,s.up)("q-list"),h=(0,s.up)("WorkerProgressStatus"),U=(0,s.up)("WorkerProgressLog"),D=(0,s.up)("q-card"),j=(0,s.up)("q-dialog"),I=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(D,{inline:"",style:{width:"370px"},class:"worker-progress-card"},{default:W((()=>[(0,s.Wm)(d,{class:"",maxlength:"2"},{default:W((()=>[(0,s.Wm)("div",_,[(0,s.Wm)("div",v,[e.label.length<50?((0,s.wg)(),(0,s.j4)("div",b,(0,l.zw)(e.label),1)):((0,s.wg)(),(0,s.j4)("div",y,(0,l.zw)(e.label.substring(0,48)+".."),1))]),(0,s.Wm)("div",q,[(0,s.Wm)(c,{onClick:t[1]||(t[1]=t=>e.workerProgressPopup=!0),color:"grey-7",dense:"",round:"",flat:"",icon:"open_in_full"},{default:W((()=>[(0,s.Wm)(i,{class:"bg-white text-primary"},{default:W((()=>[(0,s.Uk)((0,l.zw)(e.$t("navigation.showMore")),1)])),_:1})])),_:1})])])])),_:1}),(0,s.Wm)(m),(0,s.Wm)("div",T,[(0,s.Wm)(d,{class:"q-pb-none col q-pb-none justify-center full-height full-width text-center"},{default:W((()=>[(0,s.Wm)(p,{indeterminate:e.indeterminate,"show-value":"",value:e.progress,size:"90px",thickness:.2,color:e.color,"center-color":e.$q.dark.isActive?"grey-10":"grey-3","track-color":"grey-7","font-size":"10px",class:"q-ma-md"},{default:W((()=>[(0,s.Wm)(u,{size:"60px"},{default:W((()=>[(0,s.Uk)((0,l.zw)(e.progressText),1)])),_:1})])),_:1},8,["indeterminate","value","thickness","color","center-color"])])),_:1}),(0,s.Wm)(d,{class:"q-pb-none col-7"},{default:W((()=>[(0,s.Wm)(k,{bordered:"",padding:""},{default:W((()=>[(0,s.Wm)(g,null,{default:W((()=>[(0,s.Wm)(f,null,{default:W((()=>[(0,s.Wm)(w,null,{default:W((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.stateLabel")),1)])),_:1}),(0,s.Wm)(w,{caption:""},{default:W((()=>[(0,s.Uk)((0,l.zw)(e.state),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(g,null,{default:W((()=>[(0,s.Wm)(f,null,{default:W((()=>[(0,s.Wm)(w,null,{default:W((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.currentRunnerLabel")),1)])),_:1}),(0,s.Wm)(w,{caption:""},{default:W((()=>[(0,s.Uk)((0,l.zw)(e.currentRunner),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})]),(0,s.Wm)(d,{class:"q-pt-sm"},{default:W((()=>[(0,s.Wm)("div",$,[Z,(0,s.Wm)("div",Q,(0,l.zw)(e.etc),1),(0,s.Wm)(i,{class:"bg-white text-primary"},{default:W((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.etc")),1)])),_:1})])])),_:1}),(0,s.Wm)(d,{class:"q-pa-none"},{default:W((()=>[(0,s.Wm)(j,{modelValue:e.workerProgressPopup,"onUpdate:modelValue":t[2]||(t[2]=t=>e.workerProgressPopup=t),"full-width":"","full-height":""},{default:W((()=>[(0,s.Wm)(D,null,{default:W((()=>[(0,s.Wm)(d,{class:"bg-card-head"},{default:W((()=>[(0,s.Wm)("div",L,[(0,s.Wm)("div",z,[(0,s.Wm)("div",P,(0,l.zw)(e.label),1)]),(0,s.Wm)("div",S,[(0,s.wy)((0,s.Wm)(c,{color:"grey-7",dense:"",round:"",flat:"",icon:"close_fullscreen"},{default:W((()=>[(0,s.Wm)(i,{class:"bg-white text-primary"},{default:W((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.close")),1)])),_:1})])),_:1},512),[[I]])])])])),_:1}),(0,s.Wm)(d,{class:"q-pt-none"},{default:W((()=>[(0,s.Wm)("div",x,[(0,s.Wm)(d,{class:"col-12 col-md-7"},{default:W((()=>[(0,s.Wm)(h,{id:e.id,state:e.state,currentRunner:e.currentRunner,startTime:e.startTime,totalProcTime:e.totalProcTime,paused:e.paused,idle:e.idle},null,8,["id","state","currentRunner","startTime","totalProcTime","paused","idle"])])),_:1}),(0,s.Wm)(d,{class:"col-12 col-md q-pb-none justify-center full-height full-width text-center"},{default:W((()=>[(0,s.Wm)(p,{indeterminate:e.indeterminate,"show-value":"",value:e.progress,size:"90px",thickness:.2,color:e.color,"center-color":e.$q.dark.isActive?"grey-10":"grey-3","track-color":"grey-7","font-size":"10px",class:"q-ma-md"},{default:W((()=>[(0,s.Wm)(u,{size:"60px"},{default:W((()=>[(0,s.Uk)((0,l.zw)(e.progressText),1)])),_:1})])),_:1},8,["indeterminate","value","thickness","color","center-color"])])),_:1})]),(0,s.Wm)("div",C,[(0,s.Wm)(d,{class:"col"},{default:W((()=>[(0,s.Wm)(U,{workerLog:e.workerLog},null,8,["workerLog"])])),_:1})])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})}));var D=o(1959);const j={class:"row items-center no-wrap"},I={class:"col"},H={class:"text-h6 text-grey-8"},R={class:"col-auto"};function A(e,t,o,a,r,n){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-item-label"),d=(0,s.up)("q-item-section"),m=(0,s.up)("q-item"),u=(0,s.up)("q-separator"),p=(0,s.up)("q-list"),w=(0,s.up)("q-btn-dropdown"),f=(0,s.up)("q-card-section"),g=(0,s.up)("q-card"),k=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(g,null,{default:(0,s.w5)((()=>[(0,s.Wm)(f,{class:"bg-card-head q-pa-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",j,[(0,s.Wm)("div",I,[(0,s.Wm)("div",H,(0,l.zw)(e.$t("components.workers.status")),1)]),(0,s.Wm)("div",R,[(0,s.Wm)(w,{class:"q-ml-sm",color:"secondary",label:e.$t("navigation.options")},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[o.paused?(0,s.wy)(((0,s.wg)(),(0,s.j4)(m,{key:0,clickable:"",onClick:t[1]||(t[1]=e=>n.resumeWorker())},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"play_arrow"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.resumeWorker")),1)])),_:1})])),_:1})])),_:1},512)),[[k]]):(0,s.wy)(((0,s.wg)(),(0,s.j4)(m,{key:1,clickable:"",onClick:t[2]||(t[2]=e=>n.pauseWorker())},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"pause"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.pauseWorker")),1)])),_:1})])),_:1})])),_:1},512)),[[k]]),(0,s.Wm)(u),(0,s.wy)((0,s.Wm)(m,{clickable:"",onClick:t[3]||(t[3]=e=>n.terminateWorkerPrompt())},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"fas fa-skull-crossbones"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.workers.terminateWorker")),1)])),_:1})])),_:1})])),_:1},512),[[k]])])),_:1})])),_:1},8,["label"])])])])),_:1}),(0,s.Wm)(u),(0,s.Wm)(p,{bordered:"",padding:""},{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.stateLabel")),1)])),_:1}),(0,s.Wm)(c,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(o.state),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.currentRunnerLabel")),1)])),_:1}),(0,s.Wm)(c,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(o.currentRunner),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(m,{class:"worker-progress-card-state-t-start"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.startTimeLabel")),1)])),_:1}),(0,s.Wm)(c,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(o.startTime),1)])),_:1})])),_:1})])),_:1}),(0,s.Wm)(m,{class:"worker-progress-card-state-t-total"},{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("components.workers.totalProcessingTimeLabel")),1)])),_:1}),(0,s.Wm)(c,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(o.totalProcTime),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var B=o(52),N=o.n(B),J=o(7689);const V={setup(){return{}},props:{id:{type:String},state:{type:String,default:"Waiting for another task..."},currentRunner:{type:String,default:""},startTime:{type:String,default:""},totalProcTime:{type:String,default:""},idle:{type:Boolean},paused:{type:Boolean}},methods:{pauseWorker:function(){let e={worker_id:this.id};N()({method:"post",url:(0,J.J4)("v2","workers/worker/pause"),data:e}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerPaused"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerPausedFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},resumeWorker:function(){let e={worker_id:this.id};N()({method:"post",url:(0,J.J4)("v2","workers/worker/resume"),data:e}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerResumed"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerResumedFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},terminateWorker:function(){let e={worker_id:this.id};N()({method:"delete",url:(0,J.J4)("v2","workers/worker/terminate"),data:e}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerTerminated"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerTerminationFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},terminateWorkerPrompt:function(){this.idle?this.terminateWorker():this.$q.dialog({title:this.$t("headers.confirm"),message:this.$t("components.workers.terminateWorkerWarning"),cancel:!0,persistent:!0}).onOk((()=>{this.terminateWorker()}))}}};var M=o(151),E=o(5589),O=o(2226),F=o(7011),Y=o(3414),K=o(2035),G=o(2350),X=o(4554),ee=o(5869),te=o(677),oe=o(7518),se=o.n(oe);V.render=A;const le=V;se()(V,"components",{QCard:M.Z,QCardSection:E.Z,QBtnDropdown:O.Z,QList:F.Z,QItem:Y.Z,QItemSection:K.Z,QItemLabel:G.Z,QIcon:X.Z,QSeparator:ee.Z}),se()(V,"directives",{ClosePopup:te.Z});const ae={class:"row items-center no-wrap"},re={class:"col"},ne={class:"text-h6 text-grey-8"},ie={class:"q-ma-none q-pa-none"};function ce(e,t,o,a,r,n){const i=(0,s.up)("q-card-section"),c=(0,s.up)("q-separator"),d=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{class:"bg-card-head q-pa-sm"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",ae,[(0,s.Wm)("div",re,[(0,s.Wm)("div",ne,(0,l.zw)(e.$t("components.workers.workerLog")),1)])])])),_:1}),(0,s.Wm)(c),(0,s.Wm)(i,{class:"q-pa-md"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.j4)(s.HY,null,(0,s.Ko)(o.workerLog,((e,t)=>((0,s.wg)(),(0,s.j4)("div",{key:t},[(0,s.Wm)("p",ie,(0,l.zw)(e),1)])))),128))])),_:1})])),_:1})}const de={setup(){return{}},props:{workerLog:{type:Array}}};de.render=ce;const me=de;se()(de,"components",{QCard:M.Z,QCardSection:E.Z,QSeparator:ee.Z});const ue=(0,s.aZ)({name:"WorkerProgress",components:{WorkerProgressStatus:le,WorkerProgressLog:me},data(){return{workerProgressPopup:(0,D.iH)(!1)}},props:{id:{type:String,required:!0},label:{type:String,required:!0},name:{type:String,required:!0},progress:{type:Number,default:100},progressText:{type:String,default:""},etc:{type:String,default:""},color:{type:String,default:"warning"},state:{type:String,default:"Waiting for another task..."},currentRunner:{type:String,default:""},startTime:{type:String,default:""},totalProcTime:{type:String,default:""},indeterminate:{type:Boolean,default:!1},workerLog:{type:Array},idle:{type:Boolean},paused:{type:Boolean}}});var pe=o(2165),we=o(8870),fe=o(6122),ge=o(5096),ke=o(6778);ue.render=U,ue.__scopeId="data-v-5ae7d2d0";const he=ue;se()(ue,"components",{QCard:M.Z,QCardSection:E.Z,QBtn:pe.Z,QTooltip:we.Z,QSeparator:ee.Z,QCircularProgress:fe.Z,QAvatar:ge.Z,QList:F.Z,QItem:Y.Z,QItemSection:K.Z,QItemLabel:G.Z,QDialog:ke.Z}),se()(ue,"directives",{ClosePopup:te.Z});const We={class:"row items-center no-wrap"},_e={class:"col"},ve={class:"col-auto"},be={class:"q-pa-md"},ye={class:"full-width row flex-center text-accent q-gutter-sm"},qe={class:"full-width row flex-center text-accent q-gutter-sm"},Te={class:"row"},$e=(0,s.Wm)("div",{class:"col"},null,-1),Ze={class:"col"},Qe={class:"row items-center no-wrap"},Le={class:"col"},ze={class:"text-h6 text-amber-10"},Pe=(0,s.Uk)(" Pending Tasks "),Se={class:"col-auto"},xe={class:"q-pa-md"};function Ce(e,t,o,a,r,n){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-tooltip"),d=(0,s.up)("q-btn"),m=(0,s.up)("q-card-section"),u=(0,s.up)("q-item-label"),p=(0,s.up)("q-item-section"),w=(0,s.up)("q-item"),f=(0,s.up)("q-list"),g=(0,s.up)("q-space"),k=(0,s.up)("PendingTasksTable"),h=(0,s.up)("q-card"),W=(0,s.up)("q-dialog"),_=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(h,null,{default:(0,s.w5)((()=>[(0,s.Wm)(m,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",We,[(0,s.Wm)("div",_e,[(0,s.Wm)("div",{class:[e.$q.dark.isActive?"text-amber-8":"text-amber-10","text-h6"]},[(0,s.Wm)(i,{name:"fas fa-list-ul"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.pendingTasks")),1)],2)]),(0,s.Wm)("div",ve,[(0,s.Wm)(d,{onClick:t[1]||(t[1]=t=>e.pendingTasksPopup=!0),color:"grey-7",dense:"",round:"",flat:"",icon:"open_in_full"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("navigation.showMore")),1)])),_:1})])),_:1})])])])),_:1}),(0,s.Wm)(m,{class:"q-pb-none"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",be,[(0,s.Wm)(f,{separator:""},{default:(0,s.w5)((()=>[e.taskList?e.taskList.length?((0,s.wg)(!0),(0,s.j4)(s.HY,{key:2},(0,s.Ko)(e.taskList,(e=>((0,s.wg)(),(0,s.j4)(w,(0,s.dG)({key:e.id},e),{default:(0,s.w5)((()=>[(0,s.Wm)(p,{avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"pending",class:"text-amber-10",style:{opacity:"0.8"}})])),_:1}),(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.label),1)])),_:2},1024)])),_:2},1024)])),_:2},1040)))),128)):((0,s.wg)(),(0,s.j4)(w,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",qe,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("headers.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1})])),_:1})):((0,s.wg)(),(0,s.j4)(w,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",ye,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("headers.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1})])),_:1}))])),_:1})])])),_:1}),(0,s.Wm)(m,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",Te,[$e,(0,s.Wm)("div",Ze,[(0,s.Wm)(d,{class:"float-right",label:e.$t("components.pendingTasks.rescanLibrary"),color:"secondary",onClick:t[2]||(t[2]=t=>e.rescanLibrary())},null,8,["label"])])]),(0,s.Wm)(g)])),_:1}),(0,s.Wm)(W,{modelValue:e.pendingTasksPopup,"onUpdate:modelValue":t[3]||(t[3]=t=>e.pendingTasksPopup=t),"full-width":"","full-height":""},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Wm)(m,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",Qe,[(0,s.Wm)("div",Le,[(0,s.Wm)("div",ze,[(0,s.Wm)(i,{name:"fas fa-list-ul"}),Pe])]),(0,s.Wm)("div",Se,[(0,s.wy)((0,s.Wm)(d,{color:"grey-7",dense:"",round:"",flat:"",icon:"close_fullscreen"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.close")),1)])),_:1})])),_:1},512),[[_]])])])])),_:1}),(0,s.Wm)(m,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",xe,[(0,s.Wm)(k)])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}const Ue={class:"q-pa-md"},De={class:"full-width row flex-center text-accent q-gutter-sm"};function je(e,t,o,a,r,n){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-input"),d=(0,s.up)("q-item-label"),m=(0,s.up)("q-item-section"),u=(0,s.up)("q-item"),p=(0,s.up)("q-separator"),w=(0,s.up)("q-list"),f=(0,s.up)("q-btn-dropdown"),g=(0,s.up)("q-table"),k=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)("div",Ue,[(0,s.Wm)(g,{title:"Pending Tasks",rows:a.rows,columns:a.columns,"row-key":"name",pagination:a.pagination,"onUpdate:pagination":t[2]||(t[2]=e=>a.pagination=e),loading:a.loading,filter:a.filter,onRequest:a.onRequest,"binary-state-sort":"","selected-rows-label":a.getSelectedString,selection:"multiple",selected:a.selected,"onUpdate:selected":t[3]||(t[3]=e=>a.selected=e)},{"top-left":(0,s.w5)((()=>[(0,s.Wm)(c,{filled:"",class:"shadow-1",dense:"",debounce:"300",color:"primary",modelValue:a.filter,"onUpdate:modelValue":t[1]||(t[1]=e=>a.filter=e),placeholder:e.$t("navigation.search")},{append:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"search"})])),_:1},8,["modelValue","placeholder"])])),"top-right":(0,s.w5)((()=>[(0,s.Wm)(f,{class:"q-ml-sm",color:"secondary",label:e.$t("navigation.options")},{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(u,{clickable:"",onClick:a.rescanLibrary},{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"search"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.pendingTasks.rescanLibrary")),1)])),_:1})])),_:1})])),_:1},8,["onClick"]),[[k]]),(0,s.Wm)(p),(0,s.wy)((0,s.Wm)(u,{clickable:"",onClick:a.moveToTop},{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"arrow_upward"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.pendingTasks.moveToTop")),1)])),_:1})])),_:1})])),_:1},8,["onClick"]),[[k]]),(0,s.wy)((0,s.Wm)(u,{clickable:"",onClick:a.moveToBottom},{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"arrow_downward"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.pendingTasks.moveToBottom")),1)])),_:1})])),_:1})])),_:1},8,["onClick"]),[[k]]),(0,s.Wm)(p),(0,s.wy)((0,s.Wm)(u,{clickable:"",onClick:a.deleteSelected},{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"delete_outline"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.pendingTasks.removeSelected")),1)])),_:1})])),_:1})])),_:1},8,["onClick"]),[[k]])])),_:1})])),_:1},8,["label"])])),"no-data":(0,s.w5)((()=>[(0,s.Wm)("div",De,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("headers.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1},8,["rows","columns","pagination","loading","filter","onRequest","selected-rows-label","selected"])])}var Ie=o(8825),He=o(5948);const Re=[{name:"id",label:"Name",required:!0,align:"left",field:e=>e.name,format:e=>`${e}`,sortable:!1},{name:"library",label:"Library",required:!0,align:"left",field:e=>e.libraryName,sortable:!1}],Ae={setup(){const e=(0,Ie.Z)(),{t}=(0,He.QT)(),o=(0,D.iH)([]),l=(0,D.iH)(""),a=(0,D.iH)(!1),r=(0,D.iH)({sortBy:"priority",descending:!0,page:1,rowsPerPage:15,rowsNumber:10}),n=(0,D.iH)([]),i=(0,D.iH)(null);function c(){let e="";return 0!==n.value.length&&(e=`${n.value.length} record${n.value.length>1?"s":""} selected of ${o.value.length}`),e}function d(){N()({method:"post",url:(0,J.J4)("v2","pending/rescan")}).then((e=>{i.value=e.data})).catch((()=>{e.notify({color:"negative",position:"top",message:t("notifications.rescanLibraryError"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}function m(){if(0!==n.value.length){let e=[];for(let o=0;o<n.value.length;o++){let t=n.value[o];e[e.length]=t.id}let t={id_list:e,position:"top"};p(t)}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function u(){if(0!==n.value.length){let e=[];for(let o=0;o<n.value.length;o++){let t=n.value[o];e[e.length]=t.id}let t={id_list:e,position:"bottom"};p(t)}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function p(t){N()({method:"post",url:(0,J.J4)("v2","pending/reorder"),data:t}).then((e=>{i.value=e.data,f({pagination:r.value,filter:l.value})})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting a task reorder",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}function w(){if(0!==n.value.length){let t=[];for(let e=0;e<n.value.length;e++){let o=n.value[e];t[t.length]=o.id}let o={id_list:t};N()({method:"delete",url:(0,J.J4)("v2","pending/tasks"),data:o}).then((e=>{f({pagination:r.value,filter:l.value})})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the selected tasks be deleted",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function f(t){const{page:s,rowsPerPage:l,sortBy:n,descending:i}=t.pagination,c=t.filter;a.value=!0;const d=0===l?r.value.rowsNumber:l,m=(s-1)*l;let u={start:m,length:d,search_value:c,order_by:n,order_direction:i?"desc":"asc"};N()({method:"post",url:(0,J.J4)("v2","pending/tasks"),data:u}).then((e=>{r.value.rowsNumber=e.data.recordsFiltered;const t=[];for(let o=0;o<e.data.results.length;o++){let s=e.data.results[o];t[o]={id:s.id,name:s.abspath,libraryName:s.library_name,completed:s.finish_time,status:s.success?"Success":"Failed"}}o.value.splice(0,o.value.length,...t),r.value.page=s,r.value.rowsPerPage=l,r.value.sortBy=n,r.value.descending=i,a.value=!1})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the pending tasks list",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}return(0,s.bv)((()=>{f({pagination:r.value,filter:void 0})})),{selected:n,filter:l,loading:a,pagination:r,columns:Re,rows:o,getSelectedString:c,onRequest:f,rescanLibrary:d,moveToTop:m,moveToBottom:u,deleteSelected:w,reloadTable(){f({pagination:r.value,filter:l.value})}}}};var Be=o(6429),Ne=o(4842);Ae.render=je;const Je=Ae;se()(Ae,"components",{QTable:Be.Z,QInput:Ne.Z,QIcon:X.Z,QBtnDropdown:O.Z,QList:F.Z,QItem:Y.Z,QItemSection:K.Z,QItemLabel:G.Z,QSeparator:ee.Z}),se()(Ae,"directives",{ClosePopup:te.Z});const Ve=(0,s.aZ)({name:"PendingTasks",components:{PendingTasksTable:Je},data(){return{pendingTasksPopup:(0,D.iH)(!1)}},props:{taskList:{type:Array,required:!0}},methods:{rescanLibrary:function(){N()({method:"post",url:(0,J.J4)("v2","pending/rescan")}).then((e=>{})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.rescanLibraryError"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}}});var Me=o(2025);Ve.render=Ce;const Ee=Ve;se()(Ve,"components",{QCard:M.Z,QCardSection:E.Z,QIcon:X.Z,QBtn:pe.Z,QTooltip:we.Z,QList:F.Z,QItem:Y.Z,QItemSection:K.Z,QItemLabel:G.Z,QSpace:Me.Z,QDialog:ke.Z}),se()(Ve,"directives",{ClosePopup:te.Z});const Oe={class:"row items-center no-wrap"},Fe={class:"col"},Ye={class:"col-auto"},Ke={class:"q-pa-md"},Ge={class:"full-width row flex-center text-accent q-gutter-sm"},Xe={class:"full-width row flex-center text-accent q-gutter-sm"},et={class:"row"},tt={class:"column justify-center"},ot={class:"column justify-center"},st={class:"row items-center no-wrap"},lt={class:"col"},at={class:"text-h6 text-blue-10"},rt={class:"col-auto"},nt={class:"q-pa-md"};function it(e,t,o,a,r,n){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-tooltip"),d=(0,s.up)("q-btn"),m=(0,s.up)("q-card-section"),u=(0,s.up)("q-item-label"),p=(0,s.up)("q-item-section"),w=(0,s.up)("q-item"),f=(0,s.up)("q-list"),g=(0,s.up)("CompletedTasksTable"),k=(0,s.up)("q-card"),h=(0,s.up)("q-dialog"),W=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(k,null,{default:(0,s.w5)((()=>[(0,s.Wm)(m,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",Oe,[(0,s.Wm)("div",Fe,[(0,s.Wm)("div",{class:[e.$q.dark.isActive?"text-cyan-8":"text-cyan-10","text-h6"]},[(0,s.Wm)(i,{name:"fas fa-list-ul"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.completedTasks")),1)],2)]),(0,s.Wm)("div",Ye,[(0,s.Wm)(d,{onClick:t[1]||(t[1]=t=>e.completedTasksPopup=!0),color:"grey-7",dense:"",round:"",flat:"",icon:"open_in_full"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("navigation.showMore")),1)])),_:1})])),_:1})])])])),_:1}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",Ke,[(0,s.Wm)(f,{separator:""},{default:(0,s.w5)((()=>[e.taskList?e.taskList.length?((0,s.wg)(!0),(0,s.j4)(s.HY,{key:2},(0,s.Ko)(e.taskList,(e=>((0,s.wg)(),(0,s.j4)(w,(0,s.dG)({key:e.id},e),{default:(0,s.w5)((()=>[(0,s.Wm)(p,{avatar:""},{default:(0,s.w5)((()=>[e.success?((0,s.wg)(),(0,s.j4)(i,{key:0,name:"check_circle",class:"text-secondary",style:{opacity:"0.8"}})):((0,s.wg)(),(0,s.j4)(i,{key:1,name:"cancel",class:"text-negative",style:{opacity:"0.8"}}))])),_:2},1024),(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.label),1)])),_:2},1024)])),_:2},1024),(0,s.Wm)(p,{side:"",top:""},{default:(0,s.w5)((()=>[(0,s.Wm)("div",et,[(0,s.Wm)("div",tt,[(0,s.Wm)(u,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.dateTimeSinceCompleted),1)])),_:2},1024)]),(0,s.Wm)("div",ot,[(0,s.Wm)(i,{class:"q-ml-sm",name:"event",size:"18px"})])])])),_:2},1024)])),_:2},1040)))),128)):((0,s.wg)(),(0,s.j4)(w,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",Xe,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("headers.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1})])),_:1})):((0,s.wg)(),(0,s.j4)(w,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",Ge,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("headers.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1})])),_:1}))])),_:1})])])),_:1}),(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(h,{modelValue:e.completedTasksPopup,"onUpdate:modelValue":t[2]||(t[2]=t=>e.completedTasksPopup=t),"full-width":"","full-height":""},{default:(0,s.w5)((()=>[(0,s.Wm)(k,null,{default:(0,s.w5)((()=>[(0,s.Wm)(m,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",st,[(0,s.Wm)("div",lt,[(0,s.Wm)("div",at,[(0,s.Wm)(i,{name:"fas fa-list-ul"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.completedTasks")),1)])]),(0,s.Wm)("div",rt,[(0,s.wy)((0,s.Wm)(d,{color:"grey-7",dense:"",round:"",flat:"",icon:"close_fullscreen"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.close")),1)])),_:1})])),_:1},512),[[W]])])])])),_:1}),(0,s.Wm)(m,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",nt,[(0,s.Wm)(g)])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})}const ct={class:"q-pa-md"},dt={class:"row"},mt={class:"row"},ut={class:"full-width row flex-center text-accent q-gutter-sm"},pt={class:"text-h6"};function wt(e,t,o,a,r,n){const i=(0,s.up)("q-icon"),c=(0,s.up)("q-input"),d=(0,s.up)("q-item-label"),m=(0,s.up)("q-item-section"),u=(0,s.up)("q-item"),p=(0,s.up)("q-separator"),w=(0,s.up)("q-list"),f=(0,s.up)("q-btn-dropdown"),g=(0,s.up)("q-badge"),k=(0,s.up)("q-td"),h=(0,s.up)("q-btn"),W=(0,s.up)("q-table"),_=(0,s.up)("q-card-section"),v=(0,s.up)("q-select"),b=(0,s.up)("q-card-actions"),y=(0,s.up)("q-card"),q=(0,s.up)("q-dialog"),T=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(s.HY,null,[(0,s.Wm)("div",ct,[(0,s.Wm)(W,{title:"Completed Tasks",rows:a.rows,columns:a.columns,"row-key":"id",pagination:a.pagination,"onUpdate:pagination":t[2]||(t[2]=e=>a.pagination=e),loading:a.loading,filter:a.filter,onRequest:a.onRequest,"binary-state-sort":"","selected-rows-label":a.getSelectedString,selection:"multiple",selected:a.selected,"onUpdate:selected":t[3]||(t[3]=e=>a.selected=e)},{"top-left":(0,s.w5)((()=>[(0,s.Wm)(c,{filled:"",class:"shadow-1",dense:"",debounce:"300",color:"primary",modelValue:a.filter,"onUpdate:modelValue":t[1]||(t[1]=e=>a.filter=e),placeholder:e.$t("navigation.search")},{append:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"search"})])),_:1},8,["modelValue","placeholder"])])),"top-right":(0,s.w5)((()=>[(0,s.Wm)(f,{class:"q-ml-sm",color:"secondary",label:e.$t("navigation.options")},{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(u,{clickable:"",onClick:a.selectLibraryForRecreateTask},{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"add"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.completedTasks.addToPendingTasksList")),1)])),_:1})])),_:1})])),_:1},8,["onClick"]),[[T]]),(0,s.Wm)(p),(0,s.wy)((0,s.Wm)(u,{clickable:"",onClick:a.deleteSelected},{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{name:"delete_outline"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("components.completedTasks.removeSelected")),1)])),_:1})])),_:1})])),_:1},8,["onClick"]),[[T]])])),_:1})])),_:1},8,["label"])])),"body-cell-task_success":(0,s.w5)((t=>[(0,s.Wm)(k,{props:t},{default:(0,s.w5)((()=>[(0,s.Wm)("div",dt,[t.row.status?((0,s.wg)(),(0,s.j4)(g,{key:0,color:"positive",class:"shadow-1"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("status.success")),1)])),_:1})):((0,s.wg)(),(0,s.j4)(g,{key:1,color:"negative",class:"shadow-1"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("status.failed")),1)])),_:1}))])])),_:2},1032,["props"])])),"body-cell-details":(0,s.w5)((t=>[(0,s.Wm)(k,{props:t},{default:(0,s.w5)((()=>[(0,s.Wm)("div",mt,[(0,s.Wm)(h,{onClick:e=>a.openDetailsDialog(t.row.id),color:"secondary",label:e.$t("components.completedTasks.details")},null,8,["onClick","label"])])])),_:2},1032,["props"])])),"no-data":(0,s.w5)((()=>[(0,s.Wm)("div",ut,[(0,s.Wm)(i,{size:"2em",name:"sentiment_dissatisfied"}),(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("headers.listEmpty")),1)])),_:1}),(0,s.Wm)(i,{size:"2em",name:"priority_high"})])])),_:1},8,["rows","columns","pagination","loading","filter","onRequest","selected-rows-label","selected"])]),(0,s.Wm)(q,{modelValue:a.selectLibrary,"onUpdate:modelValue":t[5]||(t[5]=e=>a.selectLibrary=e),persistent:""},{default:(0,s.w5)((()=>[(0,s.Wm)(y,{style:{"min-width":"350px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)("div",pt,(0,l.zw)(e.$t("headers.selectLibrary")),1)])),_:1}),(0,s.Wm)(_,{class:"q-pt-none"},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{filled:"","emit-value":"","map-options":"",modelValue:a.selectedLibraryId,"onUpdate:modelValue":t[4]||(t[4]=e=>a.selectedLibraryId=e),options:a.LibraryOptions,label:e.$t("components.completedTasks.selectLibraryToAdd")},null,8,["modelValue","options","label"])])),_:1}),(0,s.Wm)(b,{align:"right",class:"text-primary"},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(h,{flat:"",label:e.$t("navigation.cancel")},null,8,["label"]),[[T]]),(0,s.wy)((0,s.Wm)(h,{onClick:a.addSelectedToPendingTaskList,flat:"",label:e.$t("navigation.submit")},null,8,["onClick","label"]),[[T]])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}var ft=o(5616);const gt={printTimeSinceDate(e){let t=new Date,o=Math.floor((t-e)/1e3),s=Math.floor(o/60),l=Math.floor(s/60),a=Math.floor(l/24);return l-=24*a,s=s-24*a*60-60*l,o=o-24*a*60*60-60*l*60-60*s,"Days: "+a+" Hours: "+l+" Minutes: "+s+" Seconds: "+o},printTimeAsHoursMinsSeconds(e){e=Number(e);let t=Math.floor(e/3600),o=Math.floor(e%3600/60),s=Math.floor(e%3600%60),l=t>0?t+(1==t?" hour, ":" hours, "):"",a=o>0?o+(1==o?" minute, ":" minutes, "):"",r=s>0?s+(1==s?" second":" seconds"):"";return l+a+r},printDateTimeString(e){let t=new Date(0);return t.setUTCSeconds(e),ft.ZP.formatDate(t,"YYYY-MM-DD HH:mm:ss")}},kt={class:"row items-center no-wrap"},ht={class:"col-auto"},Wt={class:"col"},_t={class:"text-h6 text-secondary"},vt={class:"q-pt-md q-px-lg",style:{width:"2000px","max-width":"95vw"}},bt={class:"q-pa-md completed-task-details-dialog-content"};function yt(e,t,o,a,r,n){const i=(0,s.up)("q-tooltip"),c=(0,s.up)("q-btn"),d=(0,s.up)("q-icon"),m=(0,s.up)("q-card-section"),u=(0,s.up)("q-card"),p=(0,s.up)("q-dialog"),w=(0,s.Q2)("close-popup"),f=(0,s.Q2)("touch-swipe");return(0,s.wg)(),(0,s.j4)(p,{ref:"dialogRef",maximized:e.$q.platform.is.mobile,"transition-show":"slide-right","transition-hide":"slide-left","full-height":"",position:"left",onHide:n.onDialogHide},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(u,{style:{"max-width":"100vw"}},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{class:"bg-card-head"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",kt,[(0,s.Wm)("div",ht,[(0,s.wy)((0,s.Wm)(c,{color:"grey-7",dense:"",round:"",flat:"",icon:"arrow_back"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{class:"bg-white text-primary"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("tooltips.back")),1)])),_:1})])),_:1},512),[[w]])]),(0,s.Wm)("div",Wt,[(0,s.Wm)("div",_t,[(0,s.Wm)(d,{name:"description"}),(0,s.Uk)(" "+(0,l.zw)(e.$t("headers.completedTaskDetails")),1)])])])])),_:1}),(0,s.Wm)(m,{class:"q-pt-none q-pa-none"},{default:(0,s.w5)((()=>[(0,s.Wm)("div",vt,[(0,s.Wm)("div",bt,[((0,s.wg)(!0),(0,s.j4)(s.HY,null,(0,s.Ko)(e.taskDetails,((e,t)=>((0,s.wg)(),(0,s.j4)("p",{key:t,innerHTML:e},null,8,["innerHTML"])))),128))])])])),_:1})])),_:1},512),[[f,n.hide,void 0,{touch:!0,left:!0}]])])),_:1},8,["maximized","onHide"])}const qt={name:"CompletedTaskLogDialog",props:{completedTaskId:{type:String}},emits:["ok","hide","path"],methods:{show(){this.$refs.dialogRef.show()},hide(){this.$refs.dialogRef.hide()},onDialogHide(){this.$emit("hide")},fetchCompletedTaskLog:function(){let e={task_id:this.completedTaskId};N()({method:"post",url:(0,J.J4)("v2","history/task/log"),data:e}).then((e=>{this.taskDetails=e.data.command_log_lines})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.completedTasks.errorGettingDetails"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}},created(){this.fetchCompletedTaskLog()},data:function(){return{taskDetails:(0,D.iH)([])}}};var Tt=o(8020);qt.render=yt;const $t=qt;se()(qt,"components",{QDialog:ke.Z,QCard:M.Z,QCardSection:E.Z,QBtn:pe.Z,QTooltip:we.Z,QIcon:X.Z}),se()(qt,"directives",{TouchSwipe:Tt.Z,ClosePopup:te.Z});const Zt=[{name:"task_label",label:"Name",required:!0,align:"left",field:"name",sortable:!0},{name:"finish_time",label:"Completed",required:!0,align:"left",field:"dateTimeCompleted",sortable:!0},{name:"task_success",label:"Status",required:!0,align:"left",field:"status",sortable:!0},{name:"details",label:"Details",required:!0,align:"left",field:"id",sortable:!1}],Qt={setup(){const e=(0,Ie.Z)(),{t}=(0,He.QT)(),o=(0,D.iH)([]),l=(0,D.iH)(""),a=(0,D.iH)(!1),r=(0,D.iH)({sortBy:"finish_time",descending:!0,page:1,rowsPerPage:15,rowsNumber:10}),n=(0,D.iH)([]),i=(0,D.iH)(!1),c=(0,D.iH)(null),d=(0,D.iH)([]);function m(){let e="";return 0!==n.value.length&&(e=`${n.value.length} record${n.value.length>1?"s":""} selected of ${o.value.length}`),e}function u(){if(0!==n.value.length){let t=[];for(let e=0;e<n.value.length;e++){let o=n.value[e];t[t.length]=o.id}let o={id_list:t};N()({method:"delete",url:(0,J.J4)("v2","history/tasks"),data:o}).then((e=>{f({pagination:r.value,filter:l.value})})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the selected tasks be deleted",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function p(){N()({method:"get",url:(0,J.J4)("v2","settings/libraries")}).then((e=>{let t,o=[];for(let s=0;s<e.data.libraries.length;s++){let l=e.data.libraries[s];"undefined"===typeof t&&(t=l.id),o[o.length]={label:l.name,value:l.id}}d.value=o,c.value=1,1===o.length?(c.value=t,w()):i.value=!0})).catch((()=>{e.notify({color:"negative",position:"top",message:t("notifications.failedToFetchLibraryList"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}function w(){if(0!==n.value.length){let t=[];for(let e=0;e<n.value.length;e++){let o=n.value[e];t[t.length]=o.id}let o=c.value,s={id_list:t,library_id:o};N()({method:"post",url:(0,J.J4)("v2","history/reprocess"),data:s}).then((e=>{f({pagination:r.value,filter:l.value})})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the selected tasks be added to the pending tasks list",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}else e.notify({color:"warning",position:"top",message:"Nothing selected",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}function f(t){const{page:s,rowsPerPage:l,sortBy:n,descending:i}=t.pagination,c=t.filter;a.value=!0;const d=0===l?r.value.rowsNumber:l,m=(s-1)*l;let u={start:m,length:d,search_value:c,order_by:n,order_direction:i?"desc":"asc"};N()({method:"post",url:(0,J.J4)("v2","history/tasks"),data:u}).then((e=>{r.value.rowsNumber=e.data.recordsFiltered;const t=[];for(let o=0;o<e.data.results.length;o++){let s=e.data.results[o];t[o]={id:s.id,name:s.task_label,dateTimeCompleted:gt.printDateTimeString(s.finish_time),status:s.task_success}}o.value.splice(0,o.value.length,...t),r.value.page=s,r.value.rowsPerPage=l,r.value.sortBy=n,r.value.descending=i,a.value=!1})).catch((()=>{e.notify({color:"negative",position:"top",message:"An error was encountered while requesting the completed tasks list",icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}function g(t){e.dialog({component:$t,componentProps:{completedTaskId:t}}).onOk((e=>{})).onDismiss((()=>{}))}return(0,s.bv)((()=>{f({pagination:r.value,filter:void 0})})),{selected:n,filter:l,loading:a,pagination:r,columns:Zt,rows:o,selectLibrary:i,selectedLibraryId:c,LibraryOptions:d,getSelectedString:m,onRequest:f,deleteSelected:u,selectLibraryForRecreateTask:p,addSelectedToPendingTaskList:w,openDetailsDialog:g}}};var Lt=o(3884),zt=o(9721),Pt=o(8516),St=o(9367);Qt.render=wt;const xt=Qt;se()(Qt,"components",{QTable:Be.Z,QInput:Ne.Z,QIcon:X.Z,QBtnDropdown:O.Z,QList:F.Z,QItem:Y.Z,QItemSection:K.Z,QItemLabel:G.Z,QSeparator:ee.Z,QTd:Lt.Z,QBadge:zt.Z,QBtn:pe.Z,QDialog:ke.Z,QCard:M.Z,QCardSection:E.Z,QSelect:Pt.Z,QCardActions:St.Z}),se()(Qt,"directives",{ClosePopup:te.Z});const Ct=(0,s.aZ)({name:"CompletedTasks",components:{CompletedTasksTable:xt},data(){return{completedTasksPopup:(0,D.iH)(!1)}},props:{taskList:{type:Array,required:!0}}});Ct.render=it;const Ut=Ct;se()(Ct,"components",{QCard:M.Z,QCardSection:E.Z,QIcon:X.Z,QBtn:pe.Z,QTooltip:we.Z,QList:F.Z,QItem:Y.Z,QItemSection:K.Z,QItemLabel:G.Z,QDialog:ke.Z}),se()(Ct,"directives",{ClosePopup:te.Z});var Dt=o(4190);const jt={name:"Dashboard",components:{CompletedTasks:Ut,WorkerProgress:he,PendingTasks:Ee},setup(){const{t:e}=(0,He.QT)(),t=((0,Ie.Z)(),(0,D.iH)([])),o=(0,D.iH)({taskList:[]}),l=(0,D.iH)({taskList:[]});let a=null,r=(0,Dt.A)(e);function n(o){function s(e,t){let o=100-parseInt(e);return parseInt(t)/parseInt(e)*o}let l={};for(let t=0;t<o.length;t++){let a=o[t];if(l["worker-"+a.id]={indeterminate:!1,id:a.id,label:a.name,name:a.name,color:"warning",progress:100,progressText:"-",etc:"...",state:e("components.workers.state.waiting"),currentRunner:e("components.workers.currentRunner.none"),startTime:"",totalProcTime:"",workerLog:[],idle:a.idle,paused:a.paused},a.paused&&(l["worker-"+a.id].label="...",l["worker-"+a.id].color="negative",l["worker-"+a.id].progressText="...",l["worker-"+a.id].state=e("components.workers.state.paused")),!a.idle){l["worker-"+a.id].label=a.name+": "+a.current_file,l["worker-"+a.id].color="secondary",l["worker-"+a.id].state=e("components.workers.state.processing");let t=e("components.workers.currentRunner.indeterminate");if("object"===typeof a.runners_info&&null!==a.runners_info)for(const[e,s]of Object.entries(a.runners_info))"in_progress"===s.status&&(t=s.name);l["worker-"+a.id].currentRunner=t;let o=new Date(1e3*a.start_time);l["worker-"+a.id].startTime=gt.printDateTimeString(a.start_time),l["worker-"+a.id].totalProcTime=gt.printTimeSinceDate(o),l["worker-"+a.id].workerLog=a.worker_log_tail,"undefined"!==typeof a.subprocess.percent&&""!==a.subprocess.percent?(l["worker-"+a.id].progress=Number(a.subprocess.percent),l["worker-"+a.id].progressText=a.subprocess.percent+"%",l["worker-"+a.id].etc=gt.printTimeAsHoursMinsSeconds(s(a.subprocess.percent,a.subprocess.elapsed))):(l["worker-"+a.id].indeterminate=!0,l["worker-"+a.id].progressText="..."),a.paused&&(l["worker-"+a.id].indeterminate=!0,l["worker-"+a.id].color="negative",l["worker-"+a.id].state=e("components.workers.state.paused"))}}t.value=l}function i(e){let t,s=[];for(let o=0;o<e.results.length;o++)t=e.results[o],s[o]={id:e.results[o].id,priority:e.results[o].priority,label:e.results[o].label,status:e.results[o].status};o.value.taskList=s}function c(e){let t,o=[];for(let s=0;s<e.results.length;s++)t=e.results[s],o[s]={id:e.results[s].id,label:e.results[s].label,dateTimeCompleted:gt.printDateTimeString(e.results[s].finish_time),dateTimeSinceCompleted:e.results[s].human_readable_time,success:e.results[s].success};l.value.taskList=o}function d(){a=r.init();let e=r.serverId;r.addEventListener("open","start_dashboard_messages",(function(e){a.send(JSON.stringify({command:"start_workers_info",params:{}})),a.send(JSON.stringify({command:"start_pending_tasks_info",params:{}})),a.send(JSON.stringify({command:"start_completed_tasks_info",params:{}}))})),r.addEventListener("message","handle_dashboard_messages",(function(t){if("string"===typeof t.data){let o=JSON.parse(t.data);if(o.success)switch(null===e?e=o.server_id:o.server_id!==e&&(console.debug("Unmanic server has restarted. Reloading page..."),location.reload()),o.type){case"workers_info":n(o.data);break;case"pending_tasks":i(o.data);break;case"completed_tasks":c(o.data);break}else console.error("WebSocket Error: Received contained errors - "+t.data)}else console.error("WebSocket Error: Received data was not JSON - "+t.data)}))}function m(){r.close()}return(0,s.bv)((()=>{d()})),(0,s.Ah)((()=>{m()})),{workerProgressList:t,pendingTasksData:o,completedTasksData:l}},methods:{pauseAllWorkers:function(){N()({method:"post",url:(0,J.J4)("v2","workers/worker/pause/all"),data:{}}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerPaused"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerPausedFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},resumeAllWorkers:function(){N()({method:"post",url:(0,J.J4)("v2","workers/worker/resume/all"),data:{}}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerResumed"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerResumedFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},terminateWorker:function(e){let t={worker_id:e};N()({method:"delete",url:(0,J.J4)("v2","workers/worker/terminate"),data:t}).then((e=>{this.$q.notify({color:"positive",position:"top",message:this.$t("components.workers.workerTerminated"),icon:"check_circle",actions:[{icon:"close",color:"white"}]})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("components.workers.workerTerminationFailed"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},terminateAllWorkers:function(){for(let e in this.workerProgressList){let t=this.workerProgressList[e];t.idle?this.terminateWorker(t.id):this.$q.dialog({title:this.$t("headers.confirm")+" - "+t.name,message:this.$t("components.workers.terminateWorkerWarning"),cancel:!0,persistent:!0}).onOk((()=>{this.terminateWorker(t.id)}))}}}};var It=o(4379);jt.render=h;const Ht=jt;se()(jt,"components",{QPage:It.Z,QCard:M.Z,QCardSection:E.Z,QIcon:X.Z,QBtnDropdown:O.Z,QList:F.Z,QItem:Y.Z,QItemSection:K.Z,QItemLabel:G.Z,QSeparator:ee.Z}),se()(jt,"directives",{ClosePopup:te.Z})}}]);