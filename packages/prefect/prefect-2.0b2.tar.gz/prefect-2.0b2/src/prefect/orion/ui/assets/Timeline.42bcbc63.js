var D=Object.defineProperty,I=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var x=(t,e,i)=>e in t?D(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,S=(t,e)=>{for(var i in e||(e={}))P.call(e,i)&&x(t,i,e[i]);if(w)for(var i of w(e))T.call(e,i)&&x(t,i,e[i]);return t},y=(t,e)=>I(t,W(e));var s=(t,e,i)=>(x(t,typeof e!="symbol"?e+"":e,i),i);import{N as h,x as B,y as M,z as L,k as A,b4 as R,A as $,W as O,X as q,Y as N,Z as z,$ as E,a0 as G,a1 as Y,B as c,O as j,r as F,o as d,c as m,g as H,h as _,d as g,E as f,F as V,C as X,n as p}from"./vendor.20f3e3c2.js";import{D as Z,i as C,_ as J}from"./index.fdb75d7c.js";var K=Object.defineProperty,Q=Object.getOwnPropertyDescriptor,U=(t,e,i,r)=>{for(var a=r>1?void 0:r?Q(e,i):e,o=t.length-1,n;o>=0;o--)(n=t[o])&&(a=(r?n(e,i,a):n(a))||a);return r&&a&&K(e,i,a),a};const tt=h(".%L"),et=h("%-I:%M:%S %p"),it=h("%-I:%M %p"),st=h("%-I %p"),at=h("%a %d"),rt=h("%b %d"),nt=h("%B"),ot=h("%Y"),lt=t=>(O(t)<t?tt:q(t)<t?et:N(t)<t?it:z(t)<t?st:E(t)<t?G(t)<t?at:rt:Y(t)<t?nt:ot)(t);class ht{constructor(){s(this,"axisPosition",c({required:!1,default:"bottom"}));s(this,"backgroundColor",c({required:!1,default:null}));s(this,"items",c({required:!0}));s(this,"maxEndTime",c({required:!1,default:null}));s(this,"hideHeader",c({required:!1,default:()=>!1,type:Boolean}));s(this,"padding",c({required:!1,default:{top:0,bottom:0,middle:0,left:0,right:0}}))}}let v=class extends B(Z).with(ht){constructor(){super(...arguments);s(this,"disableLeftScrollButton",!0);s(this,"disableRightScrollButton",!0);s(this,"computedItems",[]);s(this,"axisHeight",this.hideHeader?20:38);s(this,"intervalHeight",20);s(this,"intervalWidth",125);s(this,"xScale",M());s(this,"yScale",L());s(this,"rows",[]);s(this,"scrollContainer",A());s(this,"axisSvg",null);s(this,"gridSelection",null);s(this,"xAxisGroup",null);s(this,"backgroundRect",null);s(this,"xAxis",t=>t.transition().duration(250).attr("class","x-axis").call(R(this.xScale).ticks(this.numberIntervals).tickFormat(lt).tickSizeOuter(0).tickSizeInner(0)))}get interval(){return Object.entries(C).sort(([,t],[,e])=>e-t).reduce(([t,e],[i,r])=>this.totalSeconds<r?[i,r]:[t,e])[0]}get numberIntervals(){return Math.ceil(Math.max(this.totalSeconds/C[this.interval],this.width/this.intervalWidth)/this.intervalWidth)*this.intervalWidth}get numberRows(){return Math.max(this.rows.length,Math.ceil(this.height/this.intervalHeight))}get start(){return new Date(new Date(Math.min(...this.sortedItems.map(t=>new Date(t.start_time).getTime()))).getTime())}get end(){return new Date(this.maxEndTime?this.maxEndTime:new Date(Math.max(...this.sortedItems.map(t=>t.end_time?new Date(t.end_time).getTime():Date.now()))).getTime())}get totalSeconds(){return this.end.getTime()/1e3-this.start.getTime()/1e3}get chartHeight(){return this.container?this.numberRows*this.intervalHeight-this.paddingY:0}get chartWidth(){return Math.max(this.numberIntervals*this.intervalWidth,this.width)-this.paddingY}get sortedItems(){return this.items.sort((t,e)=>new Date(t.start_time).getTime()-new Date(e.start_time).getTime()).filter(t=>t.state_type!=="PENDING"&&t.start_time)}get nodeContainerStyle(){return{height:`${this.chartHeight}px`,width:`${this.chartWidth}px`}}get timelineAxisPosition(){return!this.container||this.axisPosition=="top"?{height:`${this.axisHeight}px`}:{height:`${this.axisHeight}px`,top:`${this.container.offsetHeight-this.axisHeight/2}px`}}resize(){this.update()}mounted(){this.createChart(),this.update(),this.handleScroll()}update(){var t;!((t=this.items)!=null&&t.length)||requestAnimationFrame(()=>{this.updateChart(),this.updateScales(),this.updateNodes(),this.updateGrid()})}updated(){(!this.svg||!this.gridSelection)&&this.createChart()}updateScales(){this.xScale.domain([new Date(this.start),new Date(this.end)]).range([0,this.chartWidth]).clamp(!0),this.xAxisGroup.call(this.xAxis)}createChart(){this.svg=$(`#${this.id}`),this.axisSvg=$(`#${this.id}-axis`),this.xAxisGroup=this.axisSvg.append("g"),this.backgroundRect=this.svg.append("g"),this.backgroundRect.append("rect").attr("fill",this.backgroundColor?`var(--${this.backgroundColor})`:"transparent").attr("rx",4).attr("width","100%").attr("height","100%"),this.gridSelection=this.svg.append("g")}updateChart(){this.svg.attr("viewbox",`0, 0, ${this.chartWidth}, ${this.chartHeight}`).style("width",`${this.chartWidth}px`).style("height",`${this.chartHeight}px`),this.axisSvg.attr("viewbox",`0, 0, ${this.chartWidth}, ${this.axisHeight}`).style("width",`${this.chartWidth}px`).style("height",`${this.axisHeight}px`)}updateNodes(){const t=[];this.computedItems=[...this.sortedItems].map(e=>{const i=new Date(e.start_time),r=e.end_time?new Date(e.end_time):new Date,a=this.xScale(i),o=Math.max(16,this.xScale(r)-this.xScale(i)),n=8,l=this.axisPosition=="top"?n+this.axisHeight:n;let u=0;for(;;){const b=t[u];if(b){const[,k]=b;if(a>k){t[u][1]=a+o;break}else{u++;continue}}else{t[u]=[a,a+o];break}}return y(S({},e),{style:{height:`${8}px`,left:`${a}px`,top:`${u*this.intervalHeight}px`,transform:`translate(0, ${l}px)`,width:`${o}px`}})}),this.rows=t}updateGrid(){this.gridSelection.selectAll(".grid-line.grid-x").data(Array.from({length:this.numberRows})).join(t=>t.append("line").attr("id",(e,i)=>`grid-line-x-${i}`).attr("class","grid-line grid-x").attr("stroke","var(--blue-20)").attr("x1",0).attr("x2",this.chartWidth).attr("y1",(e,i)=>i*this.intervalHeight).attr("y2",(e,i)=>i*this.intervalHeight),t=>t.attr("x1",0).attr("x2",this.chartWidth).attr("y1",(e,i)=>i*this.intervalHeight).attr("y2",(e,i)=>i*this.intervalHeight),t=>t.remove()),this.gridSelection.selectAll(".grid-line.grid-y").data(this.xScale.ticks(this.numberIntervals)).join(t=>t.append("line").attr("id",(e,i)=>`x-${i}`).attr("class","grid-line grid-y").attr("stroke","var(--blue-20)").attr("x1",(e,i)=>this.xScale(e)).attr("x2",(e,i)=>this.xScale(e)).attr("y1",0).attr("y2",this.chartHeight),t=>t.attr("x1",(e,i)=>this.xScale(e)).attr("x2",(e,i)=>this.xScale(e)).attr("y1",0).attr("y2",this.chartHeight),t=>t.remove())}handleScroll(){this.disableLeftScrollButton=this.scrollContainer.scrollLeft<=0,this.disableRightScrollButton=this.scrollContainer.scrollLeft>=this.scrollContainer.scrollWidth}panLeft(){this.scrollContainer.scroll({left:this.scrollContainer.scrollLeft-this.width,behavior:"smooth"})}panRight(){this.scrollContainer.scroll({left:this.scrollContainer.scrollLeft+this.width,behavior:"smooth"})}};v=U([j({watch:{items(){this.update()},interval(){this.update()}}})],v);const dt=v,ct=["id"],ut=["id"],mt=["id"];function gt(t,e,i,r,a,o){const n=F("m-icon-button");return d(),m("div",{ref:"container",class:p(["component-container timeline d-flex flex-column",{"header-hidden":t.hideHeader,"header-visible":!t.hideHeader,"axis-bottom":t.axisPosition=="bottom","axis-top":t.axisPosition=="top"}]),style:{"max-height":"inherit"}},[t.hideHeader?_("",!0):(d(),H(n,{key:0,class:"pan-button left bg--white",icon:"pi pi-arrow-left-s-line pi-lg",flat:"",disabled:t.disableLeftScrollButton,onClick:t.panLeft},null,8,["disabled","onClick"])),t.hideHeader?_("",!0):(d(),H(n,{key:1,class:"pan-button right bg--white",icon:"pi pi-arrow-right-s-line pi-lg",flat:"",disabled:t.disableRightScrollButton,onClick:t.panRight},null,8,["disabled","onClick"])),g("div",{ref:"scrollContainer",class:"scroll-container",onScroll:e[0]||(e[0]=(...l)=>t.handleScroll&&t.handleScroll(...l))},[g("div",{class:"node-container",style:f(t.nodeContainerStyle)},[(d(!0),m(V,null,X(t.computedItems,l=>(d(),m("div",{id:`node-${l.id}`,key:l.id,class:p(["node correct-text",[`${l.state.type.toLowerCase()}-bg`]]),style:f(l.style),tabindex:"0"},null,14,ct))),128)),g("div",{class:p(["timeline-axis",{"shadow-sm":t.axisPosition=="top"}]),style:f(t.timelineAxisPosition)},[(d(),m("svg",{id:`${t.id}-axis`,ref:"chart-axis"},null,8,ut))],6),(d(),m("svg",{id:t.id,class:"timeline-background"},null,8,mt))],4)],544),g("div",{class:p(["border-container",{top:t.axisPosition=="top",bottom:t.axisPosition=="bottom"}])},null,2)],2)}var vt=J(dt,[["render",gt],["__scopeId","data-v-689e583e"]]);export{vt as T};
