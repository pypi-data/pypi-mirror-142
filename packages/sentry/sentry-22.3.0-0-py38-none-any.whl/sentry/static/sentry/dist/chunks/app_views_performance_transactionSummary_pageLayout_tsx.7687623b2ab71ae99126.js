"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_transactionSummary_pageLayout_tsx"],{"./app/utils/performance/histogram/utils.tsx":(t,e,n)=>{n.d(e,{te:()=>a,_W:()=>s,GT:()=>o});var r=n("./app/utils/formatters.tsx");function a(t){return t.length>=2?t[1].bin-t[0].bin:0}function s(t){const e=a(t);return t.map((t=>{const n=t.bin;return{start:n,end:n+e}}))}function o(t){let{precision:e,type:n,additionalFieldsFn:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=t=>{switch(n){case"duration":const a=null!=e?e:t<1e3?0:3;return(0,r.g9)(t/1e3,a,!0);case"number":const s=10**(null!=e?e:0);return(Math.round((t+Number.EPSILON)*s)/s).toLocaleString();default:throw new Error(`Unable to format type: ${n}`)}};return t.map((t=>{var e;return{value:t.count,name:s(t.bin),...null!==(e=null==a?void 0:a(t.bin))&&void 0!==e?e:{}}}))}},"./app/views/performance/breadcrumb.tsx":(t,e,n)=>{n.d(e,{Z:()=>y});var r=n("../node_modules/react/index.js"),a=n("./app/components/breadcrumbs.tsx"),s=n("./app/locale.tsx"),o=n("./app/utils/queryString.tsx"),i=n("./app/views/performance/transactionSummary/tabs.tsx"),l=n("./app/views/performance/transactionSummary/transactionEvents/utils.tsx"),c=n("./app/views/performance/transactionSummary/transactionSpans/utils.tsx"),p=n("./app/views/performance/transactionSummary/transactionTags/utils.tsx"),u=n("./app/views/performance/transactionSummary/transactionVitals/utils.tsx"),d=n("./app/views/performance/transactionSummary/utils.tsx"),m=n("./app/views/performance/vitalDetail/utils.tsx"),h=n("./app/views/performance/utils.tsx"),g=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class v extends r.Component{getCrumbs(){const t=[],{organization:e,location:n,transaction:r,vitalName:a,spanSlug:g,eventSlug:v,traceSlug:y,tab:f}=this.props,x={pathname:(0,h.de)(e),query:{...n.query,transaction:void 0}};if(t.push({to:x,label:(0,s.t)("Performance"),preservePageFilters:!0}),a){const r=(0,m.i4)({orgSlug:e.slug,vitalName:"fcp",projectID:(0,o.ro)(n.query.project),query:n.query});t.push({to:r,label:(0,s.t)("Vital Detail"),preservePageFilters:!0})}else if(r){const a={orgSlug:e.slug,transaction:r.name,projectID:r.project,query:n.query};switch(f){case i.Z.Tags:{const e=(0,p.vG)(a);t.push({to:e,label:(0,s.t)("Tags"),preservePageFilters:!0});break}case i.Z.Events:{const e=(0,l.xr)(a);t.push({to:e,label:(0,s.t)("All Events"),preservePageFilters:!0});break}case i.Z.WebVitals:{const e=(0,u.Pl)(a);t.push({to:e,label:(0,s.t)("Web Vitals"),preservePageFilters:!0});break}case i.Z.Spans:{const e=(0,c.hN)(a);t.push({to:e,label:(0,s.t)("Spans"),preservePageFilters:!0});break}case i.Z.TransactionSummary:default:{const e=(0,d.e1)(a);t.push({to:e,label:(0,s.t)("Transaction Summary"),preservePageFilters:!0})}}}return r&&g?t.push({to:"",label:(0,s.t)("Span Summary")}):r&&v?t.push({to:"",label:(0,s.t)("Event Details")}):y&&t.push({to:"",label:(0,s.t)("Trace View")}),t}render(){return(0,g.tZ)(a.Z,{crumbs:this.getCrumbs()})}}v.displayName="Breadcrumb";const y=v},"./app/views/performance/transactionSummary/pageLayout.tsx":(t,e,n)=>{n.d(e,{Ox:()=>ht,ZP:()=>xt,C1:()=>ft});var r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/react/index.js")),s=n("../node_modules/react-router/es/index.js"),o=n("./app/components/acl/feature.tsx"),i=n("./app/components/alert.tsx"),l=n("./app/components/globalSdkUpdateAlert.tsx"),c=n("./app/components/layouts/thirds.tsx"),p=n("./app/components/noProjectMessage.tsx"),u=n("./app/components/organizations/pageFilters/container.tsx"),d=n("./app/components/sentryDocumentTitle.tsx"),m=n("./app/icons/index.tsx"),h=n("./app/locale.tsx"),g=n("./app/styles/organization.tsx"),v=n("./app/utils.tsx"),y=n("./app/utils/performance/contexts/performanceEventViewContext.tsx"),f=n("./app/utils/queryString.tsx"),x=n("./app/views/performance/utils.tsx"),S=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),b=n("./app/components/assistant/guideAnchor.tsx"),T=n("./app/components/buttonBar.tsx"),Z=n("./app/components/createAlertButton.tsx"),_=n("./app/components/featureBadge.tsx"),w=n("./app/components/links/listLink.tsx"),j=n("./app/components/navTabs.tsx"),C=n("./app/utils/analytics.tsx"),E=n("../node_modules/lodash/omit.js"),q=n.n(E),P=n("../node_modules/lodash/pick.js"),A=n.n(P),k=n("./app/utils/discover/genericDiscoverQuery.tsx"),N=n("./app/utils/tokenizeSearch.tsx"),I=n("./app/utils/withApi.tsx"),V=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function z(t){const{eventView:e,location:n,transaction:r,type:a}=t,s={transaction:`"${(0,v.d9)((0,N.Bn)(r))}"`,type:a},o=A()(e.getEventsAPIPayload(n),["project","environment"]);return Object.assign(s,o)}function M(t){return(0,V.tZ)(k.ZP,{route:"events-has-measurements",getRequestPayload:z,...q()(t,"children"),children:e=>{var n;let{tableData:r,...a}=e;return t.children({hasMeasurements:null!==(n=null==r?void 0:r.measurements)&&void 0!==n?n:null,...a})}})}M.displayName="HasMeasurementsQuery";const B=(0,I.Z)(M);var L=n("./app/views/performance/breadcrumb.tsx"),O=n("./app/views/performance/landing/utils.tsx"),U=n("./app/views/performance/transactionSummary/transactionAnomalies/utils.tsx"),D=n("./app/views/performance/transactionSummary/transactionEvents/utils.tsx"),F=n("./app/views/performance/transactionSummary/transactionSpans/utils.tsx"),X=n("./app/views/performance/transactionSummary/transactionTags/utils.tsx"),$=n("./app/views/performance/transactionSummary/transactionVitals/utils.tsx"),K=n("./app/views/performance/transactionSummary/tabs.tsx"),W=n("./app/components/button.tsx"),R=n("./app/components/performance/teamKeyTransaction.tsx"),G=n("./app/components/performance/teamKeyTransactionsManager.tsx"),Q=n("./app/components/tooltip.tsx"),H=n("./app/utils/useTeams.tsx"),Y=n("./app/utils/withProjects.tsx");class J extends a.Component{render(){var t;const{isOpen:e,keyedTeams:n,...r}=this.props,a=null!==(t=null==n?void 0:n.length)&&void 0!==t?t:0,s=(0,V.tZ)(W.ZP,{...r,icon:a?(0,V.tZ)(m.GK,{color:"yellow300",isSolid:!0}):(0,V.tZ)(m.GK,{}),children:a?(0,h.tn)("Starred for Team","Starred for Teams",a):(0,h.t)("Star for Team")});if(!e&&null!=n&&n.length){const t=n.map((t=>{let{slug:e}=t;return e})).join(", ");return(0,V.tZ)(Q.Z,{title:t,children:s})}return s}}function tt(t){let{counts:e,getKeyedTeams:n,project:r,transactionName:a,...s}=t;const o=n(r.id,a);return(0,V.tZ)(R.Z,{counts:e,keyedTeams:o,title:J,project:r,transactionName:a,...s})}function et(t){let{eventView:e,organization:n,projects:r,...a}=t;const{teams:s,initiallyLoaded:o}=(0,H.Z)({provideUserTeams:!0});if(1!==e.project.length)return(0,V.tZ)(J,{isOpen:!1,disabled:!0,keyedTeams:null});const i=String(e.project[0]),l=r.find((t=>t.id===i));return(0,v.ri)(l)?(0,V.tZ)(G.z,{organization:n,teams:s,selectedTeams:["myteams"],selectedProjects:[String(i)],children:(0,V.tZ)(G.$,{children:t=>{let{isLoading:e,...r}=t;return(0,V.tZ)(tt,{organization:n,project:l,isLoading:e||!o,...a,...r})}})}):(0,V.tZ)(J,{isOpen:!1,disabled:!0,keyedTeams:null})}J.displayName="TitleButton",tt.displayName="TeamKeyTransactionButton",et.displayName="TeamKeyTransactionButtonWrapper";const nt=(0,Y.Z)(et);var rt=n("./app/actionCreators/indicator.tsx"),at=n("./app/actionCreators/modal.tsx"),st=n("./app/views/performance/transactionSummary/transactionThresholdModal.tsx");class ot extends a.Component{constructor(){super(...arguments),(0,S.Z)(this,"state",{transactionThreshold:void 0,transactionThresholdMetric:void 0,loadingThreshold:!1}),(0,S.Z)(this,"fetchTransactionThreshold",(()=>{const{api:t,organization:e,transactionName:n}=this.props,r=this.getProject();if(!(0,v.ri)(r))return;const a=`/organizations/${e.slug}/project-transaction-threshold-override/`;this.setState({loadingThreshold:!0}),t.requestPromise(a,{method:"GET",includeAllArgs:!0,query:{project:r.id,transaction:n}}).then((t=>{let[e]=t;this.setState({loadingThreshold:!1,transactionThreshold:e.threshold,transactionThresholdMetric:e.metric})})).catch((()=>{const t=`/projects/${e.slug}/${r.slug}/transaction-threshold/configure/`;this.props.api.requestPromise(t,{method:"GET",includeAllArgs:!0,query:{project:r.id}}).then((t=>{let[e]=t;this.setState({loadingThreshold:!1,transactionThreshold:e.threshold,transactionThresholdMetric:e.metric})})).catch((t=>{var e,n;this.setState({loadingThreshold:!1});const r=null!==(e=null===(n=t.responseJSON)||void 0===n?void 0:n.threshold)&&void 0!==e?e:null;(0,rt.Iw)(r)}))}))}))}componentDidMount(){this.fetchTransactionThreshold()}getProject(){const{projects:t,eventView:e}=this.props;if(!(0,v.ri)(e))return;const n=String(e.project[0]);return t.find((t=>t.id===n))}onChangeThreshold(t,e){const{onChangeThreshold:n}=this.props;this.setState({transactionThreshold:t,transactionThresholdMetric:e}),(0,v.ri)(n)&&n(t,e)}openModal(){const{organization:t,transactionName:e,eventView:n}=this.props,{transactionThreshold:r,transactionThresholdMetric:a}=this.state;(0,at.openModal)((s=>(0,V.tZ)(st.ZP,{...s,organization:t,transactionName:e,eventView:n,transactionThreshold:r,transactionThresholdMetric:a,onApply:(t,e)=>this.onChangeThreshold(t,e)})),{modalCss:st.fY,backdrop:"static"})}render(){const{loadingThreshold:t}=this.state;return(0,V.tZ)(W.ZP,{onClick:()=>this.openModal(),icon:(0,V.tZ)(m.iC,{}),disabled:t,"aria-label":(0,h.t)("Settings"),"data-test-id":"set-transaction-threshold"})}}ot.displayName="TransactionThresholdButton";const it=(0,I.Z)((0,Y.Z)(ot));var lt=n("./app/views/performance/transactionSummary/utils.tsx");const ct={[K.Z.WebVitals]:{eventKey:"performance_views.vitals.vitals_tab_clicked",eventName:"Performance Views: Vitals tab clicked"},[K.Z.Tags]:{eventKey:"performance_views.tags.tags_tab_clicked",eventName:"Performance Views: Tags tab clicked"},[K.Z.Events]:{eventKey:"performance_views.events.events_tab_clicked",eventName:"Performance Views: Events tab clicked"},[K.Z.Spans]:{eventKey:"performance_views.spans.spans_tab_clicked",eventName:"Performance Views: Spans tab clicked"},[K.Z.Anomalies]:{eventKey:"performance_views.anomalies.anomalies_tab_clicked",eventName:"Performance Views: Anomalies tab clicked"}};class pt extends a.Component{constructor(){super(...arguments),(0,S.Z)(this,"trackTabClick",(t=>()=>{const e=ct[t];e&&(0,C.ec)({...e,organization_id:this.props.organization.id})})),(0,S.Z)(this,"handleIncompatibleQuery",((t,e)=>{var n,r;this.trackAlertClick(e),null===(n=(r=this.props).handleIncompatibleQuery)||void 0===n||n.call(r,t,e)})),(0,S.Z)(this,"handleCreateAlertSuccess",(()=>{this.trackAlertClick()}))}trackAlertClick(t){const{organization:e}=this.props;(0,C.ec)({eventKey:"performance_views.summary.create_alert_clicked",eventName:"Performance Views: Create alert clicked",organization_id:e.id,status:t?"error":"success",errors:t,url:window.location.href})}renderCreateAlertButton(){const{eventView:t,organization:e,projects:n}=this.props;return(0,V.tZ)(Z.K,{eventView:t,organization:e,projects:n,onIncompatibleQuery:this.handleIncompatibleQuery,onSuccess:this.handleCreateAlertSuccess,referrer:"performance","aria-label":(0,h.t)("Create Alert")})}renderKeyTransactionButton(){const{eventView:t,organization:e,transactionName:n}=this.props;return(0,V.tZ)(nt,{transactionName:n,eventView:t,organization:e})}renderSettingsButton(){const{organization:t,transactionName:e,eventView:n,onChangeThreshold:r}=this.props;return(0,V.tZ)(b.n,{target:"project_transaction_threshold_override",position:"bottom",children:(0,V.tZ)(it,{organization:t,transactionName:e,eventView:n,onChangeThreshold:r})})}renderWebVitalsTab(){const{organization:t,eventView:e,location:n,projects:r,transactionName:a,currentTab:s,hasWebVitals:o}=this.props,i=(0,$.Pl)({orgSlug:t.slug,transaction:a,projectID:(0,f.ro)(n.query.project),query:n.query}),l=(0,V.tZ)(w.Z,{"data-test-id":"web-vitals-tab",to:i,isActive:()=>s===K.Z.WebVitals,onClick:this.trackTabClick(K.Z.WebVitals),children:(0,h.t)("Web Vitals")});switch(o){case"maybe":return(0,O.Q_)(n,r,e).field===O.BY.FRONTEND_PAGELOAD?l:(0,V.tZ)(B,{location:n,orgSlug:t.slug,eventView:e,transaction:a,type:"web",children:t=>{let{hasMeasurements:e}=t;return e?l:null}});case"yes":return l;case"no":default:return null}}render(){const{organization:t,location:e,projectId:n,transactionName:r,currentTab:s}=this.props,i={orgSlug:t.slug,transaction:r,projectID:n,query:e.query},l=(0,lt.e1)(i),p=(0,X.vG)(i),u=(0,D.xr)(i),d=(0,F.hN)(i),m=(0,U.az)(i);return(0,V.BX)(c.h4,{children:[(0,V.BX)(c.oB,{children:[(0,V.tZ)(L.Z,{organization:t,location:e,transaction:{project:n,name:r},tab:s}),(0,V.tZ)(c.Dx,{children:r})]}),(0,V.tZ)(c.kP,{children:(0,V.BX)(T.ZP,{gap:1,children:[(0,V.tZ)(o.Z,{organization:t,features:["incidents"],children:t=>{let{hasFeature:e}=t;return e&&this.renderCreateAlertButton()}}),this.renderKeyTransactionButton(),this.renderSettingsButton()]})}),(0,V.tZ)(a.Fragment,{children:(0,V.BX)(ut,{children:[(0,V.tZ)(w.Z,{to:l,isActive:()=>s===K.Z.TransactionSummary,children:(0,h.t)("Overview")}),(0,V.tZ)(w.Z,{to:u,isActive:()=>s===K.Z.Events,onClick:this.trackTabClick(K.Z.Events),children:(0,h.t)("All Events")}),(0,V.tZ)(w.Z,{to:p,isActive:()=>s===K.Z.Tags,onClick:this.trackTabClick(K.Z.Tags),children:(0,h.t)("Tags")}),(0,V.tZ)(o.Z,{organization:t,features:["organizations:performance-suspect-spans-view"],children:(0,V.BX)(w.Z,{"data-test-id":"spans-tab",to:d,isActive:()=>s===K.Z.Spans,onClick:this.trackTabClick(K.Z.Spans),children:[(0,h.t)("Spans"),(0,V.tZ)(_.Z,{type:"new",noTooltip:!0})]})}),(0,V.tZ)(o.Z,{organization:t,features:["organizations:performance-anomaly-detection-ui"],children:(0,V.BX)(w.Z,{"data-test-id":"anomalies-tab",to:m,isActive:()=>s===K.Z.Anomalies,onClick:this.trackTabClick(K.Z.Anomalies),children:[(0,h.t)("Anomalies"),(0,V.tZ)(_.Z,{type:"alpha",noTooltip:!0})]})}),this.renderWebVitalsTab()]})})]})}}pt.displayName="TransactionHeader";const ut=(0,r.Z)(j.Z,{target:"ega7at50"})({name:"13jhhqe",styles:"margin-bottom:0;width:100%"}),dt=pt;function mt(t){const{location:e,organization:n,projects:r,tab:s,getDocumentTitle:i,generateEventView:l,childComponent:g,relativeDateOptions:S,maxPickableDays:b,features:T=[]}=t,Z=(0,f.ro)(e.query.project),_=(0,x.JY)(e);if(!(0,v.ri)(Z)||!(0,v.ri)(_))return ft(n,e),null;const w=r.find((t=>t.id===Z)),[j,C]=(0,a.useState)(),[E,q]=(0,a.useState)(null),[P,A]=(0,a.useState)(),[k,N]=(0,a.useState)(),I=l({location:e,transactionName:_});return(0,V.tZ)(d.Z,{title:i(_),orgSlug:n.slug,projectSlug:null==w?void 0:w.slug,children:(0,V.tZ)(o.Z,{features:["performance-view",...T],organization:n,renderDisabled:ht,children:(0,V.tZ)(y.bq,{value:{eventView:I},children:(0,V.tZ)(u.Z,{lockedMessageSubject:(0,h.t)("transaction"),shouldForceProject:(0,v.ri)(w),forceProject:w,specificProjectSlugs:(0,v.ri)(w)?[w.slug]:[],disableMultipleProjectSelection:!0,showProjectSettingsLink:!0,relativeDateOptions:S,maxPickableDays:b,children:(0,V.tZ)(gt,{children:(0,V.BX)(p.Z,{organization:n,children:[(0,V.tZ)(dt,{eventView:I,location:e,organization:n,projects:r,projectId:Z,transactionName:_,currentTab:s,hasWebVitals:s===K.Z.WebVitals?"yes":"maybe",handleIncompatibleQuery:(t,e)=>{const n=t((()=>q(null)));q(n)},onChangeThreshold:(t,e)=>{A(t),N(e)}}),(0,V.BX)(c.uT,{children:[(0,V.tZ)(vt,{}),(0,v.ri)(j)&&(0,V.tZ)(yt,{type:"error",icon:(0,V.tZ)(m.Gy,{size:"md"}),children:j}),E&&(0,V.tZ)(c.or,{fullWidth:!0,children:E}),(0,V.tZ)(g,{location:e,organization:n,projects:r,eventView:I,projectId:Z,transactionName:_,setError:C,transactionThreshold:P,transactionThresholdMetric:k})]})]})})})})})})}function ht(){return(0,V.tZ)(i.Z,{type:"warning",children:(0,h.t)("You don't have access to this feature")})}mt.displayName="PageLayout",ht.displayName="NoAccess";const gt=(0,r.Z)(g.JH,{target:"e1ehad6a2"})({name:"1hcx8jb",styles:"padding:0"}),vt=(0,r.Z)(l._,{target:"e1ehad6a1"})("@media (min-width: ",(t=>t.theme.breakpoints[1]),"){margin-bottom:0;}"),yt=(0,r.Z)(i.Z,{target:"e1ehad6a0"})({name:"3hfw1i",styles:"grid-column:1/3;margin:0"});function ft(t,e){s.browserHistory.replace({pathname:`/organizations/${t.slug}/performance/`,query:{...e.query}})}const xt=mt},"./app/views/performance/transactionSummary/tabs.tsx":(t,e,n)=>{var r;n.d(e,{Z:()=>a}),function(t){t[t.TransactionSummary=0]="TransactionSummary",t[t.WebVitals=1]="WebVitals",t[t.Tags=2]="Tags",t[t.Events=3]="Events",t[t.Spans=4]="Spans",t[t.Anomalies=5]="Anomalies"}(r||(r={}));const a=r},"./app/views/performance/transactionSummary/transactionAnomalies/utils.tsx":(t,e,n)=>{n.d(e,{uT:()=>o,az:()=>i,ES:()=>l,h2:()=>c});var r=n("./app/utils/discover/eventView.tsx"),a=n("./app/utils/queryString.tsx"),s=n("./app/utils/tokenizeSearch.tsx");const o="performance-anomaly-detection-ui";function i(t){let{orgSlug:e,transaction:n,projectID:r,query:a}=t;return{pathname:function(t){let{orgSlug:e}=t;return`/organizations/${e}/performance/summary/anomalies/`}({orgSlug:e}),query:{transaction:n,project:r,environment:a.environment,statsPeriod:a.statsPeriod,start:a.start,end:a.end,query:a.query}}}function l(t,e){return{high:e.red300,low:e.yellow300}[t]}function c(t){let{location:e,transactionName:n}=t;const o=(0,a.ro)(e.query.query,""),i=new s.MY(o);return i.setFilterValues("transaction",[n]),r.ZP.fromNewQueryWithLocation({id:void 0,version:2,name:n,fields:["tpm()"],query:i.formatString(),projects:[]},e)}},"./app/views/performance/transactionSummary/transactionEvents/utils.tsx":(t,e,n)=>{n.d(e,{q3:()=>i,_S:()=>l,xr:()=>c,tb:()=>p,qg:()=>u,Zq:()=>d});var r=n("./app/locale.tsx"),a=n("./app/utils/queryString.tsx"),s=n("./app/views/performance/transactionSummary/filter.tsx"),o=n("./app/views/performance/transactionSummary/utils.tsx");let i;function l(t,e){const{p99:n,p95:a,p75:o,p50:l}=e||{p99:0,p95:0,p75:0,p50:0};return{[i.p50]:{name:i.p50,query:l?[["transaction.duration",`<=${l.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,s.T$)(t)||"transaction.duration"},label:(0,r.t)("p50")},[i.p75]:{name:i.p75,query:o?[["transaction.duration",`<=${o.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,s.T$)(t)||"transaction.duration"},label:(0,r.t)("p75")},[i.p95]:{name:i.p95,query:a?[["transaction.duration",`<=${a.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,s.T$)(t)||"transaction.duration"},label:(0,r.t)("p95")},[i.p99]:{name:i.p99,query:n?[["transaction.duration",`<=${n.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,s.T$)(t)||"transaction.duration"},label:(0,r.t)("p99")},[i.p100]:{name:i.p100,label:(0,r.t)("p100")}}}function c(t){let{orgSlug:e,transaction:n,projectID:r,query:a}=t;return{pathname:`/organizations/${e}/performance/summary/events/`,query:{transaction:n,project:r,environment:a.environment,statsPeriod:a.statsPeriod,start:a.start,end:a.end,query:a.query}}}function p(t){return e=(0,a.ro)(t.query.showTransactions,i.p100),Object.values(i).includes(e)?e:i.p100;var e}function u(t,e){var n,r;const a=l(e),s=null===(n=a[t].sort)||void 0===n?void 0:n.kind,o=null===(r=a[t].sort)||void 0===r?void 0:r.field,i={showTransactions:t};return s&&o&&(i.sort=`${"desc"===s?"-":""}${o}`),i}function d(t){switch(t){case o.K0.OUTLIER:return i.p100;case o.K0.SLOW:return i.p95;default:return}}!function(t){t.p50="p50",t.p75="p75",t.p95="p95",t.p99="p99",t.p100="p100"}(i||(i={}))},"./app/views/performance/transactionSummary/transactionSpans/types.tsx":(t,e,n)=>{let r,a;n.d(e,{p:()=>r,g:()=>a}),function(t){t.P50_EXCLUSIVE_TIME="p50ExclusiveTime",t.P75_EXCLUSIVE_TIME="p75ExclusiveTime",t.P95_EXCLUSIVE_TIME="p95ExclusiveTime",t.P99_EXCLUSIVE_TIME="p99ExclusiveTime"}(r||(r={})),function(t){t.COUNT="count",t.AVG_OCCURRENCE="avgOccurrence",t.SUM_EXCLUSIVE_TIME="sumExclusiveTime"}(a||(a={}))},"./app/views/performance/transactionSummary/transactionSpans/utils.tsx":(t,e,n)=>{n.d(e,{hN:()=>m,bc:()=>h,CS:()=>g,E5:()=>v,TK:()=>x,KK:()=>S,W6:()=>b,xz:()=>T,zW:()=>Z,uQ:()=>_,mV:()=>w}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.string.replace.js");var r=n("../node_modules/lodash/pick.js"),a=n.n(r),s=n("./app/constants/index.tsx"),o=n("./app/locale.tsx"),i=n("./app/utils.tsx"),l=n("./app/utils/discover/eventView.tsx"),c=n("./app/utils/discover/fields.tsx"),p=n("./app/utils/queryString.tsx"),u=n("./app/utils/tokenizeSearch.tsx"),d=n("./app/views/performance/transactionSummary/transactionSpans/types.tsx");function m(t){let{orgSlug:e,transaction:n,projectID:r,query:a}=t;return{pathname:function(t){let{orgSlug:e}=t;return`/organizations/${e}/performance/summary/spans/`}({orgSlug:e}),query:{transaction:n,project:r,environment:a.environment,statsPeriod:a.statsPeriod,start:a.start,end:a.end,query:a.query}}}const h=30,g=a()(s.wh,["1h","24h","7d","14d","30d"]),v=[{prefix:(0,o.t)("Sort By"),label:(0,o.t)("Total Self Time"),field:d.g.SUM_EXCLUSIVE_TIME},{prefix:(0,o.t)("Sort By"),label:(0,o.t)("Average Count"),field:d.g.AVG_OCCURRENCE},{prefix:(0,o.t)("Sort By"),label:(0,o.t)("Total Count"),field:d.g.COUNT},{prefix:(0,o.t)("Sort By"),label:(0,o.t)("p50 Self Time"),field:d.p.P50_EXCLUSIVE_TIME},{prefix:(0,o.t)("Sort By"),label:(0,o.t)("p75 Self Time"),field:d.p.P75_EXCLUSIVE_TIME},{prefix:(0,o.t)("Sort By"),label:(0,o.t)("p95 Self Time"),field:d.p.P95_EXCLUSIVE_TIME},{prefix:(0,o.t)("Sort By"),label:(0,o.t)("p99 Self Time"),field:d.p.P99_EXCLUSIVE_TIME}],y=d.g.SUM_EXCLUSIVE_TIME;function f(t){return v.find((e=>e.field===t))||v.find((t=>t.field===y))}function x(t){var e,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sort";const a=null!==(e=(0,p.ro)(null==t||null===(n=t.query)||void 0===n?void 0:n[r]))&&void 0!==e?e:y;return f(a)}function S(t){return f(t.sorts.length?t.sorts[0].field:y)}function b(t){if(!(0,i.ri)(t))return;const e=t.lastIndexOf(":");return e<0?void 0:{op:t.slice(0,e),group:t.slice(e+1)}}function T(t){let{location:e,transactionName:n}=t;const r=(0,p.ro)(e.query.query,""),a=new u.MY(r);a.setFilterValues("event.type",["transaction"]),a.setFilterValues("transaction",[n]);const s=l.ZP.fromNewQueryWithLocation({id:void 0,version:2,name:n,fields:[...Object.values(d.g),...Object.values(d.p)],query:a.formatString(),projects:[]},e),o=x(e);return s.withSorts([{field:o.field,kind:"desc"}])}function Z(t){const e=t.withColumns([{kind:"function",function:["count","",void 0,void 0]}]),n=new u.MY(t.query);return Object.keys(n.filters).forEach((t=>{(0,c.h1)(t)&&n.removeFilter(t)})),e.query=n.formatString(),e}const _={[d.g.SUM_EXCLUSIVE_TIME]:["percentileArray(spans_exclusive_time, 0.75)","count()","count_unique(id)","sumArray(spans_exclusive_time)"],[d.g.AVG_OCCURRENCE]:["percentileArray(spans_exclusive_time, 0.75)","count()","count_unique(id)","equation|count() / count_unique(id)","sumArray(spans_exclusive_time)"],[d.g.COUNT]:["percentileArray(spans_exclusive_time, 0.75)","count()","count_unique(id)","sumArray(spans_exclusive_time)"],[d.p.P50_EXCLUSIVE_TIME]:["percentileArray(spans_exclusive_time, 0.5)","count()","count_unique(id)","sumArray(spans_exclusive_time)"],[d.p.P75_EXCLUSIVE_TIME]:["percentileArray(spans_exclusive_time, 0.75)","count()","count_unique(id)","sumArray(spans_exclusive_time)"],[d.p.P95_EXCLUSIVE_TIME]:["percentileArray(spans_exclusive_time, 0.95)","count()","count_unique(id)","sumArray(spans_exclusive_time)"],[d.p.P99_EXCLUSIVE_TIME]:["percentileArray(spans_exclusive_time, 0.99)","count()","count_unique(id)","sumArray(spans_exclusive_time)"]};function w(t){return t.replace("exclusive","self")}},"./app/views/performance/transactionSummary/transactionTags/utils.tsx":(t,e,n)=>{n.d(e,{Zn:()=>s,bZ:()=>o,vG:()=>i,oc:()=>l,oT:()=>c});var r=n("./app/utils/analytics.tsx"),a=n("./app/utils/queryString.tsx");function s(t){return(0,a.ro)(t.query.tagKey)}function o(t){(0,r.ec)({eventKey:"performance_views.tags.interaction",eventName:"Performance Views: Tag Page - Interaction",organization_id:parseInt(t.id,10)})}function i(t){let{orgSlug:e,transaction:n,projectID:r,query:a}=t;return{pathname:function(t){let{orgSlug:e}=t;return`/organizations/${e}/performance/summary/tags/`}({orgSlug:e}),query:{transaction:n,project:r,environment:a.environment,statsPeriod:a.statsPeriod,start:a.start,end:a.end,query:a.query,tagKey:a.tagKey}}}function l(t){var e,n;let r=null!==(e=(0,a.ro)(null===(n=t.query)||void 0===n?void 0:n.tagSort))&&void 0!==e?e:"-frequency";return["sumdelta"].find((t=>{var e;return null===(e=r)||void 0===e?void 0:e.includes(t)}))&&(r="-frequency"),r}function c(t){const e=Object.keys(t).find((t=>t.includes("histogram")));if(!e)return;const n=e.split("_");return{histogramField:e,bucketSize:parseInt(n[n.length-3],10),offset:parseInt(n[n.length-2],10),multiplier:parseInt(n[n.length-1],10)}}},"./app/views/performance/transactionSummary/transactionThresholdModal.tsx":(t,e,n)=>{n.d(e,{fY:()=>E,ZP:()=>q});var r=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),o=n("../node_modules/lodash/cloneDeep.js"),i=n.n(o),l=n("../node_modules/lodash/set.js"),c=n.n(l),p=n("./app/actionCreators/indicator.tsx"),u=n("./app/components/button.tsx"),d=n("./app/components/buttonBar.tsx"),m=n("./app/components/forms/controls/input.tsx"),h=n("./app/components/forms/field/index.tsx"),g=n("./app/components/forms/selectControl.tsx"),v=n("./app/components/links/link.tsx"),y=n("./app/locale.tsx"),f=n("./app/styles/space.tsx"),x=n("./app/utils.tsx"),S=n("./app/utils/withApi.tsx"),b=n("./app/utils/withProjects.tsx"),T=n("./app/views/performance/transactionSummary/utils.tsx"),Z=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");let _;!function(t){t.TRANSACTION_DURATION="duration",t.LARGEST_CONTENTFUL_PAINT="lcp"}(_||(_={}));const w=[{label:(0,y.t)("Transaction Duration"),value:"duration"},{label:(0,y.t)("Largest Contentful Paint"),value:"lcp"}];class j extends s.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{threshold:this.props.transactionThreshold,metric:this.props.transactionThresholdMetric,error:null}),(0,r.Z)(this,"handleApply",(async t=>{t.preventDefault();const{api:e,closeModal:n,organization:r,transactionName:a,onApply:s}=this.props,o=this.getProject();if(!(0,x.ri)(o))return;const i=`/organizations/${r.slug}/project-transaction-threshold-override/`;e.requestPromise(i,{method:"POST",includeAllArgs:!0,query:{project:o.id},data:{transaction:a,threshold:this.state.threshold,metric:this.state.metric}}).then((()=>{n(),s&&s(this.state.threshold,this.state.metric)})).catch((t=>{var e,n,r,a;this.setState({error:t});const s=null!==(e=null!==(n=null===(r=t.responseJSON)||void 0===r?void 0:r.threshold)&&void 0!==n?n:null===(a=t.responseJSON)||void 0===a?void 0:a.non_field_errors)&&void 0!==e?e:null;(0,p.Iw)(s)}))})),(0,r.Z)(this,"handleFieldChange",(t=>e=>{this.setState((n=>{const r=i()(n);return c()(r,t,e),{...r,errors:void 0}}))})),(0,r.Z)(this,"handleReset",(async t=>{t.preventDefault();const{api:e,closeModal:n,organization:r,transactionName:a,onApply:s}=this.props,o=this.getProject();if(!(0,x.ri)(o))return;const i=`/organizations/${r.slug}/project-transaction-threshold-override/`;e.requestPromise(i,{method:"DELETE",includeAllArgs:!0,query:{project:o.id},data:{transaction:a}}).then((()=>{const t=`/projects/${r.slug}/${o.slug}/transaction-threshold/configure/`;this.props.api.requestPromise(t,{method:"GET",includeAllArgs:!0,query:{project:o.id}}).then((t=>{let[e]=t;this.setState({threshold:e.threshold,metric:e.metric}),n(),s&&s(this.state.threshold,this.state.metric)})).catch((t=>{var e,n;const r=null!==(e=null===(n=t.responseJSON)||void 0===n?void 0:n.threshold)&&void 0!==e?e:null;(0,p.Iw)(r)}))})).catch((t=>{this.setState({error:t})}))}))}getProject(){const{projects:t,eventView:e,project:n}=this.props;if((0,x.ri)(n))return t.find((t=>t.id===n));const r=String(e.project[0]);return t.find((t=>t.id===r))}renderModalFields(){return(0,Z.BX)(s.Fragment,{children:[(0,Z.tZ)(h.Z,{"data-test-id":"response-metric",label:(0,y.t)("Calculation Method"),inline:!1,help:(0,y.t)("This determines which duration metric is used for the Response Time Threshold."),showHelpInTooltip:!0,flexibleControlStateSize:!0,stacked:!0,required:!0,children:(0,Z.tZ)(g.Z,{required:!0,options:w.slice(),name:"responseMetric",label:(0,y.t)("Calculation Method"),value:this.state.metric,onChange:t=>{this.handleFieldChange("metric")(t.value)}})}),(0,Z.tZ)(h.Z,{"data-test-id":"response-time-threshold",label:(0,y.t)("Response Time Threshold (ms)"),inline:!1,help:(0,y.t)("The satisfactory response time for the calculation method defined above. This is used to calculate Apdex and User Misery scores."),showHelpInTooltip:!0,flexibleControlStateSize:!0,stacked:!0,required:!0,children:(0,Z.tZ)(m.Z,{type:"number",name:"threshold",required:!0,pattern:"[0-9]*(\\.[0-9]*)?",onChange:t=>{this.handleFieldChange("threshold")(t.target.value)},value:this.state.threshold,step:100,min:100})})]})}render(){const{Header:t,Body:e,Footer:n,organization:r,transactionName:a,eventView:o}=this.props,i=this.getProject(),l=o.clone();l.query=l.getQueryWithAdditionalConditions();const c=(0,T.e1)({orgSlug:r.slug,transaction:a,query:l.generateQueryStringObject(),projectID:null==i?void 0:i.id});return(0,Z.BX)(s.Fragment,{children:[(0,Z.tZ)(t,{closeButton:!0,children:(0,Z.tZ)("h4",{children:(0,y.t)("Transaction Settings")})}),(0,Z.BX)(e,{children:[(0,Z.tZ)(C,{children:(0,y._N)("The changes below will only be applied to [transaction]. To set it at a more global level, go to [projectSettings: Project Settings].",{transaction:(0,Z.tZ)(v.Z,{to:c,children:a}),projectSettings:(0,Z.tZ)(v.Z,{to:`/settings/${r.slug}/projects/${null==i?void 0:i.slug}/performance/`})})}),this.renderModalFields()]}),(0,Z.tZ)(n,{children:(0,Z.BX)(d.ZP,{gap:1,children:[(0,Z.tZ)(u.ZP,{priority:"default",onClick:this.handleReset,"data-test-id":"reset-all",children:(0,y.t)("Reset All")}),(0,Z.tZ)(u.ZP,{"aria-label":(0,y.t)("Apply"),priority:"primary",onClick:this.handleApply,"data-test-id":"apply-threshold",children:(0,y.t)("Apply")})]})})]})}}j.displayName="TransactionThresholdModal";const C=(0,a.Z)("div",{target:"ezg6l150"})("margin-bottom:",(0,f.Z)(4),";"),E={name:"9w3zq5",styles:"width:100%;max-width:650px;margin:70px auto"},q=(0,S.Z)((0,b.Z)(j))},"./app/views/performance/transactionSummary/transactionVitals/utils.tsx":(t,e,n)=>{n.d(e,{Pl:()=>a,oZ:()=>s,eH:()=>o,L0:()=>i,jb:()=>l});var r=n("./app/utils/performance/histogram/utils.tsx");function a(t){let{orgSlug:e,transaction:n,projectID:r,query:a}=t;return{pathname:function(t){let{orgSlug:e}=t;return`/organizations/${e}/performance/summary/vitals/`}({orgSlug:e}),query:{transaction:n,project:r,environment:a.environment,statsPeriod:a.statsPeriod,start:a.start,end:a.end,query:a.query}}}function s(t,e){const n=(0,r.te)(t);return!t.length||e>=t[t.length-1].bin+n?null:e<t[0].bin?-1:Math.floor((e-t[0].bin)/n)}function o(t){if(t.length<2)return null;for(let e=0;e<t.length;e++){const n=t[e];for(let r=e+1;r<t.length;r++){const a=t[r];if(n.bin!==a.bin&&n.count!==a.count)return{point1:{x:e,y:Math.min(n.count,a.count)},point2:{x:r,y:Math.max(n.count,a.count)}}}}return{point1:{x:0,y:0},point2:{x:1,y:1}}}function i(t,e){const n=t.convertToPixel({xAxisIndex:0,yAxisIndex:0},[e.point1.x,e.point1.y]);if(isNaN(null==n?void 0:n[0])||isNaN(null==n?void 0:n[1]))return null;const r=t.convertToPixel({xAxisIndex:0,yAxisIndex:0},[e.point2.x,e.point2.y]);return isNaN(null==r?void 0:r[0])||isNaN(null==r?void 0:r[1])?null:{point1:{x:n[0],y:n[1]},point2:{x:r[0],y:r[1]}}}function l(t,e,n){if(e.point1.x===e.point2.x||e.point1.y===e.point2.y||n.point1.x===n.point2.x||n.point1.y===n.point2.y)return null;const r=(t.x-e.point1.x)/(e.point2.x-e.point1.x),a=(t.y-e.point1.y)/(e.point2.y-e.point1.y);return{x:n.point1.x+(n.point2.x-n.point1.x)*r,y:n.point1.y+(n.point2.y-n.point1.y)*a}}}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_pageLayout_tsx.495901e3ecc227d698080b6250b5bcba.js.map