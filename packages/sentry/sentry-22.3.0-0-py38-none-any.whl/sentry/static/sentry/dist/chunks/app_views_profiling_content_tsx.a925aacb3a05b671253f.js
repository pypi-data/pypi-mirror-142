"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_profiling_content_tsx"],{"./app/components/charts/chartZoom.tsx":(e,t,o)=>{o.d(t,{Z:()=>g});var n=o("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=o("../node_modules/react/index.js"),i=o("../node_modules/moment/moment.js"),r=o.n(i),a=o("../node_modules/query-string/index.js"),d=o("./app/actionCreators/pageFilters.tsx"),l=o("./app/components/charts/components/dataZoomInside.tsx"),c=o("./app/components/charts/components/toolBox.tsx"),p=o("./app/utils/callIfFunction.tsx"),u=o("./app/utils/dates.tsx");const m=e=>e?r().utc(e).format(r().HTML5_FMT.DATETIME_LOCAL_SECONDS):null;class h extends s.Component{constructor(e){var t;super(e),t=this,(0,n.Z)(this,"history",void 0),(0,n.Z)(this,"currentPeriod",void 0),(0,n.Z)(this,"zooming",null),(0,n.Z)(this,"saveCurrentPeriod",(e=>{this.currentPeriod={period:e.period,start:m(e.start),end:m(e.end)}})),(0,n.Z)(this,"setPeriod",(function(e){let{period:o,start:n,end:s}=e,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{router:r,onZoom:l,usePageDate:c}=t.props,h=m(n),g=m(s);i&&t.history.push(t.currentPeriod),(0,p.g)(l,{period:o,start:h,end:g}),t.zooming=()=>{if(c&&r){const e={...r.location.query,pageStart:n?(0,u.v5)(n):void 0,pageEnd:s?(0,u.v5)(s):void 0,pageStatsPeriod:null!=o?o:void 0};a.stringify(e)!==a.stringify(r.location.query)&&r.push({pathname:r.location.pathname,query:e})}else(0,d.dR)({period:o,start:h?(0,u.hC)(h):h,end:g?(0,u.hC)(g):g},r);t.saveCurrentPeriod({period:o,start:n,end:s})}})),(0,n.Z)(this,"handleChartReady",(e=>{(0,p.g)(this.props.onChartReady,e)})),(0,n.Z)(this,"handleZoomRestore",((e,t)=>{this.history.length&&(this.setPeriod(this.history[0]),this.history=[],(0,p.g)(this.props.onRestore,e,t))})),(0,n.Z)(this,"handleDataZoom",((e,t)=>{const o=t.getModel(),{startValue:n,endValue:s}=o._payload.batch[0];if(null===n&&null===s){const e=this.history.pop();if(!e)return;this.setPeriod(e)}else{const e=r().utc(n),t=r().utc(s);this.setPeriod({period:null,start:e,end:t},!0)}(0,p.g)(this.props.onDataZoom,e,t)})),(0,n.Z)(this,"handleChartFinished",((e,t)=>{var o;"function"==typeof this.zooming&&(this.zooming(),this.zooming=null);const n=null===(o=t._componentsViews)||void 0===o?void 0:o.find((e=>e._features&&e._features.dataZoom));n&&!n._features.dataZoom._isZoomActive&&t.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!0}),(0,p.g)(this.props.onFinished)})),this.history=[],this.saveCurrentPeriod(e)}componentDidUpdate(){this.props.disabled||this.saveCurrentPeriod(this.props)}render(){const{utc:e,start:t,end:o,disabled:n,children:s,xAxisIndex:i,router:r,onZoom:a,onRestore:d,onChartReady:p,onDataZoom:m,onFinished:h,...g}=this.props,v=null!=e?e:void 0,x=t?(0,u.hC)(t):void 0,Z=o?(0,u.hC)(o):void 0;return s(n?{utc:v,start:x,end:Z,...g}:{isGroupedByDate:!0,onChartReady:this.handleChartReady,utc:v,start:x,end:Z,dataZoom:(0,l.Z)({xAxisIndex:i}),showTimeInTooltip:!0,toolBox:(0,c.Z)({},{dataZoom:{title:{zoom:"",back:""},iconStyle:{borderWidth:0,color:"transparent",opacity:0}}}),onDataZoom:this.handleDataZoom,onFinished:this.handleChartFinished,onRestore:this.handleZoomRestore,...g})}}h.displayName="ChartZoom";const g=h},"./app/components/charts/components/dataZoomInside.tsx":(e,t,o)=>{o.d(t,{Z:()=>s}),o("../node_modules/echarts/lib/component/dataZoomInside.js");const n={type:"inside",zoomOnMouseWheel:!1,zoomLock:!0,throttle:50};function s(e){return e&&Array.isArray(e)?e:[{...n,...e}]}},"./app/components/charts/components/toolBox.tsx":(e,t,o)=>{function n(){let{dataZoom:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...e?{dataZoom:{yAxisIndex:"none",title:{zoom:"zoom",back:"undo"},...e}}:{},...t}}function s(e,t){return{right:0,top:0,itemSize:16,z:-1,feature:n(t),...e}}o.d(t,{Z:()=>s})},"./app/components/charts/loadingPanel.tsx":(e,t,o)=>{o.d(t,{Z:()=>a});var n=o("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(o("../node_modules/react/index.js"),o("./app/components/loadingMask.tsx")),i=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const r=(0,n.Z)((e=>{let{height:t,...o}=e;return(0,i.tZ)("div",{...o,children:(0,i.tZ)(s.Z,{})})}),{target:"eumb2md0"})("flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height),";position:relative;border-color:transparent;margin-bottom:0;");r.defaultProps={height:"200px"};const a=r},"./app/components/charts/transitionChart.tsx":(e,t,o)=>{o.d(t,{Z:()=>d});var n=o("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=(o("../node_modules/core-js/modules/web.dom-collections.iterator.js"),o("../node_modules/react/index.js")),i=o("./app/components/charts/loadingPanel.tsx"),r=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class a extends s.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{prevReloading:this.props.reloading,prevLoading:this.props.loading,key:1})}static getDerivedStateFromProps(e,t){const o=t.prevReloading,n=e.reloading,s=t.prevLoading,i=e.loading;return s!==i?{prevReloading:n,prevLoading:i,key:t.key+1}:i?{prevReloading:n,prevLoading:i,key:t.key}:o&&!n?{prevReloading:n,prevLoading:i,key:t.key+1}:{prevReloading:n,prevLoading:i,key:t.key}}render(){const{height:e,loading:t,reloading:o}=this.props;return t&&!o?(0,r.tZ)(i.Z,{height:e,"data-test-id":"events-request-loading"}):(0,r.tZ)(s.Fragment,{children:this.props.children},String(this.state.key))}}a.displayName="TransitionChart",(0,n.Z)(a,"defaultProps",{height:"200px"});const d=a},"./app/components/charts/transparentLoadingMask.tsx":(e,t,o)=>{o.d(t,{Z:()=>r});var n=o("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(o("../node_modules/react/index.js"),o("./app/components/loadingMask.tsx")),i=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const r=(0,n.Z)((e=>{let{className:t,visible:o,children:n,...r}=e;const a=o?{...r,"data-test-id":"loading-placeholder"}:r;return(0,i.tZ)(s.Z,{className:t,...a,children:n})}),{target:"ewtkxp50"})((e=>!e.visible&&"display: none;"),";opacity:0.4;z-index:1;")},"./app/components/loadingMask.tsx":(e,t,o)=>{o.d(t,{Z:()=>n});const n=(0,o("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e1dnwgq10"})("background-color:",(e=>e.theme.backgroundSecondary),";border-radius:",(e=>e.theme.borderRadius),";position:absolute;top:0;bottom:0;left:0;right:0;")},"./app/components/performanceDuration.tsx":(e,t,o)=>{o.d(t,{Z:()=>a});var n=o("./app/components/duration.tsx"),s=o("./app/utils.tsx"),i=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function r(e){const t=function(e){return(0,s.ri)(e.milliseconds)}(e)?e.milliseconds/1e3:e.seconds;return(0,i.tZ)(n.Z,{abbreviation:e.abbreviation,seconds:t,fixedDigits:2})}r.displayName="PerformanceDuration";const a=r},"./app/utils/discover/charts.tsx":(e,t,o)=>{o.d(t,{CX:()=>a,gu:()=>d});var n=o("./app/locale.tsx"),s=o("./app/utils.tsx"),i=o("./app/utils/discover/fields.tsx"),r=o("./app/utils/formatters.tsx");function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!(0,s.ri)(e))return"â€”";switch((0,i.Px)(t)){case"integer":case"number":return e.toLocaleString();case"percentage":return(0,r.rl)(e,2);case"duration":return(0,r.g9)(e/1e3,2,!0);default:return e.toString()}}function d(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch((0,i.Px)(t)){case"integer":case"number":return o?(0,r.Du)(e):e.toLocaleString();case"percentage":return(0,r.rl)(e,0);case"duration":return l(e);default:return e.toString()}}function l(e){if(0===e)return"0";if(e>=r.ps){const t=(e/r.ps).toFixed(0);return(0,n.t)("%swk",t)}if(e>=r.x4){const t=(e/r.x4).toFixed(0);return(0,n.t)("%sd",t)}if(e>=r.kr){const t=(e/r.kr).toFixed(0);return(0,n.t)("%shr",t)}if(e>=r.EB){const t=(e/r.EB).toFixed(0);return(0,n.t)("%smin",t)}if(e>=r.sh){const t=(e/r.sh).toFixed(0);return(0,n.t)("%ss",t)}const t=e.toFixed(0);return(0,n.t)("%sms",t)}},"./app/views/profiling/content.tsx":(e,t,o)=>{o.r(t),o.d(t,{default:()=>le});var n=o("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(o("../node_modules/core-js/modules/web.dom-collections.iterator.js"),o("./app/components/alert.tsx")),i=o("./app/components/layouts/thirds.tsx"),r=o("./app/components/noProjectMessage.tsx"),a=o("./app/components/organizations/pageFilters/container.tsx"),d=o("./app/components/pageHeading.tsx"),l=o("./app/components/pagination.tsx"),c=o("./app/components/sentryDocumentTitle.tsx"),p=o("./app/icons/index.tsx"),u=o("./app/locale.tsx"),m=o("./app/styles/organization.tsx"),h=o("../node_modules/react/index.js"),g=o("./app/components/organizations/pageFilters/parse.tsx"),v=o("./app/utils/useApi.tsx"),x=o("./app/utils/useOrganization.tsx");var Z=o("./app/utils/queryString.tsx"),_=o("./app/utils/withPageFilters.tsx"),f=o("../node_modules/react-router/es/index.js"),y=o("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),b=o("../node_modules/moment/moment.js"),j=o.n(b),k=o("../node_modules/moment-timezone/index.js"),w=o.n(k),C=o("./app/components/charts/chartZoom.tsx"),P=o("./app/components/charts/optionSelector.tsx"),z=(o("../node_modules/echarts/lib/chart/scatter.js"),o("./app/utils/theme.tsx")),S=o("./app/components/charts/baseChart.tsx"),D=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function L(e){var t;let{series:o,...n}=e;return(0,D.tZ)(S.Z,{...n,xAxis:{axisPointer:{show:!1,...null===(t=n.xAxis)||void 0===t?void 0:t.axisPointer},...n.xAxis},series:o.map((e=>{let{seriesName:t,data:o,...n}=e;return function(e){return{symbolSize:z.ZP.charts.symbolSize,...e,type:"scatter",emphasis:{...e.emphasis,scale:!0}}}({name:t,data:o.map((e=>{let{name:t,value:o}=e;return[t,o]})),...n,animation:!1})}))})}L.displayName="ScatterChart";const R=L;var I=o("./app/components/charts/styles.tsx"),A=o("./app/components/charts/transitionChart.tsx"),M=o("./app/components/charts/transparentLoadingMask.tsx"),F=o("./app/components/charts/utils.tsx"),B=o("./app/components/panels/index.tsx"),N=o("./app/stores/configStore.tsx"),T=o("./app/utils.tsx"),q=o("./app/utils/discover/charts.tsx"),O=o("./app/utils/formatters.tsx"),E=o("./app/utils/useProjects.tsx");function W(e){let{orgSlug:t,projectSlug:o,profileId:n}=e;return`/organizations/${t}/profiling/flamegraph/${o}/${n}/`}const $={version:(0,u.t)("App Version"),device_manufacturer:(0,u.t)("Device Manufacturer"),device_model:(0,u.t)("Device Model"),device_os_version:(0,u.t)("Device Os Version"),interaction_name:(0,u.t)("Interaction Name")},H=Object.entries($).map((e=>{let[t,o]=e;return{label:o,value:t}}));function V(e){let{router:t,location:o,datetime:n,isLoading:s,traces:i}=e;const r=(0,x.Z)(),{projects:a}=(0,E.Z)(),d=(0,y.u)(),l=(0,h.useMemo)((()=>function(e){const t=(0,Z.ro)(e.query.colorEncoding);return(0,T.ri)(t)&&$.hasOwnProperty(t)?t:"interaction_name"}(o)),[o]),c=(0,h.useMemo)((()=>{const e={};for(const t of i){const o="version"===l?`${t.app_version_name} (build ${t.app_version})`:t[l];e[o]||(e[o]=[]),e[o].push(t)}return e}),[l,i]),p=(0,h.useMemo)((()=>Object.entries(c).map((e=>{let[t,o]=e;return{seriesName:t,data:o.map((e=>({name:1e3*e.start_time_unix,value:e.trace_duration_ms})))}}))),[c]),m=(0,h.useMemo)((()=>function(e){var t,o;let{data:n,datetime:s,location:i,organization:r,projects:a,theme:d}=e;const l=N.Z.get("user"),c=null==l?void 0:l.options,p=j().utc(),m=((0,T.ri)(s.end)?j().utc(s.end):p).valueOf();return{grid:{left:"10px",right:"10px",top:"40px",bottom:"0px"},tooltip:{trigger:"item",formatter:e=>{var t,o;const s=null===(t=n[e.seriesName])||void 0===t?void 0:t[e.dataIndex],i=s&&a.find((e=>e.id===s.app_id));return['<div class="tooltip-series">',...[{label:(0,u.t)("Project"),value:null==i?void 0:i.slug},{label:(0,u.t)("App Version"),value:null==s?void 0:s.app_version},{label:(0,u.t)("Duration"),value:(0,T.ri)(null==s?void 0:s.trace_duration_ms)?(0,O.g9)(null==s?void 0:s.trace_duration_ms,2,!0):null},{label:(0,u.t)("Interaction"),value:null==s?void 0:s.interaction_name},{label:(0,u.t)("Device Model"),value:null==s?void 0:s.device_model},{label:(0,u.t)("Device Class"),value:null==s?void 0:s.device_class},{label:(0,u.t)("Device Manufacturer"),value:null==s?void 0:s.device_manufacturer}].map((e=>{let{label:t,value:o}=e;return`<div><span class="tooltip-label"><strong>${t}</strong></span> ${null!=o?o:(0,u.t)("Unknown")}</div>`})),"</div>",`<div class="tooltip-date">${(0,T.ri)(null==s?void 0:s.start_time_unix)?w().tz(1e3*(null==s?void 0:s.start_time_unix),null!==(o=null==c?void 0:c.timezone)&&void 0!==o?o:"").format("lll"):null}</div>`,'<div class="tooltip-arrow"></div>'].join("")}},xAxis:{min:((0,T.ri)(s.start)?j().utc(s.start):p.subtract(parseInt(null!==(t=s.period)&&void 0!==t?t:"14",10),"h"===(null===(o=s.period)||void 0===o?void 0:o.charAt(s.period.length-1))?"hours":"days")).valueOf(),max:m},yAxis:{axisLabel:{color:d.chartLabel,formatter:e=>(0,q.gu)(e,"p50()")}},legend:{right:10,top:5,selected:(0,F.RI)(i)},onClick:e=>{var t;const o=null===(t=n[e.seriesName])||void 0===t?void 0:t[e.dataIndex];if(!(0,T.ri)(o))return;const s=a.find((e=>e.id===o.app_id));(0,T.ri)(s)&&f.browserHistory.push(W({orgSlug:r.slug,projectSlug:s.slug,profileId:o.id}))}}}({data:c,datetime:n,location:o,organization:r,projects:a,theme:d})),[o,n,d,c]),g=(0,h.useCallback)((e=>{f.browserHistory.push({...o,query:{...o.query,colorEncoding:e}})}),[o]);return(0,D.BX)(B.s_,{children:[(0,D.tZ)(I.BO,{children:(0,D.tZ)(C.Z,{router:t,period:n.period,start:n.start,end:n.end,utc:n.utc,children:e=>(0,D.BX)(A.Z,{loading:s,reloading:s,children:[(0,D.tZ)(M.Z,{visible:s}),(0,D.tZ)(R,{series:p,...m,...e})]})})}),(0,D.tZ)(I.xx,{children:(0,D.tZ)(I.m2,{children:(0,D.tZ)(P.Z,{title:(0,u.t)("Group By"),selected:l,options:H,onChange:g})})})]})}V.displayName="ProfilingScatterChart";const X=(0,f.withRouter)(V);var G=o("./app/components/gridEditable/index.tsx"),U=o("./app/components/dateTime.tsx"),J=o("./app/components/idBadge/projectBadge.tsx"),K=o("./app/components/links/link.tsx"),Q=o("./app/components/performanceDuration.tsx"),Y=o("./app/utils/discover/styles.tsx"),ee=o("./app/utils/events.tsx");function te(e){let{column:t,dataRow:o}=e;const n=(0,x.Z)(),{projects:s}=(0,E.Z)(),i="id"===t.key||"app_id"===t.key?s.find((e=>e.id===o.app_id)):void 0,r=o[t.key];switch(t.key){case"id":if(!(0,T.ri)(i))return(0,D.tZ)(Y.W2,{children:(0,u.t)("n/a")});const e=W({orgSlug:n.slug,projectSlug:i.slug,profileId:o.id});return(0,D.tZ)(Y.W2,{children:(0,D.tZ)(K.Z,{to:e,children:(0,ee.XQ)(o.id)})});case"app_id":return(0,T.ri)(i)?(0,D.tZ)(Y.W2,{children:(0,D.tZ)(J.Z,{project:i,avatarSize:16})}):(0,D.tZ)(Y.W2,{children:(0,u.t)("n/a")});case"app_version_name":return(0,D.tZ)(Y.W2,{children:o.app_version?(0,u.t)("%s (build %s)",r,o.app_version):r});case"failed":return(0,D.tZ)(Y.W2,{children:r?(0,D.tZ)(p.bM,{size:"sm",color:"red300",isCircled:!0}):(0,D.tZ)(p.DL,{size:"sm",color:"green300",isCircled:!0})});case"start_time_unix":return(0,D.tZ)(Y.W2,{children:(0,D.tZ)(U.Z,{date:1e3*r})});case"trace_duration_ms":return(0,D.tZ)(Y.Hw,{children:(0,D.tZ)(Q.Z,{milliseconds:r,abbreviation:!0})});default:return(0,D.tZ)(Y.W2,{children:r})}}function oe(e){let{error:t,isLoading:o,location:n,traces:s}=e;return(0,D.tZ)(G.ZP,{isLoading:o,error:t,data:s,columnOrder:se.map((e=>ie[e])),columnSortBy:[],grid:{renderBodyCell:ne},location:n})}function ne(e,t,o,n){return(0,D.tZ)(te,{column:e,dataRow:t,rowIndex:o,columnIndex:n})}oe.displayName="ProfilingTable",ne.displayName="renderProfilingTableCell";const se=["failed","id","app_id","app_version_name","interaction_name","start_time_unix","trace_duration_ms","device_model","device_class"],ie={id:{key:"id",name:(0,u.t)("Profile ID"),width:G.z7},app_id:{key:"app_id",name:(0,u.t)("Project"),width:G.z7},failed:{key:"failed",name:(0,u.t)("Status"),width:14},app_version_name:{key:"app_version_name",name:(0,u.t)("Version"),width:G.z7},interaction_name:{key:"interaction_name",name:(0,u.t)("Interaction Name"),width:G.z7},start_time_unix:{key:"start_time_unix",name:(0,u.t)("Timestamp"),width:G.z7},trace_duration_ms:{key:"trace_duration_ms",name:(0,u.t)("Duration"),width:G.z7},device_model:{key:"device_model",name:(0,u.t)("Device Model"),width:G.z7},device_class:{key:"device_class",name:(0,u.t)("Device Class"),width:G.z7}};function re(e){var t;let{location:o,selection:n}=e;const d=(0,x.Z)(),m=(0,Z.ro)(o.query.cursor),[_,f,y]=function(e){let{cursor:t,selection:o}=e;const n=(0,v.Z)(),s=(0,x.Z)(),[i,r]=(0,h.useState)("initial"),[a,d]=(0,h.useState)([]),[l,c]=(0,h.useState)(null);return(0,h.useEffect)((()=>{void 0!==o&&(n.clear(),r("loading"),function(e,t,o,n){return e.requestPromise(`/organizations/${o.slug}/profiling/profiles/`,{method:"GET",includeAllArgs:!0,query:{cursor:t,project:n.projects,environment:n.environments,...(0,g.fK)(n.datetime)}})}(n,t,s,o).then((e=>{var t;let[o,,n]=e;d(o),c(null!==(t=null==n?void 0:n.getResponseHeader("Link"))&&void 0!==t?t:null),r("resolved")})).catch((()=>r("errored"))))}),[n,t,s,o]),[i,a,l]}({cursor:m,selection:n});return(0,D.tZ)(c.Z,{title:(0,u.t)("Profiling"),orgSlug:d.slug,children:(0,D.tZ)(a.Z,{children:(0,D.tZ)(r.Z,{organization:d,children:(0,D.BX)(ae,{children:[(0,D.tZ)(i.h4,{children:(0,D.tZ)(i.oB,{children:(0,D.tZ)(de,{children:(0,u.t)("Profiling")})})}),(0,D.tZ)(i.uT,{children:(0,D.BX)(i.or,{fullWidth:!0,children:["errored"===_&&(0,D.tZ)(s.Z,{type:"error",icon:(0,D.tZ)(p.Gy,{size:"md"}),children:(0,u.t)("Unable to load profiles")}),(0,D.tZ)(X,{datetime:null!==(t=null==n?void 0:n.datetime)&&void 0!==t?t:{start:null,end:null,period:null,utc:null},traces:f,isLoading:"loading"===_}),(0,D.tZ)(oe,{isLoading:"loading"===_,error:"errored"===_?(0,u.t)("Unable to load profiles"):null,location:o,traces:f}),(0,D.tZ)(l.Z,{pageLinks:y})]})})]})})})})}re.displayName="ProfilingContent";const ae=(0,n.Z)(m.JH,{target:"eil9lws1"})({name:"1hcx8jb",styles:"padding:0"}),de=(0,n.Z)(d.Z,{target:"eil9lws0"})({name:"ht6xsx",styles:"line-height:40px"}),le=(0,_.Z)(re)}}]);
//# sourceMappingURL=../sourcemaps/app_views_profiling_content_tsx.8441af70fea921a9a16a1df8feb479ae.js.map