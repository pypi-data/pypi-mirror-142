"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_utils_discover_charts_tsx-app_utils_discover_genericDiscoverQuery_tsx-app_views_performan-510bef"],{"./app/utils/discover/charts.tsx":(e,t,n)=>{n.d(t,{CX:()=>a,gu:()=>l});var r=n("./app/locale.tsx"),s=n("./app/utils.tsx"),o=n("./app/utils/discover/fields.tsx"),i=n("./app/utils/formatters.tsx");function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!(0,s.ri)(e))return"â€”";switch((0,o.Px)(t)){case"integer":case"number":return e.toLocaleString();case"percentage":return(0,i.rl)(e,2);case"duration":return(0,i.g9)(e/1e3,2,!0);default:return e.toString()}}function l(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch((0,o.Px)(t)){case"integer":case"number":return n?(0,i.Du)(e):e.toLocaleString();case"percentage":return(0,i.rl)(e,0);case"duration":return u(e);default:return e.toString()}}function u(e){if(0===e)return"0";if(e>=i.ps){const t=(e/i.ps).toFixed(0);return(0,r.t)("%swk",t)}if(e>=i.x4){const t=(e/i.x4).toFixed(0);return(0,r.t)("%sd",t)}if(e>=i.kr){const t=(e/i.kr).toFixed(0);return(0,r.t)("%shr",t)}if(e>=i.EB){const t=(e/i.EB).toFixed(0);return(0,r.t)("%smin",t)}if(e>=i.sh){const t=(e/i.sh).toFixed(0);return(0,r.t)("%ss",t)}const t=e.toFixed(0);return(0,r.t)("%sms",t)}},"./app/utils/discover/genericDiscoverQuery.tsx":(e,t,n)=>{n.d(t,{AA:()=>p,ZP:()=>m});var r=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),o=n("./app/locale.tsx"),i=n("./app/utils/discover/eventView.tsx"),a=n("./app/utils/performance/contexts/performanceEventViewContext.tsx"),l=n("./app/utils/useOrganization.tsx"),u=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class c extends s.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{isLoading:!0,tableFetchID:void 0,error:null,tableData:null,pageLinks:null}),(0,r.Z)(this,"_shouldRefetchData",(e=>{const t=this.getPayload(this.props),n=this.getPayload(e);return!(0,i.ze)(t,n)||e.limit!==this.props.limit||e.route!==this.props.route||e.cursor!==this.props.cursor})),(0,r.Z)(this,"fetchData",(async()=>{const{api:e,beforeFetch:t,afterFetch:n,didFetch:r,eventView:s,orgSlug:i,route:a,setError:l}=this.props;if(!s.isValid())return;const u=`/organizations/${i}/${a}/`,c=Symbol("tableFetchID"),d=this.getPayload(this.props);this.setState({isLoading:!0,tableFetchID:c}),null==l||l(void 0),null==t||t(e),e.clear();try{const[t,,s]=await p(e,u,d);if(this.state.tableFetchID!==c)return;const o=n?n(t,this.props):t;null==r||r(o),this.setState((e=>{var t;return{isLoading:!1,tableFetchID:void 0,error:null,pageLinks:null!==(t=null==s?void 0:s.getResponseHeader("Link"))&&void 0!==t?t:e.pageLinks,tableData:o}}))}catch(e){var m;const t=(null==e||null===(m=e.responseJSON)||void 0===m?void 0:m.detail)||(0,o.t)("An unknown error occurred.");this.setState({isLoading:!1,tableFetchID:void 0,error:t,tableData:null}),l&&l(t)}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){const t=this._shouldRefetchData(e),n=!1===e.eventView.isValid()&&this.props.eventView.isValid(),r=!!this.props.shouldRefetchData&&this.props.shouldRefetchData(e,this.props);(t||n||r)&&this.fetchData()}getPayload(e){var t;const{cursor:n,limit:r,noPagination:s,referrer:o}=e,i=this.props.getRequestPayload?this.props.getRequestPayload(e):e.eventView.getEventsAPIPayload(e.location);return n&&(i.cursor=n),r&&(i.per_page=r),s&&(i.noPagination=s),o&&(i.referrer=o),Object.assign(i,null!==(t=e.queryExtras)&&void 0!==t?t:{}),i}render(){const{isLoading:e,error:t,tableData:n,pageLinks:r}=this.state,s={isLoading:e,error:t,tableData:n,pageLinks:r},o=this.props.children;return null==o?void 0:o(s)}}function d(e){var t,n;const r=null!==(t=e.orgSlug)&&void 0!==t?t:(0,l.Z)().slug,s=null!==(n=e.eventView)&&void 0!==n?n:(0,a.wj)(),o={...e,orgSlug:r,eventView:s};return(0,u.tZ)(c,{...o})}async function p(e,t,n){return e.requestPromise(t,{method:"GET",includeAllArgs:!0,query:{...n}})}c.displayName="_GenericDiscoverQuery",d.displayName="GenericDiscoverQuery";const m=d},"./app/utils/performance/contexts/performanceEventViewContext.tsx":(e,t,n)=>{n.d(t,{bq:()=>s,wj:()=>i}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("./app/utils/performance/contexts/utils.tsx");const[s,o]=(0,r.n)({name:"PerformanceEventViewContext"});function i(){return o().eventView}},"./app/utils/performance/contexts/utils.tsx":(e,t,n)=>{n.d(t,{n:()=>s});var r=n("../node_modules/react/index.js");function s(e){const{strict:t=!0,errorMessage:n=`useContext for "${e.name}" must be inside a Provider with a value`,name:s}=e,o=r.createContext(void 0);return o.displayName=s,[o.Provider,function(){const e=r.useContext(o);if(!e&&t)throw new Error(n);return e},o]}},"./app/views/performance/trends/types.tsx":(e,t,n)=>{let r,s,o;n.d(t,{ER:()=>r,Z2:()=>s,A2:()=>o}),function(e){e.IMPROVED="improved",e.REGRESSION="regression"}(r||(r={})),function(e){e.P50="p50",e.P75="p75",e.P95="p95",e.P99="p99",e.AVG="avg"}(s||(s={})),function(e){e.DURATION="transaction.duration",e.LCP="measurements.lcp",e.FCP="measurements.fcp",e.FID="measurements.fid",e.CLS="measurements.cls",e.SPANS_DB="spans.db",e.SPANS_HTTP="spans.http",e.SPANS_BROWSER="spans.browser",e.SPANS_RESOURCE="spans.resource"}(o||(o={}))},"./app/views/performance/trends/utils.tsx":(e,t,n)=>{n.d(t,{_1:()=>f,bg:()=>g,T1:()=>h,cs:()=>v,es:()=>S,vt:()=>R,Ws:()=>b,CE:()=>y,IO:()=>P,ed:()=>N,Kt:()=>_,_H:()=>D,kM:()=>w,iF:()=>F,wx:()=>A,RP:()=>O,j_:()=>V,P4:()=>C,HF:()=>I,vq:()=>L}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/downsample/methods/ASAP.js"),s=n("../node_modules/moment/moment.js"),o=n.n(s),i=n("./app/components/charts/utils.tsx"),a=n("./app/locale.tsx"),l=n("./app/utils/discover/fields.tsx"),u=n("./app/utils/queryString.tsx"),c=n("./app/utils/theme.tsx"),d=n("./app/utils/tokenizeSearch.tsx"),p=n("./app/views/performance/utils.tsx"),m=n("./app/views/performance/trends/types.tsx");const f="14d",g="15min",h=[{label:"p50",field:m.Z2.P50,alias:"percentile_range",legendLabel:"p50"},{label:"p75",field:m.Z2.P75,alias:"percentile_range",legendLabel:"p75"},{label:"p95",field:m.Z2.P95,alias:"percentile_range",legendLabel:"p95"},{label:"p99",field:m.Z2.P99,alias:"percentile_range",legendLabel:"p99"},{label:"average",field:m.Z2.AVG,alias:"avg_range",legendLabel:"average"}],v=[{label:"Duration",column:m.A2.DURATION},{label:"LCP",column:m.A2.LCP},{label:"FCP",column:m.A2.FCP},{label:"FID",column:m.A2.FID},{label:"CLS",column:m.A2.CLS},{label:"Spans (http)",column:m.A2.SPANS_HTTP},{label:"Spans (db)",column:m.A2.SPANS_DB},{label:"Spans (browser)",column:m.A2.SPANS_BROWSER},{label:"Spans (resource)",column:m.A2.SPANS_RESOURCE}],S={[m.ER.IMPROVED]:{lighter:c.ZP.green200,default:c.ZP.green300},[m.ER.REGRESSION]:{lighter:c.ZP.red200,default:c.ZP.red300}},E={[m.ER.IMPROVED]:"improvedSelected",[m.ER.REGRESSION]:"regressionSelected"},x={[m.ER.IMPROVED]:"improvedUnselectedSeries",[m.ER.REGRESSION]:"regressionUnselectedSeries"},R={[m.ER.IMPROVED]:"improvedCursor",[m.ER.REGRESSION]:"regressionCursor"};function b(){const e={};return Object.values(R).forEach((t=>e[t]=void 0)),e}function y(e,t){var n;const r=null!=t?t:(0,u.ro)(null==e||null===(n=e.query)||void 0===n?void 0:n.trendFunction);return h.find((e=>{let{field:t}=e;return t===r}))||h[0]}function P(e,t,n){var r;const s=(0,u.ro)(null==e||null===(r=e.query)||void 0===r?void 0:r.trendParameter),o=v.find((e=>{let{label:t}=e;return t===s}));return o||function(e,t){return function(e){switch(e){case p.iy.FRONTEND:return{label:"LCP",column:m.A2.LCP};case p.iy.ANY:case p.iy.BACKEND:case p.iy.FRONTEND_OTHER:default:return{label:"Duration",column:m.A2.DURATION}}}((0,p.Bh)(e,t))}(t,n)}function N(e,t){return(0,l.sN)({kind:"function",function:[e,t,void 0,void 0]})}function _(e,t){return{fromSeconds:e/1e3,toSeconds:t/1e3,showDigits:e>1e3||t>1e3||e<10||t<10}}function D(e,t){if(!e.project||!t)return;const n=t.find((t=>t.slug===e.project));return null==n?void 0:n.id}function w(e,t,n,r,s){const o=y(t),a=P(t,r,e.project),l=[...s?[]:["transaction"],"project"].map((e=>({field:e}))),c={field:"trend_percentage()",kind:"asc"};e.trendType=n,n===m.ER.REGRESSION&&(c.kind="desc"),o&&a&&(e.trendFunction=N(o.field,a.column)),e.query=function(e){const t=new d.MY(e);return t.hasFilter("count_percentage()")||t.addFilterValues("count_percentage()",[">0.25","<4"]),t.hasFilter("trend_percentage()")||t.addFilterValues("trend_percentage()",[">0%"]),t.hasFilter("confidence()")||t.addFilterValues("confidence()",[">6"]),t.formatString()}(e.query),e.interval=function(e,t){var n;const r=(0,u.ro)(null==e||null===(n=e.query)||void 0===n?void 0:n.interval),{start:s,end:o,statsPeriod:a}=t,l={start:s||null,end:o||null,period:a},c=(0,i.ZS)(l,"high");return r||c}(t,e),e.sorts=[c],e.fields=l}function F(e,t){const{query:n}=t,r=n.start&&n.end;return n.statsPeriod||r||(e.statsPeriod=f),e}function A(e,t){const n=Math.abs(e);return{seconds:n/1e3,fixedDigits:n>1e3||n<10?1:0,changeLabel:t===m.ER.REGRESSION?(0,a.t)("slower"):(0,a.t)("faster")}}function O(e){const t=o()();return e.map((e=>({...e,received_at:t,transaction:e.transaction})))}function V(e){return E[e]}function C(e){return x[e]}const T=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return(0,r.Cl)(e,t)},I=e=>["p50","p75"].find((t=>e.includes(t)));function L(e,t){let n=Number.MAX_SAFE_INTEGER,r=0;if(!e)return{maxValue:r,minValue:n,smoothedResults:void 0};const s=[];for(const o of e){const e=o.data,i=[],a=T(e.map((e=>{let{name:t,value:n}=e;return[Number(t),n]})));for(let e=0;e<a.length;e++){const t=a[e],s=t.y;if(i.push({name:t.x,value:s}),!isNaN(s)){const e=Math.round(s);n=Math.min(e,n),r=Math.max(e,r)}}s.push({seriesName:t||o.seriesName||"Current",data:i,lineStyle:o.lineStyle,color:o.color})}return{minValue:n,maxValue:r,smoothedResults:s}}},"./app/views/performance/utils.tsx":(e,t,n)=>{n.d(t,{U7:()=>f,iy:()=>g,Bh:()=>E,C$:()=>x,Ik:()=>R,iL:()=>b,de:()=>y,Ws:()=>P,Ov:()=>N,R8:()=>_,al:()=>D,m_:()=>w,n4:()=>F,JY:()=>A,YL:()=>O}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/react-router/es/index.js"),s=n("./app/constants/pageFilters.tsx"),o=n("./app/data/platformCategories.tsx"),i=n("./app/utils/analytics.tsx"),a=n("./app/utils/dates.tsx"),l=n("./app/utils/discover/fields.tsx"),u=n("./app/utils/formatters.tsx"),c=n("./app/utils/getCurrentSentryReactTransaction.tsx"),d=n("./app/utils/queryString.tsx"),p=n("./app/utils/tokenizeSearch.tsx"),m=n("./app/views/performance/trends/utils.tsx");const f=["environment","project","query","start","end","statsPeriod"];let g;!function(e){e.ANY="any",e.FRONTEND="frontend",e.BACKEND="backend",e.FRONTEND_OTHER="frontend_other",e.MOBILE="mobile"}(g||(g={}));const h=[...o.tQ],v=o.y3.filter((e=>"native"!==e)),S=[...o.ai];function E(e,t){if(0===t.length||t[0]===s.mP)return g.ANY;const n=e.filter((e=>t.includes(parseInt(`${e.id}`,10))));return 0===n.length||n.some((e=>!e.platform))?g.ANY:n.every((e=>h.includes(e.platform)))?g.FRONTEND:n.every((e=>v.includes(e.platform)))?g.BACKEND:n.every((e=>S.includes(e.platform)))?g.MOBILE:g.ANY}function x(e,t){const n=E(e,t.project);return n===g.FRONTEND&&new p.MY(t.query).getFilterValues("!transaction.op").some((e=>"pageload"===e))?g.FRONTEND_OTHER:n}function R(e,t){return x(t,e)===g.FRONTEND}function b(e,t){return x(t,e)===g.FRONTEND||x(t,e)===g.FRONTEND_OTHER}function y(e){return`/organizations/${e.slug}/performance/`}function P(e){return`/organizations/${e.slug}/performance/trends/`}function N(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,d.ro)(e.query.query,t).trim()}function _(e){let{location:t,organization:n}=e;(0,i.ec)({eventKey:"performance_views.change_view",eventName:"Performance Views: Change View",organization_id:parseInt(n.id,10),view_name:"TRENDS"});const s=D({location:t,organization:n});r.browserHistory.push(s)}function D(e){let{location:t,organization:n,initialConditions:r,additionalQuery:s}=e;const o={...t.query,...s},i=(0,d.ro)(t.query.query,""),a=new p.MY(i),l=null!=r?r:new p.MY([]);return a.hasFilter("tpm()")?l.setFilterValues("tpm()",a.getFilterValues("tpm()")):l.setFilterValues("tpm()",[">0.01"]),a.hasFilter("transaction.duration")?l.setFilterValues("transaction.duration",a.getFilterValues("transaction.duration")):l.setFilterValues("transaction.duration",[">0",`<${m.bg}`]),o.query=l.formatString(),{pathname:P(n),query:{...o}}}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{excludeTagKeys:new Set(["event.type","project"])};return e.getFilterKeys().forEach((n=>{const r=n.startsWith("!")?n.substr(1):n;(r.match(/\w+\(.*\)/)||l.J8.includes(r)||t.excludeTagKeys.has(r))&&e.removeFilter(n)})),e}function F(e){const t=(0,c.Z)(),n=(0,a.Ri)(e.datetime.period,e.datetime.start,e.datetime.end),r=Math.floor(86400*n);null==t||t.setTag("query.period",r.toString());let s=">30d";r<=86400?s="<=1d":r<=604800?s="<=7d":r<=1209600?s="<=14d":r<=2592e3&&(s="<=30d"),null==t||t.setTag("query.period.grouped",s)}function A(e){const{transaction:t}=e.query;return(0,d.ro)(t)}function O(e){return(0,u.g9)(e/1e3,e>1e3?2:0,!0)}}}]);
//# sourceMappingURL=../sourcemaps/app_utils_discover_charts_tsx-app_utils_discover_genericDiscoverQuery_tsx-app_views_performan-510bef.ebd27ee3b750332262275939991cdf0d.js.map