"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_organizationGroupDetails_groupTagValues_tsx"],{"./app/components/dataExport.tsx":(e,t,o)=>{o.d(t,{tD:()=>m,ZP:()=>h}),o("../node_modules/core-js/modules/web.dom-collections.iterator.js");var i=o("../node_modules/react/index.js"),s=o("../node_modules/lodash/debounce.js"),n=o.n(s),a=o("./app/actionCreators/indicator.tsx"),r=o("./app/components/acl/feature.tsx"),l=o("./app/components/button.tsx"),d=o("./app/locale.tsx"),u=o("./app/utils/withApi.tsx"),p=o("./app/utils/withOrganization.tsx"),c=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");let m;function g(e){let{api:t,children:o,disabled:s,organization:u,payload:p,icon:m}=e;const[g,h]=i.useState(!1);i.useEffect((()=>{g&&h(!1)}),[p.queryType,p.queryInfo]);const y=i.useCallback((()=>{h(!0),t.requestPromise(`/organizations/${u.slug}/data-export/`,{includeAllArgs:!0,method:"POST",data:{query_type:p.queryType,query_info:p.queryInfo}}).then((e=>{let[t,o,i]=e;(0,a.S9)(201===(null==i?void 0:i.status)?(0,d.t)("Sit tight. We'll shoot you an email when your data is ready for download."):(0,d.t)("It looks like we're already working on it. Sit tight, we'll email you."))})).catch((e=>{var t,o;const i=null!==(t=null==e||null===(o=e.responseJSON)||void 0===o?void 0:o.detail)&&void 0!==t?t:"We tried our hardest, but we couldn't export your data. Give it another go.";(0,a.Iw)((0,d.t)(i)),h(!1)}))}),[p.queryInfo,p.queryType,u.slug,t]);return(0,c.tZ)(r.Z,{features:["organizations:discover-query"],children:g?(0,c.tZ)(l.ZP,{size:"small",priority:"default",title:"You can get on with your life. We'll email you when your data's ready.",disabled:!0,icon:m,children:(0,d.t)("We're working on it...")}):(0,c.tZ)(l.ZP,{onClick:n()(y,500),disabled:s||!1,size:"small",priority:"default",title:"Put your data to work. Start your export and we'll email you when it's finished.",icon:m,children:o||(0,d.t)("Export All to CSV")})})}!function(e){e.IssuesByTag="Issues-by-Tag",e.Discover="Discover"}(m||(m={})),g.displayName="DataExport";const h=(0,u.Z)((0,p.Z)(g))},"./app/components/deviceName.tsx":(e,t,o)=>{o.d(t,{qW:()=>r,f:()=>l,Hy:()=>d}),o("../node_modules/core-js/modules/web.dom-collections.iterator.js");var i=o("../node_modules/react/index.js"),s=o("../node_modules/@sentry/minimal/esm/index.js"),n=o("./app/components/deviceName.tsx"),a=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function r(e,t){if("string"!=typeof e)return null;if(null===t)return e;const[o,...i]=e.split(" "),s=t.generationByIdentifier(o);return void 0===s?e:`${s} ${i.join(" ")}`}async function l(e){return"iOS"!==e&&s.Tb("DeviceName component only supports iOS module"),o.e("vendors-node_modules_ios-device-list_dist_ios-device-list_min_js").then(o.t.bind(o,"../node_modules/ios-device-list/dist/ios-device-list.min.js",23))}function d(e){let{value:t,children:o}=e;const[l,d]=i.useState(null);i.useEffect((()=>{let e=!1;return n.f("iOS").then((t=>{e||d(t)})).catch((()=>{s.Tb("Failed to load ios-device-list module")})),()=>{e=!0}}),[]);const u=i.useMemo((()=>r(t,l)),[t,l]);return u?(0,a.tZ)("span",{"data-test-id":"loaded-device-name",children:o?o(u):u}):null}},"./app/views/organizationGroupDetails/groupTagValues.tsx":(e,t,o)=>{o.r(t),o.d(t,{default:()=>k});var i=o("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(o("../node_modules/core-js/modules/web.dom-collections.iterator.js"),o("../node_modules/react/index.js")),n=o("./app/components/acl/feature.tsx"),a=o("./app/components/asyncComponent.tsx"),r=o("./app/components/button.tsx"),l=o("./app/components/buttonBar.tsx"),d=o("./app/components/dataExport.tsx"),u=o("./app/components/deviceName.tsx"),p=o("./app/components/dropdownLink.tsx"),c=o("./app/components/globalSelectionLink.tsx"),m=o("./app/components/idBadge/userBadge.tsx"),g=o("./app/components/links/externalLink.tsx"),h=o("./app/components/links/link.tsx"),y=o("./app/components/pagination.tsx"),x=o("./app/components/panels/index.tsx"),Z=o("./app/components/timeSince.tsx"),v=o("./app/icons/index.tsx"),f=o("./app/locale.tsx"),b=o("./app/styles/overflowEllipsis.tsx"),w=o("./app/styles/space.tsx"),j=o("./app/utils.tsx"),S=o("./app/utils/discover/eventView.tsx"),q=o("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class _ extends a.Z{getEndpoints(){const{environments:e}=this.props,{groupId:t,tagKey:o}=this.props.params;return[["tag",`/issues/${t}/tags/${o}/`],["tagValueList",`/issues/${t}/tags/${o}/values/`,{query:{environment:e,sort:this.getSort()}}]]}getSort(){return this.props.location.query.sort||"count"}renderLoading(){return this.renderBody()}renderResults(){const{baseUrl:e,project:t,environments:o,params:{orgId:i,groupId:a,tagKey:l}}=this.props,{tagValueList:d,tag:g}=this.state,y=["title","release","environment","user.display","timestamp"];return null==d?void 0:d.map(((d,x)=>{var b,w;const _=null!=g&&g.totalValues?`${(0,j.aQ)(d.count,null==g?void 0:g.totalValues).toFixed(2)}%`:"--",k=null!==(b=d.key)&&void 0!==b?b:l,$=d.query||`${k}:"${d.value}"`,z=S.ZP.fromSavedQuery({id:void 0,name:k,fields:[k,...y.filter((e=>e!==k))],orderby:"-timestamp",query:`issue.id:${a} ${$}`,projects:[Number(null==t?void 0:t.id)],environment:o,version:2,range:"90d"}),B=`/organizations/${i}/issues/`;return(0,q.BX)(s.Fragment,{children:[(0,q.BX)(L,{children:[(0,q.tZ)(C,{"data-test-id":"group-tag-value",children:(0,q.tZ)(c.Z,{to:{pathname:`${e}events/`,query:{query:$}},children:"user"===k?(0,q.tZ)(m.Z,{user:{...d,id:null!==(w=d.identifier)&&void 0!==w?w:""},avatarSize:20,hideEmail:!0}):(0,q.tZ)(u.Hy,{value:d.name})})}),d.email&&(0,q.tZ)(P,{href:`mailto:${d.email}`,"data-test-id":"group-tag-mail",children:(0,q.tZ)(v.h,{size:"xs",color:"gray300"})}),(0,j.CB)(d.value)&&(0,q.tZ)(P,{href:d.value,"data-test-id":"group-tag-url",children:(0,q.tZ)(v.V$,{size:"xs",color:"gray300"})})]}),(0,q.tZ)(D,{children:_}),(0,q.tZ)(D,{children:d.count.toLocaleString()}),(0,q.tZ)(D,{children:(0,q.tZ)(Z.Z,{date:d.lastSeen})}),(0,q.tZ)(D,{children:(0,q.BX)(p.Z,{anchorRight:!0,alwaysRenderMenu:!1,caret:!1,title:(0,q.tZ)(r.ZP,{tooltipProps:{containerDisplayMode:"flex"},size:"small",type:"button","aria-label":(0,f.t)("Show more"),icon:(0,q.tZ)(v.YR,{size:"xs"})}),children:[(0,q.tZ)(n.Z,{features:["organizations:discover-basic"],children:(0,q.tZ)("li",{children:(0,q.tZ)(h.Z,{to:z.getResultsViewUrlTarget(i),children:(0,f.t)("Open in Discover")})})}),(0,q.tZ)("li",{children:(0,q.tZ)(c.Z,{to:{pathname:B,query:{query:$}},children:(0,f.t)("Search All Issues with Tag Value")})})]})})]},x)}))}renderBody(){const{group:e,params:{orgId:t,tagKey:o},location:{query:i},environments:n}=this.props,{tagValueList:a,tag:u,tagValueListPageLinks:p,loading:c}=this.state,{cursor:m,page:g,...h}=i,y="user"===o?(0,f.t)("Affected Users"):o,x=this.getSort(),Z=(0,q.tZ)(v.CC,{color:"gray300",size:"xs",direction:"down"}),b=(0,q.BX)(I,{to:{pathname:location.pathname,query:{...h,sort:"date"}},children:[(0,f.t)("Last Seen")," ","date"===x&&Z]}),w=(0,q.BX)(I,{to:{pathname:location.pathname,query:{...h,sort:"count"}},children:[(0,f.t)("Count")," ","count"===x&&Z]});return(0,q.BX)(s.Fragment,{children:[(0,q.BX)($,{children:[(0,q.tZ)(z,{children:(0,f.t)("Tag Details")}),(0,q.BX)(l.ZP,{gap:1,children:[(0,q.tZ)(r.ZP,{size:"small",priority:"default",href:`/${t}/${e.project.slug}/issues/${e.id}/tags/${o}/export/`,children:(0,f.t)("Export Page to CSV")}),(0,q.tZ)(d.ZP,{payload:{queryType:d.tD.IssuesByTag,queryInfo:{project:e.project.id,group:e.id,key:o}}})]})]}),(0,q.tZ)(B,{isLoading:c,isEmpty:0===(null==a?void 0:a.length),headers:[y,(0,q.tZ)(T,{children:(0,f.t)("Percent")},"percent"),w,b,""],emptyMessage:(0,f.t)("Sorry, the tags for this issue could not be found."),emptyAction:null!=n&&n.length?(0,f.t)("No tags were found for the currently selected environments"):null,children:a&&u&&this.renderResults()}),(0,q.tZ)(E,{pageLinks:p})]})}}const k=_,$=(0,i.Z)("div",{target:"e8ib56610"})("display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;justify-content:space-between;margin-bottom:",(0,w.Z)(2),";"),z=(0,i.Z)("h3",{target:"e8ib5669"})({name:"ti75j2",styles:"margin:0"}),B=(0,i.Z)(x.KB,{target:"e8ib5668"})("white-space:nowrap;font-size:",(e=>e.theme.fontSizeMedium),";overflow:auto;@media (min-width: ",(e=>e.theme.breakpoints[0]),"){overflow:initial;}&>*{padding:",(0,w.Z)(1)," ",(0,w.Z)(2),";}"),T=(0,i.Z)("div",{target:"e8ib5667"})({name:"2qga7i",styles:"text-align:right"}),I=(0,i.Z)(h.Z,{target:"e8ib5666"})({name:"7p2agl",styles:"text-align:right;color:inherit;:hover{color:inherit;}"}),P=(0,i.Z)(g.Z,{target:"e8ib5665"})("margin-left:",(0,w.Z)(.5),";"),V=(0,i.Z)("div",{target:"e8ib5664"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),L=(0,i.Z)(V,{target:"e8ib5663"})(b.Z,";display:flex;min-width:320px;"),C=(0,i.Z)("span",{target:"e8ib5662"})(b.Z,";width:auto;"),D=(0,i.Z)(V,{target:"e8ib5661"})({name:"1f60if8",styles:"justify-content:flex-end"}),E=(0,i.Z)(y.Z,{target:"e8ib5660"})({name:"ti75j2",styles:"margin:0"})}}]);
//# sourceMappingURL=../sourcemaps/app_views_organizationGroupDetails_groupTagValues_tsx.51267fe4fac69d32d2ab14b9ea14d844.js.map