"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_events_searchBar_tsx-app_views_performance_landing_vitalsCards_tsx"],{"./app/components/events/searchBar.tsx":(e,t,s)=>{s.d(t,{Z:()=>N});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.string.replace.js"),s("../node_modules/react/index.js")),n=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),a=s("../node_modules/lodash/assign.js"),o=s.n(a),l=s("../node_modules/lodash/flatten.js"),d=s.n(l),p=s("../node_modules/lodash/isEqual.js"),c=s.n(p),u=s("../node_modules/lodash/memoize.js"),m=s.n(u),h=s("../node_modules/lodash/omit.js"),g=s.n(h),v=s("./app/actionCreators/tags.tsx"),x=s("./app/components/smartSearchBar/index.tsx"),Z=s("./app/constants/index.tsx"),f=s("./app/types/index.tsx"),y=s("./app/utils.tsx"),b=s("./app/utils/discover/fields.tsx"),w=s("./app/utils/measurements/measurements.tsx"),j=s("./app/utils/withApi.tsx"),_=s("./app/utils/withTags.tsx"),k=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const S=new RegExp(`^${Z.c$}|\\${Z.ir}`,"g");class P extends i.PureComponent{constructor(){super(...arguments),(0,r.Z)(this,"getEventFieldValues",m()(((e,t,s)=>{const{api:r,organization:i,projectIds:n,includeSessionTagsValues:a}=this.props,o=null==n?void 0:n.map(String);return(0,b.h1)(e.key)||(0,b.Xr)(e.key)?Promise.resolve([]):(0,v.Fo)(r,i.slug,e.key,t,o,s,!0,a).then((e=>d()(e.filter((e=>{let{name:t}=e;return(0,y.ri)(t)})).map((e=>{let{name:t}=e;return t})))),(()=>{throw new Error("Unable to fetch event field values")}))}),((e,t)=>{let{key:s}=e;return`${s}-${t}`}))),(0,r.Z)(this,"prepareQuery",(e=>e.replace(S,"")))}componentDidMount(){var e,t;null===(e=(t=this.getEventFieldValues.cache).clear)||void 0===e||e.call(t)}componentDidUpdate(e){var t,s;c()(this.props.projectIds,e.projectIds)||null===(t=(s=this.getEventFieldValues.cache).clear)||void 0===t||t.call(s)}getTagList(e){const{fields:t,organization:s,tags:r,omitTags:i}=this.props,n=t?Object.fromEntries(t.filter((e=>!Object.keys(b.wZ).includes(e.field)&&!(0,b.GO)(e.field))).map((e=>[e.field,{key:e.field,name:e.field}]))):{},a=s.features.includes("performance-view")?Object.assign({},e,b.wZ,n):g()(b.wZ,b.J8),l=o()({},r,a,b.jg);return l.has={key:"has",name:"Has property",values:Object.keys(l),predefined:!0},g()(l,null!=i?i:[])}render(){return(0,k.tZ)(w.Z,{children:e=>{let{measurements:t}=e;const s=this.getTagList(t);return(0,k.tZ)(n.ms,{children:e=>{let{css:t}=e;return(0,k.tZ)(x.Z,{hasRecentSearches:!0,savedSearchType:f.L4.EVENT,onGetTagValues:this.getEventFieldValues,supportedTags:s,prepareQuery:this.prepareQuery,excludeEnvironment:!0,dropdownClassName:t`
                    max-height: 300px;
                    overflow-y: auto;
                  `,...this.props})}})}})}}P.displayName="SearchBar";const N=(0,j.Z)((0,_.Z)(P))},"./app/utils/measurements/measurements.tsx":(e,t,s)=>{s.d(t,{Z:()=>p}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/react/index.js"),i=s("./app/utils/performance/vitals/constants.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){return Object.fromEntries(Object.entries(e).map((e=>{let[t,s]=e;return[t,{name:s.name,key:t}]})))}const o=a(i.TT),l=a(i.r9);function d(e){let{children:t}=e;const s={...l,...o};return(0,n.tZ)(r.Fragment,{children:t({measurements:s})})}d.displayName="Measurements";const p=d},"./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx":(e,t,s)=>{s.d(t,{Z:()=>c}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js");var r=s("../node_modules/lodash/pick.js"),i=s.n(r),n=s("./app/utils/discover/genericDiscoverQuery.tsx"),a=s("./app/utils/performance/constants.tsx"),o=s("./app/utils/withApi.tsx"),l=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){const{eventView:t,vitals:s}=e,r=null==t?void 0:t.getEventsAPIPayload(e.location);return{vital:s,...i()(r,["query",...Object.values(a.s)])}}function p(e){return(0,l.tZ)(n.ZP,{getRequestPayload:d,route:"events-vitals",...e,children:t=>{let{tableData:s,...r}=t;return e.children({vitalsData:s,...r})}})}p.displayName="VitalsCardsDiscoverQuery";const c=(0,o.Z)(p)},"./app/utils/withTags.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("./app/stores/tagStore.tsx"),a=s("./app/utils/getDisplayName.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends i.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{tags:n.Z.getAllTags()}),(0,r.Z)(this,"unsubscribe",n.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...s}=this.props;return(0,o.tZ)(e,{tags:null!=t?t:this.state.tags,...s})}}return t.displayName="WithTags",(0,r.Z)(t,"displayName",`withTags(${(0,a.Z)(e)})`),t}},"./app/views/performance/landing/vitalsCards.tsx":(e,t,s)=>{s.d(t,{JO:()=>I});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("../node_modules/react/index.js"),n=s("../node_modules/@sentry/minimal/esm/index.js"),a=s("./app/components/card.tsx"),o=s("./app/components/charts/eventsRequest.tsx"),l=s("./app/components/charts/styles.tsx"),d=s("./app/components/charts/utils.tsx"),p=s("./app/components/emptyStateWarning.tsx"),c=(s("./app/components/links/link.tsx"),s("./app/components/placeholder.tsx")),u=s("./app/components/questionTooltip.tsx"),m=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),h=s("../node_modules/react-sparklines/build/index.js"),g=s("../node_modules/prop-types/index.js"),v=s.n(g);class x extends h.Sparklines{}(0,m.Z)(x,"propTypes",{children:v().node,data:v().array,limit:v().number,width:v().number,height:v().number,svgWidth:v().number,svgHeight:v().number,preserveAspectRatio:v().string,margin:v().number,style:v().object,min:v().number,max:v().number,onMouseMove:v().func});var Z=s("./app/components/tooltip.tsx"),f=s("./app/locale.tsx"),y=s("./app/styles/overflowEllipsis.tsx"),b=s("./app/styles/space.tsx"),w=s("./app/utils.tsx"),j=s("./app/utils/dates.tsx"),_=s("./app/utils/discover/discoverQuery.tsx"),k=s("./app/utils/discover/fields.tsx"),S=(s("./app/utils/performance/vitals/constants.tsx"),s("./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx"),s("./app/utils/queryString.tsx"),s("./app/utils/theme.tsx")),P=s("./app/utils/useApi.tsx"),N=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const T=e=>(0,N.tZ)(C,{barHeight:e.barHeight,fractions:e.colorStops.map((e=>{let{percent:t}=e;return t})),children:e.colorStops.map((e=>(0,N.tZ)(A,{color:e.color},e.color)))});T.displayName="ColorBar";const C=(0,r.Z)("div",{target:"etd41501"})("height:",(e=>e.barHeight?`${e.barHeight}px`:"16px"),";width:100%;overflow:hidden;position:relative;background:",(e=>e.theme.gray100),";display:grid;grid-template-columns:",(e=>e.fractions.map((e=>`${e}fr`)).join(" ")),";margin-bottom:",(e=>e.barHeight?"":(0,b.Z)(1)),";border-radius:2px;"),A=(0,r.Z)("div",{target:"etd41500"})("background-color:",(e=>e.theme[e.color]),";"),E=T;var O=s("./app/views/performance/vitalDetail/utils.tsx"),V=s("./app/utils/formatters.tsx");function D(e,t){const s=Array.isArray(e)||e===k.Zl.CLS?"":"ms";switch(t){case O.SP.POOR:return Array.isArray(e)?(0,f.t)("Poor"):(0,f._N)("Poor: >[threshold][unit]",{threshold:O.eE[e],unit:s});case O.SP.MEH:return Array.isArray(e)?(0,f.t)("Meh"):(0,f._N)("Meh: >[threshold][unit]",{threshold:O.MN[e],unit:s});case O.SP.GOOD:return Array.isArray(e)?(0,f.t)("Good"):(0,f._N)("Good: <[threshold][unit]",{threshold:O.MN[e],unit:s});default:return null}}function H(e){return(0,N.tZ)(z,{children:e.percents.map((t=>(0,N.tZ)(Z.Z,{title:D(e.vital,t.vitalState),disabled:e.hideTooltips,children:(0,N.BX)(B,{"data-test-id":"vital-status",children:[O.Np[t.vitalState],(0,N.BX)("span",{children:[e.showVitalPercentNames&&(0,f.t)(`${t.vitalState}`)," ",(0,V.rl)(t.percent,0)]})]})},t.vitalState)))})}H.displayName="VitalPercents";const z=(0,r.Z)("div",{target:"ex3thpn1"})("display:inline-grid;grid-auto-flow:column;gap:",(0,b.Z)(2),";"),B=(0,r.Z)("div",{target:"ex3thpn0"})("display:flex;align-items:center;gap:",(0,b.Z)(.5),";font-size:",(e=>e.theme.fontSizeMedium),";");var M=s("./app/views/performance/landing/utils.tsx");function $(e){const t=(0,P.Z)(),{eventView:s,location:r,organization:i,functions:a}=e,{query:l}=r,p=s.withColumns(a),c=p.getPageFilters(),u=c.datetime.start?(0,j.hC)(c.datetime.start):void 0,m=c.datetime.end?(0,j.hC)(c.datetime.end):void 0,h="string"==typeof l.sparkInterval?l.sparkInterval:(0,d.ZS)({start:u||null,end:m||null,period:c.datetime.period},"low"),g=p.getEventsAPIPayload(r);return(0,N.tZ)(_.Z,{location:r,eventView:p,orgSlug:i.slug,limit:1,referrer:"api.performance.vitals-cards",children:e=>{let{isLoading:s,tableData:r}=e;return(0,N.tZ)(o.Z,{api:t,organization:i,period:c.datetime.period,project:c.projects,environment:c.environments,team:g.team,start:u,end:m,interval:h,query:g.query,includePrevious:!1,yAxis:p.getFields(),partial:!0,children:e=>{let{results:t}=e;const o=null==t?void 0:t.reduce(((e,t)=>(e[t.seriesName]=t.data.map((e=>e.value)),e)),{}),l=(0,M.hv)(i);return(0,N.tZ)(L,{children:a.map((e=>{var t,i;let a=(0,k.sN)(e);a.includes("apdex")&&(a="apdex()");const d=l[a];if(!d)return n.uT(`Missing field '${a}' in vital cards.`),null;const{title:p,tooltip:c,formatter:u}=d,m=(0,k.LY)(a),h=null==r||null===(t=r.data)||void 0===t||null===(i=t[0])||void 0===i?void 0:i[m],g=null==o?void 0:o[a],v=s||!(0,w.ri)(h)?"—":u(h),x=(0,N.tZ)(F,{data:g});return(0,N.tZ)(G,{title:p,tooltip:c,value:v,chart:x,horizontal:!0,minHeight:96,isNotInteractive:!0},a)}))})}})}})}function F(e){const{data:t}=e,s=S.ZP.charts.getColorPalette(1)[0];return(0,N.tZ)(q,{"data-test-id":"sparkline",width:150,height:24,children:(0,N.tZ)(x,{data:t,width:150,height:24,children:(0,N.tZ)(h.SparklinesLine,{style:{stroke:s,fill:"none",strokeWidth:3}})})})}(0,b.Z)(1.5),$.displayName="GenericCards",F.displayName="SparklineChart";const q=(0,r.Z)("div",{target:"e1he14ku8"})("flex-grow:4;max-height:",(e=>e.height),"px;max-width:",(e=>e.width),"px;margin:",(0,b.Z)(1)," ",(0,b.Z)(0)," ",(0,b.Z)(.5)," ",(0,b.Z)(3),";"),L=(0,r.Z)("div",{target:"e1he14ku7"})("display:grid;grid-template-columns:1fr;grid-column-gap:",(0,b.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:repeat(2, 1fr);}@media (min-width: ",(e=>e.theme.breakpoints[2]),"){grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));}");function I(e){var t;const{isLoading:s,data:r,vital:n,value:a,showBar:o=!0,showStates:l=!1,showDurationDetail:d=!1,showVitalPercentNames:p=!1,showDetail:u=!0,showTooltip:m=!1,barHeight:h}=e;if(s)return l?(0,N.tZ)(c.Z,{height:"48px"}):null;const g=l?(0,N.tZ)(X,{small:!0,children:(0,f.t)("No vitals found")}):null;if(!r)return g;const v={poor:0,meh:0,good:0,total:0};if((Array.isArray(n)?n:[n]).forEach((e=>{var t;const s=null!==(t=null==r?void 0:r[e])&&void 0!==t?t:{};Object.keys(v).forEach((e=>v[e]+=s[e]))})),!v.total)return g;const x=Array.isArray(n)?null:null!=a?a:function(e,t){var s;const r=null!==(s=null==e?void 0:e.p75)&&void 0!==s?s:null;return null===r?"—":t===k.Zl.CLS?r.toFixed(2):`${r.toFixed(0)}ms`}(null!==(t=null==r?void 0:r[n])&&void 0!==t?t:null,n),Z=function(e){let{poor:t,meh:s,good:r,total:i}=e;const n=t/i,a=s/i,o=r/i;return[{vitalState:O.SP.GOOD,percent:o},{vitalState:O.SP.MEH,percent:a},{vitalState:O.SP.POOR,percent:n}]}(v),y=function(e){return e.map((e=>{let{percent:t,vitalState:s}=e;return{percent:t,color:O.fL[s]}}))}(Z);return(0,N.BX)(i.Fragment,{children:[o&&(0,N.tZ)(W,{title:(0,N.tZ)(H,{vital:n,percents:Z,showVitalPercentNames:!0,hideTooltips:m}),disabled:!m,position:"bottom",children:(0,N.tZ)(E,{barHeight:h,colorStops:y})}),u&&(0,N.BX)(U,{children:[d&&x&&(0,N.BX)("div",{children:[(0,f.t)("The p75 for all transactions is "),(0,N.tZ)("strong",{children:x})]}),(0,N.tZ)(H,{vital:n,percents:Z,showVitalPercentNames:p})]})]})}I.displayName="VitalBar";const X=(0,r.Z)(p.Z,{target:"e1he14ku6"})("height:48px;padding:",(0,b.Z)(1.5)," 15%;");function G(e){const{chart:t,minHeight:s,horizontal:r,title:i,tooltip:n,value:a,isNotInteractive:o}=e;return(0,N.BX)(R,{interactive:!o,minHeight:s,children:[(0,N.BX)(l.Gh,{children:[(0,N.tZ)(Y,{children:(0,f.t)(i)}),(0,N.tZ)(u.Z,{size:"sm",position:"top",title:n})]}),(0,N.BX)(Q,{horizontal:r,children:[(0,N.tZ)(J,{children:a}),t]})]})}G.displayName="VitalCard";const Q=(0,r.Z)("div",{target:"e1he14ku5"})("width:100%;display:flex;flex-direction:",(e=>e.horizontal?"row":"column"),";justify-content:space-between;"),R=(0,r.Z)(a.Z,{target:"e1he14ku4"})("color:",(e=>e.theme.textColor),";padding:",(0,b.Z)(2)," ",(0,b.Z)(3),";align-items:flex-start;margin-bottom:",(0,b.Z)(2),";",(e=>e.minHeight&&`min-height: ${e.minHeight}px`),";"),W=(0,r.Z)(Z.Z,{target:"e1he14ku3"})({name:"1d3w5wq",styles:"width:100%"});const U=(0,r.Z)("div",{target:"e1he14ku2"})("font-size:",(e=>e.theme.fontSizeMedium),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){display:flex;justify-content:space-between;}"),J=(0,r.Z)("div",{target:"e1he14ku1"})("font-size:32px;margin-top:",(0,b.Z)(1),";"),Y=(0,r.Z)("div",{target:"e1he14ku0"})(y.Z,";")}}]);
//# sourceMappingURL=../sourcemaps/app_components_events_searchBar_tsx-app_views_performance_landing_vitalsCards_tsx.7c7409f492c2404dc0814267795f70a0.js.map