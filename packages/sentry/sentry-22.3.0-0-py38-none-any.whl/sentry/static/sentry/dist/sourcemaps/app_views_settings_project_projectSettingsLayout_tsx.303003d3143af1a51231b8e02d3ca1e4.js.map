{"version":3,"file":"chunks/app_views_settings_project_projectSettingsLayout_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/projects/appStoreConnectContext.tsx","webpack:///./app/utils/appStoreValidationErrorMessage.tsx","webpack:///./app/views/projects/projectContext.tsx","webpack:///./app/views/settings/project/projectSettingsNavigation.tsx","webpack:///./app/views/settings/project/projectSettingsLayout.tsx"],"sourcesContent":["import {createContext, useEffect, useState} from 'react';\n\nimport {Organization, Project} from 'sentry/types';\nimport {\n  AppStoreConnectCredentialsStatus,\n  AppStoreConnectStatusData,\n} from 'sentry/types/debugFiles';\nimport {getAppStoreValidationErrorMessage} from 'sentry/utils/appStoreValidationErrorMessage';\nimport useApi from 'sentry/utils/useApi';\n\nexport type AppStoreConnectContextProps =\n  | Record<string, AppStoreConnectStatusData>\n  | undefined;\n\nconst AppStoreConnectContext = createContext<AppStoreConnectContextProps>(undefined);\n\ntype ProviderProps = {\n  children: React.ReactNode;\n  organization: Organization;\n  project?: Project;\n};\n\nconst Provider = ({children, project, organization}: ProviderProps) => {\n  const api = useApi();\n\n  const [projectDetails, setProjectDetails] = useState<undefined | Project>();\n  const [appStoreConnectStatusData, setAppStoreConnectStatusData] =\n    useState<AppStoreConnectContextProps>(undefined);\n\n  const orgSlug = organization.slug;\n\n  const appStoreConnectSymbolSources = (\n    projectDetails?.symbolSources ? JSON.parse(projectDetails.symbolSources) : []\n  ).reduce((acc, {type, id, ...symbolSource}) => {\n    if (type.toLowerCase() === 'appstoreconnect') {\n      acc[id] = {type, ...symbolSource};\n    }\n    return acc;\n  }, {});\n\n  useEffect(() => {\n    fetchProjectDetails();\n  }, [project]);\n\n  useEffect(() => {\n    fetchAppStoreConnectStatusData();\n  }, [projectDetails]);\n\n  async function fetchProjectDetails() {\n    if (!project || projectDetails) {\n      return;\n    }\n\n    if (project.symbolSources) {\n      setProjectDetails(project);\n      return;\n    }\n\n    try {\n      const response = await api.requestPromise(`/projects/${orgSlug}/${project.slug}/`);\n      setProjectDetails(response);\n    } catch {\n      // do nothing\n    }\n  }\n\n  async function fetchAppStoreConnectStatusData() {\n    if (!projectDetails) {\n      return;\n    }\n\n    if (!Object.keys(appStoreConnectSymbolSources).length) {\n      return;\n    }\n\n    try {\n      const response: Record<string, AppStoreConnectStatusData> =\n        await api.requestPromise(\n          `/projects/${orgSlug}/${projectDetails.slug}/appstoreconnect/status/`\n        );\n\n      setAppStoreConnectStatusData(response);\n    } catch {\n      // do nothing\n    }\n  }\n\n  function getUpdateAlertMessage(\n    respository: NonNullable<Parameters<typeof getAppStoreValidationErrorMessage>[1]>,\n    credentials: AppStoreConnectCredentialsStatus\n  ) {\n    if (credentials?.status === 'valid') {\n      return undefined;\n    }\n\n    return getAppStoreValidationErrorMessage(credentials, respository);\n  }\n\n  return (\n    <AppStoreConnectContext.Provider\n      value={\n        appStoreConnectStatusData && project\n          ? Object.keys(appStoreConnectStatusData).reduce((acc, key) => {\n              const appStoreConnect = appStoreConnectStatusData[key];\n              return {\n                ...acc,\n                [key]: {\n                  ...appStoreConnect,\n                  updateAlertMessage: getUpdateAlertMessage(\n                    {\n                      name: appStoreConnectSymbolSources[key].name,\n                      link: `/settings/${organization.slug}/projects/${project.slug}/debug-symbols/?customRepository=${key}`,\n                    },\n                    appStoreConnect.credentials\n                  ),\n                },\n              };\n            }, {})\n          : undefined\n      }\n    >\n      {children}\n    </AppStoreConnectContext.Provider>\n  );\n};\n\nexport {Provider};\n\nexport default AppStoreConnectContext;\n","import * as Sentry from '@sentry/react';\n\nimport Link from 'sentry/components/links/link';\nimport {t, tct} from 'sentry/locale';\nimport {AppStoreConnectValidationError} from 'sentry/types/debugFiles';\n\nexport const unexpectedErrorMessage = t(\n  'An unexpected error occurred while configuring the App Store Connect integration'\n);\n\nexport function getAppStoreValidationErrorMessage(\n  error: AppStoreConnectValidationError,\n  repo?: {link: string; name: string}\n) {\n  switch (error.code) {\n    case 'app-connect-authentication-error':\n      return repo\n        ? tct(\n            'App Store Connect credentials are invalid or missing. [linkToCustomRepository]',\n            {\n              linkToCustomRepository: (\n                <Link to={repo.link}>\n                  {tct(\n                    \"Make sure the credentials of the '[customRepositoryName]' repository are correct and exist.\",\n                    {\n                      customRepositoryName: repo.name,\n                    }\n                  )}\n                </Link>\n              ),\n            }\n          )\n        : t('The supplied App Store Connect credentials are invalid or missing.');\n    case 'app-connect-forbidden-error':\n      return t('The supplied API key does not have sufficient permissions.');\n    case 'app-connect-multiple-sources-error':\n      return t('Only one App Store Connect application is allowed in this project.');\n    default: {\n      // this shall not happen\n      Sentry.captureException(new Error('Unknown app store connect error.'));\n      return unexpectedErrorMessage;\n    }\n  }\n}\n","import {Component, createRef} from 'react';\nimport DocumentTitle from 'react-document-title';\nimport styled from '@emotion/styled';\n\nimport {fetchOrgMembers} from 'sentry/actionCreators/members';\nimport {setActiveProject} from 'sentry/actionCreators/projects';\nimport {Client} from 'sentry/api';\nimport LoadingError from 'sentry/components/loadingError';\nimport LoadingIndicator from 'sentry/components/loadingIndicator';\nimport MissingProjectMembership from 'sentry/components/projects/missingProjectMembership';\nimport {t} from 'sentry/locale';\nimport SentryTypes from 'sentry/sentryTypes';\nimport MemberListStore from 'sentry/stores/memberListStore';\nimport ProjectsStore from 'sentry/stores/projectsStore';\nimport space from 'sentry/styles/space';\nimport {Organization, Project, User} from 'sentry/types';\nimport withApi from 'sentry/utils/withApi';\nimport withOrganization from 'sentry/utils/withOrganization';\nimport withProjects from 'sentry/utils/withProjects';\n\nenum ErrorTypes {\n  MISSING_MEMBERSHIP = 'MISSING_MEMBERSHIP',\n  PROJECT_NOT_FOUND = 'PROJECT_NOT_FOUND',\n  UNKNOWN = 'UNKNOWN',\n}\n\ntype ChildFuncProps = {\n  project: Project;\n};\n\ntype Props = {\n  api: Client;\n  children: ((props: ChildFuncProps) => React.ReactNode) | React.ReactNode;\n  loadingProjects: boolean;\n  orgId: string;\n  organization: Organization;\n  projectId: string;\n  projects: Project[];\n  /**\n   * If true, this will not change `state.loading` during `fetchData` phase\n   */\n  skipReload?: boolean;\n};\n\ntype State = {\n  error: boolean;\n  errorType: ErrorTypes | null;\n  loading: boolean;\n  memberList: User[];\n  project: Project | null;\n};\n\n/**\n * Higher-order component that sets `project` as a child context\n * value to be accessed by child elements.\n *\n * Additionally delays rendering of children until project XHR has finished\n * and context is populated.\n */\nclass ProjectContext extends Component<Props, State> {\n  static childContextTypes = {\n    project: SentryTypes.Project,\n  };\n\n  state = this.getInitialState();\n\n  getInitialState(): State {\n    return {\n      loading: true,\n      error: false,\n      errorType: null,\n      memberList: [],\n      project: null,\n    };\n  }\n\n  getChildContext() {\n    return {\n      project: this.state.project,\n    };\n  }\n\n  componentDidMount() {\n    // Wait for withProjects to fetch projects before making request\n    // Once loaded we can fetchData in componentDidUpdate\n    const {loadingProjects} = this.props;\n    if (!loadingProjects) {\n      this.fetchData();\n    }\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    if (nextProps.projectId === this.props.projectId) {\n      return;\n    }\n\n    if (!nextProps.skipReload) {\n      this.remountComponent();\n    }\n  }\n\n  componentDidUpdate(prevProps: Props, prevState: State) {\n    if (prevProps.projectId !== this.props.projectId) {\n      this.fetchData();\n    }\n\n    // Project list has changed. Likely indicating that a new project has been\n    // added. Re-fetch project details in case that the new project is the active\n    // project.\n    //\n    // For now, only compare lengths. It is possible that project slugs within\n    // the list could change, but it doesn't seem to be broken anywhere else at\n    // the moment that would require deeper checks.\n    if (prevProps.projects.length !== this.props.projects.length) {\n      this.fetchData();\n    }\n\n    // Call forceUpdate() on <DocumentTitle/> if either project or organization\n    // state has changed. This is because <DocumentTitle/>'s shouldComponentUpdate()\n    // returns false unless props differ; meaning context changes for project/org\n    // do NOT trigger renders for <DocumentTitle/> OR any subchildren. The end result\n    // being that child elements that listen for context changes on project/org will\n    // NOT update (without this hack).\n    // See: https://github.com/gaearon/react-document-title/issues/35\n\n    // intentionally shallow comparing references\n    if (prevState.project !== this.state.project) {\n      const docTitle = this.docTitleRef.current;\n      if (!docTitle) {\n        return;\n      }\n      docTitle.forceUpdate();\n    }\n  }\n\n  componentWillUnmount() {\n    this.unsubscribeMembers();\n    this.unsubscribeProjects();\n  }\n\n  docTitleRef = createRef<DocumentTitle>();\n\n  unsubscribeProjects = ProjectsStore.listen(\n    (projectIds: Set<string>) => this.onProjectChange(projectIds),\n    undefined\n  );\n\n  unsubscribeMembers = MemberListStore.listen(\n    (memberList: typeof MemberListStore['state']) => this.setState({memberList}),\n    undefined\n  );\n\n  remountComponent() {\n    this.setState(this.getInitialState());\n  }\n\n  getTitle() {\n    return this.state.project?.slug ?? 'Sentry';\n  }\n\n  onProjectChange(projectIds: Set<string>) {\n    if (!this.state.project) {\n      return;\n    }\n    if (!projectIds.has(this.state.project.id)) {\n      return;\n    }\n    this.setState({\n      project: {...ProjectsStore.getById(this.state.project.id)} as Project,\n    });\n  }\n\n  identifyProject() {\n    const {projects, projectId} = this.props;\n    const projectSlug = projectId;\n    return projects.find(({slug}) => slug === projectSlug) || null;\n  }\n\n  async fetchData() {\n    const {orgId, projectId, skipReload} = this.props;\n    // we fetch core access/information from the global organization data\n    const activeProject = this.identifyProject();\n    const hasAccess = activeProject && activeProject.hasAccess;\n\n    this.setState((state: State) => ({\n      // if `skipReload` is true, then don't change loading state\n      loading: skipReload ? state.loading : true,\n      // we bind project initially, but it'll rebind\n      project: activeProject,\n    }));\n\n    if (activeProject && hasAccess) {\n      setActiveProject(null);\n      const projectRequest = this.props.api.requestPromise(\n        `/projects/${orgId}/${projectId}/`\n      );\n\n      try {\n        const project = await projectRequest;\n        this.setState({\n          loading: false,\n          project,\n          error: false,\n          errorType: null,\n        });\n\n        // assuming here that this means the project is considered the active project\n        setActiveProject(project);\n      } catch (error) {\n        this.setState({\n          loading: false,\n          error: false,\n          errorType: ErrorTypes.UNKNOWN,\n        });\n      }\n\n      fetchOrgMembers(this.props.api, orgId, [activeProject.id]);\n\n      return;\n    }\n\n    // User is not a memberof the active project\n    if (activeProject && !activeProject.isMember) {\n      this.setState({\n        loading: false,\n        error: true,\n        errorType: ErrorTypes.MISSING_MEMBERSHIP,\n      });\n\n      return;\n    }\n\n    // There is no active project. This likely indicates either the project\n    // *does not exist* or the project has not yet been added to the store.\n    // Either way, make a request to check for existence of the project.\n    try {\n      await this.props.api.requestPromise(`/projects/${orgId}/${projectId}/`);\n    } catch (error) {\n      this.setState({\n        loading: false,\n        error: true,\n        errorType: ErrorTypes.PROJECT_NOT_FOUND,\n      });\n    }\n  }\n\n  renderBody() {\n    const {children, organization} = this.props;\n    const {error, errorType, loading, project} = this.state;\n\n    if (loading) {\n      return (\n        <div className=\"loading-full-layout\">\n          <LoadingIndicator />\n        </div>\n      );\n    }\n\n    if (!error && project) {\n      return typeof children === 'function' ? children({project}) : children;\n    }\n\n    switch (errorType) {\n      case ErrorTypes.PROJECT_NOT_FOUND:\n        // TODO(chrissy): use scale for margin values\n        return (\n          <div className=\"container\">\n            <div className=\"alert alert-block\" style={{margin: '30px 0 10px'}}>\n              {t('The project you were looking for was not found.')}\n            </div>\n          </div>\n        );\n      case ErrorTypes.MISSING_MEMBERSHIP:\n        // TODO(dcramer): add various controls to improve this flow and break it\n        // out into a reusable missing access error component\n        return (\n          <ErrorWrapper>\n            <MissingProjectMembership organization={organization} project={project} />\n          </ErrorWrapper>\n        );\n      default:\n        return <LoadingError onRetry={this.remountComponent} />;\n    }\n  }\n\n  render() {\n    return (\n      <DocumentTitle ref={this.docTitleRef} title={this.getTitle()}>\n        {this.renderBody()}\n      </DocumentTitle>\n    );\n  }\n}\n\nexport {ProjectContext};\n\nexport default withApi(withOrganization(withProjects(ProjectContext)));\n\nconst ErrorWrapper = styled('div')`\n  width: 100%;\n  margin: ${space(2)} ${space(4)};\n`;\n","import {useContext} from 'react';\n\nimport AppStoreConnectContext from 'sentry/components/projects/appStoreConnectContext';\nimport {Organization, Project} from 'sentry/types';\nimport withProject from 'sentry/utils/withProject';\nimport SettingsNavigation from 'sentry/views/settings/components/settingsNavigation';\nimport getConfiguration from 'sentry/views/settings/project/navigationConfiguration';\n\ntype Props = {\n  organization: Organization;\n  project?: Project;\n};\n\nconst ProjectSettingsNavigation = ({organization, project}: Props) => {\n  const appStoreConnectContext = useContext(AppStoreConnectContext);\n\n  const debugFilesNeedsReview = appStoreConnectContext\n    ? Object.keys(appStoreConnectContext).some(\n        key => appStoreConnectContext[key].credentials.status === 'invalid'\n      )\n    : false;\n\n  return (\n    <SettingsNavigation\n      navigationObjects={getConfiguration({project, organization, debugFilesNeedsReview})}\n      access={new Set(organization.access)}\n      features={new Set(organization.features)}\n      organization={organization}\n      project={project}\n    />\n  );\n};\n\nexport default withProject(ProjectSettingsNavigation);\n","import * as React from 'react';\nimport {RouteComponentProps} from 'react-router';\n\nimport * as AppStoreConnectContext from 'sentry/components/projects/appStoreConnectContext';\nimport {Organization} from 'sentry/types';\nimport withOrganization from 'sentry/utils/withOrganization';\nimport ProjectContext from 'sentry/views/projects/projectContext';\nimport SettingsLayout from 'sentry/views/settings/components/settingsLayout';\nimport ProjectSettingsNavigation from 'sentry/views/settings/project/projectSettingsNavigation';\n\ntype Props = {\n  children: React.ReactNode;\n  organization: Organization;\n} & RouteComponentProps<{orgId: string; projectId: string}, {}>;\n\nfunction ProjectSettingsLayout({\n  params,\n  organization,\n  children,\n  routes,\n  ...props\n}: Props) {\n  const {orgId, projectId} = params;\n\n  return (\n    <ProjectContext orgId={orgId} projectId={projectId}>\n      {({project}) => (\n        <AppStoreConnectContext.Provider project={project} organization={organization}>\n          <SettingsLayout\n            params={params}\n            routes={routes}\n            {...props}\n            renderNavigation={() => (\n              <ProjectSettingsNavigation organization={organization} />\n            )}\n          >\n            {children && React.isValidElement(children)\n              ? React.cloneElement(children, {\n                  organization,\n                  project,\n                })\n              : children}\n          </SettingsLayout>\n        </AppStoreConnectContext.Provider>\n      )}\n    </ProjectContext>\n  );\n}\n\nexport default withOrganization(ProjectSettingsLayout);\n"],"names":["AppStoreConnectContext","createContext","undefined","Provider","children","project","organization","api","useApi","projectDetails","setProjectDetails","useState","appStoreConnectStatusData","setAppStoreConnectStatusData","orgSlug","slug","appStoreConnectSymbolSources","symbolSources","JSON","parse","reduce","acc","type","id","symbolSource","toLowerCase","getUpdateAlertMessage","respository","credentials","status","getAppStoreValidationErrorMessage","useEffect","async","response","requestPromise","fetchProjectDetails","Object","keys","length","fetchAppStoreConnectStatusData","value","key","appStoreConnect","updateAlertMessage","name","link","unexpectedErrorMessage","t","error","repo","code","tct","linkToCustomRepository","to","customRepositoryName","Sentry","Error","ErrorTypes","ProjectContext","Component","this","getInitialState","createRef","ProjectsStore","projectIds","onProjectChange","MemberListStore","memberList","setState","loading","errorType","getChildContext","state","componentDidMount","loadingProjects","props","fetchData","componentWillReceiveProps","nextProps","projectId","skipReload","remountComponent","componentDidUpdate","prevProps","prevState","projects","docTitle","docTitleRef","current","forceUpdate","componentWillUnmount","unsubscribeMembers","unsubscribeProjects","getTitle","has","identifyProject","projectSlug","find","orgId","activeProject","hasAccess","setActiveProject","projectRequest","UNKNOWN","fetchOrgMembers","isMember","PROJECT_NOT_FOUND","MISSING_MEMBERSHIP","renderBody","className","style","margin","ErrorWrapper","onRetry","render","ref","title","SentryTypes","withApi","withOrganization","withProjects","space","ProjectSettingsNavigation","appStoreConnectContext","useContext","debugFilesNeedsReview","some","navigationObjects","getConfiguration","access","Set","features","withProject","ProjectSettingsLayout","params","routes","renderNavigation","React"],"sourceRoot":""}